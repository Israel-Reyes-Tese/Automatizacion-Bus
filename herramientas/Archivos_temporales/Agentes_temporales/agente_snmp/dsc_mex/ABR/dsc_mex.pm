package ABR::dsc_mex;

use warnings;
use strict;
use Digest::MurmurHash qw(murmur_hash);
use ABR::llenaComun;
my $llena = ABR::llenaComun->new();
use ABR::CorrectiveFilter;
my $cf = ABR::CorrectiveFilter->new(split_filter1 => '\<&&\>', split_filter2 => '\<\>');

my $dat_MO;

sub ifexists {
    my $variable = shift;
    return defined $variable && $variable ne "";
}

sub ifExistsAndNumber {
    my $variable = shift;
    return defined $variable && $variable ne "" && $variable =~ /^[-+]?[0-9]*\.?[0-9]+$/;
}

sub HostRegex {
    my ($configHost_ref, $ip_address) = @_;
    my $salida = "";
    if (ifexists($configHost_ref)) {
        foreach my $k ($configHost_ref->keys) {
            if ($ip_address =~ /\$k/) {
                $salida = $configHost_ref->get($k);
            }
        }
    }
    return $salida;
}

sub get_managed_object {
    my ($hostname, $agent_address, $dat_managed_object) = @_;
    my $dat_MO = "";
    if (ifexists($hostname)) {
        if (ifexists($dat_managed_object)) {
            $dat_MO = $hostname . " " . $dat_managed_object;
        } else {
            $dat_MO = $hostname;
        }
    } elsif (ifexists($dat_managed_object)) {
        $dat_MO = "HostND " . $agent_address . " " . $dat_managed_object;
    } else {
        $dat_MO = "HostND " . $agent_address;
    }
    if (ifexists($dat_MO)) {
        $dat_MO =~ s/"//g;
        $dat_MO = "\"" . $dat_MO . "\"";
    }
    return $dat_MO;
}

sub FuncAdditionalInfo {
    my ($entrada, $tp_name) = @_;
    my $add_info = " | AddInfo: trap name=" . $tp_name . ", ";
    foreach my $k (keys %$entrada) {
        unless ($k =~ /^(IPADDR|EOID|SPEC_TRAP|GEN_TRAP|1.3.6.1.2.1.1.3|1.3.6.1.6.3.1.1.4.1)$/) {
            if (ifexists($entrada->{$k})) {
                $add_info .= " " . $k . ": " . $entrada->{$k} . ";";
            }
        }
    }
    return $add_info;
}

sub CorrectiveFilter {
    my ($hashAlarm_ref, $config_ref, $action, $var, $c) = @_;
    my $output = $cf->ProcessingCF($hashAlarm_ref, $config_ref, $action, $c);
    if (ifexists($output)) {
        return $output;
    } elsif ($var =~ "MO") {
        return $hashAlarm_ref->{"MO"};
    } elsif ($var =~ "AddTxt") {
        return $hashAlarm_ref->{"AddTxt"};
    } elsif ($var =~ "PS") {
        return $hashAlarm_ref->{"PS"};
    }
}

sub trapSeverity {
    my $vSeverity = shift;
    my $severity = "";
    if ($vSeverity eq "5") { $severity = "Clear"; }
    if ($vSeverity eq "4") { $severity = "Critical"; }
    if ($vSeverity eq "3") { $severity = "Major"; }
    if ($vSeverity eq "1") { $severity = "Warning"; }
    if ($vSeverity eq "0") { $severity = "Clear"; }
    if ($vSeverity eq "2") { $severity = "Minor"; }
    if ($vSeverity eq "6") { $severity = "0"; }
    return $severity;
}

# ptDSCNodesTpsMissingUpdate
sub _1_3_6_1_4_1_1556_17_0_1860
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The maximum number of missing TPS system update exceeds the threshold.\nTrapName = ptDSCNodesTpsMissingUpdate,\n";
    
    my $dat_notification_id = 1300;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationLicenseError
sub _1_3_6_1_4_1_1556_17_0_2003
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A critical SS7 DB Applications license error has occurred\nTrapName = ptSS7DBAppsConfigurationLicenseError,\n";
    
    my $dat_notification_id = 1301;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPortMpmtp2PortStatusCriticalClear
sub _1_3_6_1_4_1_1556_17_0_5821
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that all critical status events have cleared Cause  - All phyical port or link problems contributing to the major port status events have been rectified. Action - None required Freq   - This trap will appear when the user sets the Loopback attribute to DISABLED or the system has started with this configured value for Loopback Mode. References - ptOriginatingOID:    DYNAMIC ptPort - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 6 Communications subsystem error - ptTrapClearType:     1 fmic\nTrapName = ptPortMpmtp2PortStatusCriticalClear,\n";
    
    my $dat_notification_id = 1302;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWPortPortNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIncomingADNRoutingTableDSCIncAdnDiscardConfiguredCleared
sub _1_3_6_1_4_1_1556_17_0_1836
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC routing table is no longer configured to discard messages.\nTrapName = ptIncomingADNRoutingTableDSCIncAdnDiscardConfiguredCleared,\n";
    
    my $dat_notification_id = 1303;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1810.1.1.1"})) {
        $dat_additional_text .= "\nptDSCIncomingADNRoutingTableTableName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1810.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPCEPcePeerDown
sub _1_3_6_1_4_1_1556_17_0_4304
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates a PCE peer is no longer reachable.   Sent when a PCE peer communication is lost via LDL. Peer connectivity interruptions include: - PCE peer is terminated - IP connectivity heartbeat/keep alive fails - IP connectivity is lost between PCE processes.\nTrapName = ptPCEPcePeerDown,\n";
    
    my $dat_notification_id = 1304;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIrscFtpUploadFailed
sub _1_3_6_1_4_1_1556_17_0_5509
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an irsc ftp upload failed\nTrapName = ptIrscFtpUploadFailed,\n";
    
    my $dat_notification_id = 1305;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3UAASPAssocDown
sub _1_3_6_1_4_1_1556_17_0_7306
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a configured association is down. Cause: No ASP has connected to this ID and sent an ASPUP notification. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm ptTrapSeverity: 3 minor ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType: 1 fmic\nTrapName = ptM3UAASPAssociationM3UAASPAssocDown,\n";
    
    my $dat_notification_id = 1306;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3LinkInvalidOpcDetect
sub _1_3_6_1_4_1_1556_17_0_9954
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "MTP3 discarded link messages with invalid OPC. This alarm will clear automatically if no more message with invalid OPC is detected for 5 minutes.\nTrapName = ptMTP3NAMtp3LinkInvalidOpcDetect,\n";
    
    my $dat_notification_id = 1307;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkRemoteUninhibited
sub _1_3_6_1_4_1_1556_17_0_7178
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been uninhibited  at the remote end of a link. This can be requested by the operator or by signaling routing control function . Signaling routing  control will initiate signaling link uninhibit if an inhibited  link is found to be a member of a linkset in a route to a destination which has become inaccessible.  References 1) Table 2 Q.752, End of remote inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 43 Resource at or near capacity   ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkRemoteUninhibited,\n";
    
    my $dat_notification_id = 1308;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkRemoteUninhibited
sub _1_3_6_1_4_1_1556_17_0_7138
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been uninhibited  at the remote end of a link. This can be requested by the operator or by signaling routing control function . Signaling routing  control will initiate signaling link uninhibit if an inhibited  link is found to be a member of a linkset in a route to a destination which has become inaccessible.  References 1) Table 2 Q.752, End of remote inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 43 Resource at or near capacity   ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL3LinkRemoteUninhibited,\n";
    
    my $dat_notification_id = 1309;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCPULoadUsageCritical
sub _1_3_6_1_4_1_1556_17_0_6263
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "CPU load average is high. The slot number indicated in this trap  indicates the origin of the alarm. A process listing and top  output can identify the offending process(es). Cause  - Load Average above threshold Action - Identify applications running high on CPU Freq   - Irregular\nTrapName = ptSlotSlotCPULoadUsageCritical,\n";
    
    my $dat_notification_id = 1310;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.19"})) {
        $dat_additional_text .= "\nptSlotCPULoadUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.19"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASccpNADiscardMSUGTTClear
sub _1_3_6_1_4_1_1556_17_0_4219
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for MSU has been discarded by a SCCP GTT Connection.\nTrapName = ptSCCPNASccpNADiscardMSUGTTClear,\n";
    
    my $dat_notification_id = 1311;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"})) {
        $dat_additional_text .= "\nptSCCPSCCPNAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericLinkSCTPPathAvailable
sub _1_3_6_1_4_1_1556_17_0_8429
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the SCTP Association that carries traffic is no longer operating with a path failure. Clears GenericLinkSCTPPathUnavailable. References This trap is implementation specific. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:  29 Loss of signal    ptTrapClearType:       1 fmic\nTrapName = ptGenericLinkGenericLinkSCTPPathAvailable,\n";
    
    my $dat_notification_id = 1312;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexTCAPAutoLoadMonitor
sub _1_3_6_1_4_1_1556_17_0_2031
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications TCAP automatic load monitoring failed.\nTrapName = ptSS7DBAppsConfigurationSigFlexTCAPAutoLoadMonitor,\n";
    
    my $dat_notification_id = 1313;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTConfigurationGttDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_4421
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All debug attributes are set to their recommended values.\nTrapName = ptGTTConfigurationGttDebugLevelRecommended,\n";
    
    my $dat_notification_id = 1314;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3NASGSyncFail
sub _1_3_6_1_4_1_1556_17_0_7344
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MTP3 NA Sync Failed notification is sent when Dinamo refuses  to synchronize the newly added NA value from the MTP3 because it will cause a mismatch with the C20 Core.\nTrapName = ptMTP3NAMtp3NASGSyncFail,\n";
    
    my $dat_notification_id = 1315;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"})) {
        $dat_additional_text .= "\nptSGMTP3NANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUASCTPServersSuaLicClrCritical
sub _1_3_6_1_4_1_1556_17_0_7239
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Critical SUA License Event has been cleared\nTrapName = ptSUASCTPServersSuaLicClrCritical,\n";
    
    my $dat_notification_id = 1316;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2UALinkM2uaL3LinkUnavailable
sub _1_3_6_1_4_1_1556_17_0_8187
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is unavailable for user traffic. Cleared by m2uaL3LinkAvailable. Cause  - The link is unavailable to user traffic for some reason (e.g. out of service, blocked, inhibited). Action - Depends on link state. Freq   - Operator dependant. References 1) GR310CORE Issue 3 Section 8.1 2) GR246CORE Issue 10 3) GR82CORE  Issue 10 4) Q.704 ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        3 minor ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptM2UALinkM2uaL3LinkUnavailable,\n";
    
    my $dat_notification_id = 1317;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2UALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"})) {
        $dat_additional_text .= "\nptMTPM2UALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2UALinkIID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2UALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2UALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2UALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSGConfigurationSgDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_7276
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended value. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptSGConfigurationSgDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1318;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaMultiASPAssocHighTransmitUsageAbatem
sub _1_3_6_1_4_1_1556_17_0_7333
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The amount of traffic being transmitted to an M3UA ASP has received normal levels. The conditions of this clear event are controlled by the user using the M3UA High Usage Abatement setting.\nTrapName = ptM3UAASPAssociationM3uaMultiASPAssocHighTransmitUsageAbatem,\n";
    
    my $dat_notification_id = 1319;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAConnectionNPGWMTP3NAConnectionUp
sub _1_3_6_1_4_1_1556_17_0_1614
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The MTP3 NA connection is connected.\nTrapName = ptMTP3NAConnectionNPGWMTP3NAConnectionUp,\n";
    
    my $dat_notification_id = 1320;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1604.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwMTP3NAConnectionStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1604.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1604.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwMTP3NAConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1604.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkRemoteInhibited
sub _1_3_6_1_4_1_1556_17_0_7137
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been inhibited at a  remote node. Cause  - Operator has inhibited remote end of the link. Action - Link is inhibited until the operator uninhibits the  remote end of the link. Freq   - Operator dependant.  References 1) Table 2 Q.752, Start of remote inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm  ptTrapSeverity:      4 warning ptTrapProbableCause: 43 Resource at or near capacity   ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL3LinkRemoteInhibited,\n";
    
    my $dat_notification_id = 1321;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCpuUsageMinorThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_5518
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the CPU Usage has returned below its minor alarm threshold on a CPU Core\nTrapName = ptCpuUsageMinorThresholdCleared,\n";
    
    my $dat_notification_id = 1322;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1021"})) {
        $dat_additional_text .= "\nptTrapCpuUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.1021"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1020"})) {
        $dat_additional_text .= "\nptTrapCpuCore = " . $entrada->{"1.3.6.1.4.1.1556.17.1020"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAASPSuaUserConnLoss
sub _1_3_6_1_4_1_1556_17_0_7224
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A user connection loss notification is sent when the connection between an ASP and Dinamo is lost.\nTrapName = ptSUAASPSuaUserConnLoss,\n";
    
    my $dat_notification_id = 1323;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"})) {
        $dat_additional_text .= "\nptSGSUAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL2LinkAligned
sub _1_3_6_1_4_1_1556_17_0_7162
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been aligned. Cause  - After a signaling link failure is detected, signaling link initial alignment will take place. The Alignment procedure  passes through a number of states and when the procedure  enters the state aligned this trap is sent. Freq   - Once the alignment procedure enters the aligned state then the alignment procedure will not be repeated.  References 1) Q.703 , (07/96) Section 7.3  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL2LinkAligned,\n";
    
    my $dat_notification_id = 1324;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.8"})) {
        $dat_additional_text .= "\nptMTPATMLinkL2State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSwitchFabricUp
sub _1_3_6_1_4_1_1556_17_0_6299
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The fabric associated to this switch card is now operational. Cause  - Fabric is operational. Action - None. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Application - ptTrapType:          4  equipment alarm - ptTrapSeverity:      5  clear - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptSwitchFabricUp,\n";
    
    my $dat_notification_id = 1325;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotMonitorSlotTIPCAuditReport
sub _1_3_6_1_4_1_1556_17_0_6258
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A TIPC discrepancy has been detected.  Please review /tmp/TIPC_Audit.txt and transmit it to SS7 Support if there appears to be any system instability. Cause  - TIPC audit suggest there may be internal communications problems. Action - Verify system stability. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4  equipment alarm - ptTrapSeverity:      2  major - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptSlotMonitorSlotTIPCAuditReport,\n";
    
    my $dat_notification_id = 1326;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"})) {
        $dat_additional_text .= "\nptSlotMonitorHostname = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSFGUASCCPAppServerSFGUADataDiscardSet
sub _1_3_6_1_4_1_1556_17_0_7402
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 18.1.0 This trap indicates that a data message has been received  at the SCCP SFG UA Application Server and was discarded as routing to SFG SCCP UAs is not supported Cause - Possible causes include incorrect configuration  in the Gateway screening tables for the incoming linkset indicated by the DPC. Action - Check that the provisioning in gateway screening is correct. Freq - this trap will occur if a data message is received at an SFG UA  application server. It will remain active as long as there are data messages arriving within a 5 minute period. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm  ptTrapSeverity: 3 minor  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType: 1 fmic\nTrapName = ptSFGUASCCPAppServerSFGUADataDiscardSet,\n";
    
    my $dat_notification_id = 1327;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.260.261.263.1.1.1"})) {
        $dat_additional_text .= "\nptSGSFGUASCCPAppServerRoutingContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.260.261.263.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTDBDefGttOpcLoopClear
sub _1_3_6_1_4_1_1556_17_0_4416
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "GTT OPC Loop Detection no longer discards messages for 5 minutes.\nTrapName = ptGTTDBDefGttOpcLoopClear,\n";
    
    my $dat_notification_id = 1328;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.683.684.1.1.1"})) {
        $dat_additional_text .= "\nptGTTGTTDBDefName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.683.684.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkUninhibitDenied
sub _1_3_6_1_4_1_1556_17_0_8111
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an attempt to uninhibit an M2PA signaling link has failed. Cause  - A request to uninhibit a link from the local node to a  destination will fail if all the routes to the destination are unavailable. Action - Operator will have to wait until a route to the destination becomes available in order that it can send an uninhibit link  message.  Freq   - Operator dependant. References 1) Q.704 , (07/96) Section 10.2        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 56 Underlying resource unavailable ptTrapClearType:     2 oic\nTrapName = ptM2PALinkM2paL3LinkUninhibitDenied,\n";
    
    my $dat_notification_id = 1329;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSwitchSwitchIntegrityPassed
sub _1_3_6_1_4_1_1556_17_0_6293
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The integrity status of this switch is passed. This status is determined by on-board background tests performed continually. Cause  - Switch Integrity has been reported as Passed. Action - None. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Application - ptTrapType:          4  equipment alarm - ptTrapSeverity:      5  clear - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptSwitchSwitchIntegrityPassed,\n";
    
    my $dat_notification_id = 1330;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUASCTPServerSUASCTPServerDown
sub _1_3_6_1_4_1_1556_17_0_7356
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An SUA SCTP server is down and not accepting connections. Cause - The SG is unable to establish a server socket with  the current configuration.  Possible Actions -  If unresolved hostname alarms exist for this server,  troubleshoot those first.  Once the hostnames resolve the  condition may clear. If using hostnames, ensure they are resolving properly to  IP addresses that are valid for the configured Slot. Use IP Networking > Hostname Resolution to verify hostname configuration. Use IP Networking > Network Interfaces > Routing IP Network to verify Slot IP addresses. If using IP addresses, ensure the IP addresses are valid for the configured Slot.   Use IP Networking > Network Interfaces > Routing IP Network to verify Slot IP addresses.\nTrapName = ptSUASCTPServerSUASCTPServerDown,\n";
    
    my $dat_notification_id = 1331;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptApplicationSlotApplicationStopped
sub _1_3_6_1_4_1_1556_17_0_6256
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The named application has stopped running.  May be due to user interaction or application fault. Cause  - Application is not running. Action - Verify services. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Application - ptTrapType:          4  equipment alarm - ptTrapSeverity:      2  major - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptApplicationSlotApplicationStopped,\n";
    
    my $dat_notification_id = 1332;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.603.1.1.3"})) {
        $dat_additional_text .= "\nptApplicationApplicationState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.603.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.603.1.1.1"})) {
        $dat_additional_text .= "\nptApplicationSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.603.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.603.1.1.2"})) {
        $dat_additional_text .= "\nptApplicationApplicationName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.603.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAMultiAssociationASPM3UAMultiAssocASPDown
sub _1_3_6_1_4_1_1556_17_0_7304
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a Multipath ASP is down. Cause: No ASP has connected to this ID and sent an ASPUP notification. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm ptTrapSeverity: 3 minor ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType: 1 fmic\nTrapName = ptM3UAMultiAssociationASPM3UAMultiAssocASPDown,\n";
    
    my $dat_notification_id = 1333;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAMultiAssociationASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAMultiAssociationASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIMFTrafficProcessImfTrafficLossNotif
sub _1_3_6_1_4_1_1556_17_0_8400
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "IMF process has noticed a traffic loss.\nTrapName = ptIMFTrafficProcessImfTrafficLossNotif,\n";
    
    my $dat_notification_id = 1334;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1154.1155.1.1.1"})) {
        $dat_additional_text .= "\nptimfIMFTrafficProcessName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1154.1155.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1154.1155.1.1.2"})) {
        $dat_additional_text .= "\nptimfIMFTrafficProcessSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1154.1155.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3AppIDLinkOutageClear
sub _1_3_6_1_4_1_1556_17_0_8196
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The MTP3 NA has the AppID registration and is no longer in Link Outage.\nTrapName = ptMTP3NAMtp3AppIDLinkOutageClear,\n";
    
    my $dat_notification_id = 1335;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"})) {
        $dat_additional_text .= "\nptMTPMTP3NALocalPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIOManagerMpmtp2DebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_5823
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All debug attributes are set to their recommended values.\nTrapName = ptIOManagerMpmtp2DebugLevelRecommended,\n";
    
    my $dat_notification_id = 1336;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASccpNANotConnected
sub _1_3_6_1_4_1_1556_17_0_7232
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An SCCP NA not connected notification is sent when the connectivity between the Dinamo and SCCP NA is lost.\nTrapName = ptSCCPNASccpNANotConnected,\n";
    
    my $dat_notification_id = 1337;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.255.256.1.1.1"})) {
        $dat_additional_text .= "\nptSGSCCPNANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.255.256.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkUnavailable
sub _1_3_6_1_4_1_1556_17_0_8181
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is unavailable for user traffic. Cleared by annexaL3LinkAvailable. Cause  - The link is unavailable to user traffic for some reason (e.g. out of service, blocked, inhibited). Action - Depends on link state. Freq   - Operator dependant. References 1) GR310CORE Issue 3 Section 8.1 2) GR246CORE Issue 10 3) GR82CORE  Issue 10 4) Q.704 ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        3 minor ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkUnavailable,\n";
    
    my $dat_notification_id = 1338;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTConfigurationGttLicenseSuccess
sub _1_3_6_1_4_1_1556_17_0_4410
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap clears  trap 4409.\nTrapName = ptGTTConfigurationGttLicenseSuccess,\n";
    
    my $dat_notification_id = 1339;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPCEPceProcessShutdown
sub _1_3_6_1_4_1_1556_17_0_4302
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates the PCE process is shutting down.   Sent every time PCE is terminated (intentionally or not). System based termination include: - LDL Configuration error - Process received a terminating signal (SIGINT, SIGTERM).\nTrapName = ptPCEPceProcessShutdown,\n";
    
    my $dat_notification_id = 1340;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaSP2KMultiAssocConnLoss
sub _1_3_6_1_4_1_1556_17_0_7366
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An ASP multi association loss notification is sent when the connection between an ASP and SG is lost.\nTrapName = ptM3UAASPAssociationM3uaSP2KMultiAssocConnLoss,\n";
    
    my $dat_notification_id = 1341;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkInhibitDenied
sub _1_3_6_1_4_1_1556_17_0_7139
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an attempt to inhibit a signaling link  has failed. This is a stateless trap (no alarm). Causes ,Corrective actions and Frequency:  1) ptSpecificTrapCause = DPC not available  Cause  - This trap occurs when a request to inhibit a link will result in a destination becoming inaccessible and therefore the request is denied. Action - Operator will have to create another link  to access the destination before attempting to inhibit this  one. Freq   - Depends on how many destinations have single links and how often management wants to inhibit them.  2) ptSpecificTrapCause = Negative ACK from remote end Cause  - This trap occurs when a request to inhibit the link at the  remote end of a link results in a destination becoming  inaccessible.  Action - Operator will have to wait until another link is available to the destination before inhibiting this one.   Freq   - Depends on how many destinations have single links and how often management wants to inhibit them.  3) ptSpecificTrapCause = UnknownCause  References 1) Q.704 , (07/96) Section 10.2        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm  ptTrapSeverity:      4 warning ptTrapProbableCause: 56 Underlying resource unavailable  ptTrapClearType:     2 oic\nTrapName = ptATMLinkAtmL3LinkInhibitDenied,\n";
    
    my $dat_notification_id = 1342;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCpuCertificateExpiryDateExtended
sub _1_3_6_1_4_1_1556_17_0_3163
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Expiry date of the certificate in this slot is now extended.\nTrapName = ptSlotSlotCpuCertificateExpiryDateExtended,\n";
    
    my $dat_notification_id = 1343;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"})) {
        $dat_additional_text .= "\nptSlotPrimaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"})) {
        $dat_additional_text .= "\nptSlotSecondaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAASPSuaAssocHighReceiveUsageAbatement
sub _1_3_6_1_4_1_1556_17_0_7327
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The amount of traffic being received from an SUA ASP has received normal levels. The conditions of this clear event are controlled by the user using the SUA High Usage Abatement setting.\nTrapName = ptSUAASPSuaAssocHighReceiveUsageAbatement,\n";
    
    my $dat_notification_id = 1344;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"})) {
        $dat_additional_text .= "\nptSGSUAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptProcessEventFileWriteFailure
sub _1_3_6_1_4_1_1556_17_0_8302
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the peer had a write failure.\nTrapName = ptProcessEventFileWriteFailure,\n";
    
    my $dat_notification_id = 1345;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"})) {
        $dat_additional_text .= "\nptpeereventProcessEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"})) {
        $dat_additional_text .= "\nptpeereventProcessEventSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAConfiguredASPSUAConfASPEndPtConflictResolved
sub _1_3_6_1_4_1_1556_17_0_7605
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "IP Conflicts with existing SUA Configured ASPs resolved\nTrapName = ptSUAConfiguredASPSUAConfASPEndPtConflictResolved,\n";
    
    my $dat_notification_id = 1346;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptHardwareMonitorHwMonStartup
sub _1_3_6_1_4_1_1556_17_0_6301
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Hardware Monitor started. Cause  - Hardware Monitor started Action - None Freq   - Infrequent References - ptOriginatingOID:    DYNAMIC ptHwMon - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptHardwareMonitorHwMonStartup,\n";
    
    my $dat_notification_id = 1347;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1.1.1"})) {
        $dat_additional_text .= "\npthwmonHardwareMonitorStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptHardwareMonitorHwMonDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_6304
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptHardwareMonitorHwMonDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1348;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASccpNADiscardMSUUnexpectedSI
sub _1_3_6_1_4_1_1556_17_0_4212
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SCCP received an MSU from MTP3 with an SI not equal to 3 (unexpected) in the past 5 minutes. Possible Actions -  The user should check the MTP3 VNode and Routeset configuration or Gateway Redirection where applicable.  The Destination Point Code (DPC) of such MSUs can be found in the debuglog\nTrapName = ptSCCPNASccpNADiscardMSUUnexpectedSI,\n";
    
    my $dat_notification_id = 1349;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"})) {
        $dat_additional_text .= "\nptSCCPSCCPNAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptThresholdSensorUpperMinorAssert
sub _1_3_6_1_4_1_1556_17_0_6344
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A threshold sensor upper minor alarm was asserted Cause  - A threshold sensor detects an upper minor condition Action - Verify sensor Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      3 minor - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptThresholdSensorUpperMinorAssert,\n";
    
    my $dat_notification_id = 1350;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPortClockingMpmtp2ReferenceClockIsPrimary
sub _1_3_6_1_4_1_1556_17_0_5809
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the clock source is referenced from the PRIMARY setting Cause  - The PRIMARY setting is used as the reference clock Action - None required Freq   - This trap will appear when the clocking reference is derived from the PRIMARY setting References - ptOriginatingOID:    DYNAMIC ptTDMCard - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 6 Communications subsystem error - ptTrapClearType:     1 fmic\nTrapName = ptPortClockingMpmtp2ReferenceClockIsPrimary,\n";
    
    my $dat_notification_id = 1351;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1088.1.1.44"})) {
        $dat_additional_text .= "\nptIOHWPortClockingCurrentClockSource = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1088.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPPCSSNRegistrationIWFSCCPPCSSNSuccess
sub _1_3_6_1_4_1_1556_17_0_1912
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP PC-SSN Registration was successful on all the defined SCCP Connections.\nTrapName = ptSCCPPCSSNRegistrationIWFSCCPPCSSNSuccess,\n";
    
    my $dat_notification_id = 1352;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1909.1.1.2"})) {
        $dat_additional_text .= "\nptiwfSCCPPCSSNRegistrationSSN = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1909.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1909.1.1.1"})) {
        $dat_additional_text .= "\nptiwfSCCPPCSSNRegistrationPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1909.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1909.1.1.3"})) {
        $dat_additional_text .= "\nptiwfSCCPPCSSNRegistrationStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1909.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptINAPGWConfigurationINAPGWSS7Down
sub _1_3_6_1_4_1_1556_17_0_1301
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The INAPGW traffic is deactivated or all SCCP NAs are not connected.\nTrapName = ptINAPGWConfigurationINAPGWSS7Down,\n";
    
    my $dat_notification_id = 1353;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1301.1.1.2"})) {
        $dat_additional_text .= "\nptinapgwINAPGWConfigurationTrafficStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1301.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetSs7LinksetInaccessible
sub _1_3_6_1_4_1_1556_17_0_7155
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an SS7 linkset is no longer accessible. Cause  - The linkset destination may become inaccessible for a number of reasons including - Linkset deactivation - All links in the linkset are no longer aligned Action - Depends on the cause  Freq   - This trap will appear when the status of a linkset status changes from active to inactive or failed.   References  1) Q.703  ptOriginatingOID: DYNAMIC ptLinkset  ptTrapType: 2 communicationAlarm  ptTrapSeverity: 1 critical ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType: 1 fmic\nTrapName = ptLinksetSs7LinksetInaccessible,\n";
    
    my $dat_notification_id = 1354;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLinksetState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionADNConnAssocMaxMsgSizeAbort
sub _1_3_6_1_4_1_1556_17_0_1820
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "ADN Connection Association closed because it received a message exceeding the maximum size.\nTrapName = ptADNConnectionADNConnAssocMaxMsgSizeAbort,\n";
    
    my $dat_notification_id = 1355;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkUsageHighSet
sub _1_3_6_1_4_1_1556_17_0_8134
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the average traffic over this link exceeds predefined threshold. There is potential for traffic loss if this condition persists. References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 51 Threshold crossed ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L3LinkUsageHighSet,\n";
    
    my $dat_notification_id = 1356;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDiscreteSensorThermTripDeassert
sub _1_3_6_1_4_1_1556_17_0_6325
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A discrete sensor therm trip alarm was deasserted Cause  - A discrete sensor no longer detects a therm trip condition Action - None Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptDiscreteSensorThermTripDeassert,\n";
    
    my $dat_notification_id = 1357;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAConfiguredASPSUAConfiguredASPUp
sub _1_3_6_1_4_1_1556_17_0_7313
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a Configured ASP is now up.   Cause: An ASP has connected and sent an ASPUP notification. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm  ptTrapSeverity: 5 cleared  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType: 1 fmic\nTrapName = ptSUAConfiguredASPSUAConfiguredASPUp,\n";
    
    my $dat_notification_id = 1358;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAppIDRegistrationAppIDRegistrationSuccess
sub _1_3_6_1_4_1_1556_17_0_4414
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the AppID registration is successful.\nTrapName = ptAppIDRegistrationAppIDRegistrationSuccess,\n";
    
    my $dat_notification_id = 1359;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.653.654.674.1.1.1"})) {
        $dat_additional_text .= "\nptGTTAppIDRegistrationApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.653.654.674.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAManagerSccpProcessStartup
sub _1_3_6_1_4_1_1556_17_0_4201
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates the SCCP process is starting up.   Sent every time SCCP starts up via a manual intervention or typically  via the watchdog.\nTrapName = ptSCCPNAManagerSccpProcessStartup,\n";
    
    my $dat_notification_id = 1360;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCpuUsageMinorAbated
sub _1_3_6_1_4_1_1556_17_0_6241
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "CPU usage has returned to reasonable levels. Cause  - CPU usage below threshold. Action - None. Freq   - Irregular.\nTrapName = ptSlotSlotCpuUsageMinorAbated,\n";
    
    my $dat_notification_id = 1361;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLocalRedirectRecordLocalRedirectDuplicateThrottleOff
sub _1_3_6_1_4_1_1556_17_0_8005
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This event indicates that the Local Redirect Record has not hit its maximum rate for duplicating MSUs during the last five minutes. The Local Redirect Record Duplicate is no longer at the maximum limit. \nClears event 8004 LocalRedirectDuplicateThrottleOn.\nTrapName = ptLocalRedirectRecordLocalRedirectDuplicateThrottleOff,\n";
    
    my $dat_notification_id = 1362;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.793.1.1.1"})) {
        $dat_additional_text .= "\nptMTPLocalRedirectRecordDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.793.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.793.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLocalRedirectRecordMessageCategory = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.793.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIsmVarPartitionThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_5528
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the ISM /var partition usage has returned below its alarm threshold\nTrapName = ptIsmVarPartitionThresholdCleared,\n";
    
    my $dat_notification_id = 1363;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexFlxRtgReady
sub _1_3_6_1_4_1_1556_17_0_2025
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications Routing Server now ready.\nTrapName = ptSS7DBAppsConfigurationSigFlexFlxRtgReady,\n";
    
    my $dat_notification_id = 1364;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionADNConnAssocMaxMsgSizeAbortClear
sub _1_3_6_1_4_1_1556_17_0_1821
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "ADN Connection Association is back up after aborting due to receiving an oversized message.\nTrapName = ptADNConnectionADNConnAssocMaxMsgSizeAbortClear,\n";
    
    my $dat_notification_id = 1365;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPM3uaUserConnEstablished
sub _1_3_6_1_4_1_1556_17_0_7229
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A user connection established notification is sent when the connection between an ASP and Dinamo is established.\nTrapName = ptM3UAASPM3uaUserConnEstablished,\n";
    
    my $dat_notification_id = 1366;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptServerPoolServerPoolNoDBPeerUPClear
sub _1_3_6_1_4_1_1556_17_0_1817
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "DB Peer is no longer down for use with Server Pool.\nTrapName = ptServerPoolServerPoolNoDBPeerUPClear,\n";
    
    my $dat_notification_id = 1367;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIOManagerMpmtp2DebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_5822
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptIOManagerMpmtp2DebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1368;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGWSTConfigurationGR310MessageLossClear
sub _1_3_6_1_4_1_1556_17_0_1004
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "No further message loss has been reported to the active GR-310 server in the last 5 minutes\nTrapName = ptGWSTConfigurationGR310MessageLossClear,\n";
    
    my $dat_notification_id = 1369;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkInhibitDenied
sub _1_3_6_1_4_1_1556_17_0_8109
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an attempt to inhibit an M2PA signaling link  has failed. Causes ,Corrective actions and Frequency:  1) ptSpecificTrapCause = DPC not available  Cause  - This trap occurs when a request to inhibit a link will result in a destination becoming inaccessible and therefore the request is denied. Action - Operator will have to create another link  to access the destination before attempting to inhibit this  one. Freq   - Depends on how many destinations have single links and how often management wants to inhibit them.  2) ptSpecificTrapCause = Negative ACK from remote end Cause  - This trap occurs when a request to inhibit the link at the  remote end of a link results in a destination becoming  inaccessible.  Action - Operator will have to wait until another link is available to the destination before inhibiting this one.   Freq   - Depends on how many destinations have single links and how often management wants to inhibit them.  3) ptSpecificTrapCause = UnknownCause  References 1) Q.704 , (07/96) Section 10.2        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm  ptTrapSeverity:      2 major ptTrapProbableCause: 56 Underlying resource unavailable  ptTrapClearType:     2 oic\nTrapName = ptM2PALinkM2paL3LinkInhibitDenied,\n";
    
    my $dat_notification_id = 1370;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotExtracted
sub _1_3_6_1_4_1_1556_17_0_6310
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Slot extracted/deactivated. Cause  - Slot extracted Action - Check hardware configuration Freq   - Infrequent References - ptOriginatingOID:    DYNAMIC ptHwMon - ptTrapType:          4 equipment alarm - ptTrapSeverity:      2 major - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptSlotSlotExtracted,\n";
    
    my $dat_notification_id = 1371;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1.1.1"})) {
        $dat_additional_text .= "\npthwmonSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3NAC20SyncSucc
sub _1_3_6_1_4_1_1556_17_0_7321
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MTP3 NA Sync Success notification is sent when Dinamo synchronizes the newly add NA value to C20 Core and mismatch is corrected.\nTrapName = ptMTP3NAMtp3NAC20SyncSucc,\n";
    
    my $dat_notification_id = 1372;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"})) {
        $dat_additional_text .= "\nptSGMTP3NANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASccpNADiscardMSUUser
sub _1_3_6_1_4_1_1556_17_0_4216
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An unexpected MSU has been discarded by a SCCP User Connection  in the past 5 minutes.\nTrapName = ptSCCPNASccpNADiscardMSUUser,\n";
    
    my $dat_notification_id = 1373;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"})) {
        $dat_additional_text .= "\nptSCCPSCCPNAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANodeNoSTPRoutingLicense
sub _1_3_6_1_4_1_1556_17_0_9981
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An attempt by the MTP3 NA to obtain a STP Routing license has failed\nTrapName = ptMTP3NANodeNoSTPRoutingLicense,\n";
    
    my $dat_notification_id = 1374;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.6"})) {
        $dat_additional_text .= "\nptMTPMTP3NAStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAASPSUAMsuDiscardSet
sub _1_3_6_1_4_1_1556_17_0_7378
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An SUA message has been unexpectedly discarded in the last 5-minute.\nTrapName = ptSUAASPSUAMsuDiscardSet,\n";
    
    my $dat_notification_id = 1375;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"})) {
        $dat_additional_text .= "\nptSGSUAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUAASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.25"})) {
        $dat_additional_text .= "\nptSGSUAASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.25"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAAppServerM3UADiscardMsuFromPeerClear
sub _1_3_6_1_4_1_1556_17_0_7383
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Alarm for discard MSU unexpectedly between peers on M3UA AS has been cleared as no further MSU have been unexpectedly discarded.\nTrapName = ptM3UAAppServerM3UADiscardMsuFromPeerClear,\n";
    
    my $dat_notification_id = 1376;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.9"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerSI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerRoutingContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerNetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPSXHostConnectionNPGWPSXHostConnDown
sub _1_3_6_1_4_1_1556_17_0_1621
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW PSX Host Connection is deactivated or not connected.\nTrapName = ptPSXHostConnectionNPGWPSXHostConnDown,\n";
    
    my $dat_notification_id = 1377;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1620.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwPSXHostConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1620.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1620.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwPSXHostConnectionStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1620.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPortMpmtp2PortStatusMajor
sub _1_3_6_1_4_1_1556_17_0_5818
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an MTP2 major port status event has occurred. Cause  - An error has occurred on the port. Action - Verify the functionality of the link and ports both locally and at the remote end. Freq   - This trap will appear whenever a major port status event occurs References - ptOriginatingOID:    DYNAMIC ptPort - ptTrapType:          4 equipment alarm - ptTrapSeverity:      2 major - ptTrapProbableCause: 6 Communications subsystem error - ptTrapClearType:     1 fmic\nTrapName = ptPortMpmtp2PortStatusMajor,\n";
    
    my $dat_notification_id = 1378;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWPortPortNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAManagerSccpResMgrUp
sub _1_3_6_1_4_1_1556_17_0_4206
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates SCCP is connected to the resource manager.\nTrapName = ptSCCPNAManagerSccpResMgrUp,\n";
    
    my $dat_notification_id = 1379;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPSXNPGWPSXInactive
sub _1_3_6_1_4_1_1556_17_0_1631
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW PSX is deactivated.\nTrapName = ptPSXNPGWPSXInactive,\n";
    
    my $dat_notification_id = 1380;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.4"})) {
        $dat_additional_text .= "\nptnpgwPSXUserActivated = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwPSXName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkDeactivated
sub _1_3_6_1_4_1_1556_17_0_8103
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA signaling link has been deactivated. Causes ,Corrective actions and Frequency:   1) ptSpecificTrapCause = operatorDeactivation  Cause  - Operator deactivates link. Action - Operator can activate the link again. Freq   - Operator dependant.  2) ptSpecificTrapCause = timerT17Expiry Cause  - Event appears between each attempt to perform an initial  alignment procedure. After an unsuccessful attempt, a delay T17 expires before the next attempt is initiated. Action - Operator can activate the link.   Freq   - T19 expiry, T19 can take a value between 800 - 1500 ms 3) ptSpecificTrapCause = unknownCause References 1) Table 1 Q.752, SL Failure 2) Q.704 (07/96) Section 12.2  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 29 Loss of signal    ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paL3LinkDeactivated,\n";
    
    my $dat_notification_id = 1381;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSNAMIConfigurationGR310MessageLossClear
sub _1_3_6_1_4_1_1556_17_0_1504
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The GR310 server message loss interval has expired.\nTrapName = ptSNAMIConfigurationGR310MessageLossClear,\n";
    
    my $dat_notification_id = 1382;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLH110ChannelMpmtp2H110SigChanLoopbackSet
sub _1_3_6_1_4_1_1556_17_0_5804
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the H110 signaling channel loopback mode setting has been changed from the default DISABLED mode Cause  - A user has modified the attribute Action - Reset to DISABLED for normal operation Freq   - This trap will appear when the user sets the Loopback mode attribute to anything other than DISABLED References - ptOriginatingOID:    DYNAMIC ptH110SignalingChannel - ptTrapType:          2 communication alarm - ptTrapSeverity:      3 minor - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptLSLH110ChannelMpmtp2H110SigChanLoopbackSet,\n";
    
    my $dat_notification_id = 1383;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1100.1.1.10"})) {
        $dat_additional_text .= "\nptIOHWLSLH110ChannelLoopbackMode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1100.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1100.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWLSLH110ChannelChannelNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1100.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptEventAlarmCommentUpdate
sub _1_3_6_1_4_1_1556_17_0_6666
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the event object has changed state.\nTrapName = ptEventAlarmCommentUpdate,\n";
    
    my $dat_notification_id = 1384;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.981.982.1.1.23"})) {
        $dat_additional_text .= "\nptLIBEVEventComment = " . $entrada->{"1.3.6.1.4.1.1556.17.15.981.982.1.1.23"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.981.982.1.1.6"})) {
        $dat_additional_text .= "\nptLIBEVEventInstanceId = " . $entrada->{"1.3.6.1.4.1.1556.17.15.981.982.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.981.982.1.1.4"})) {
        $dat_additional_text .= "\nptLIBEVEventEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.981.982.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesDSCLocalOverloadDiscardCleared
sub _1_3_6_1_4_1_1556_17_0_1859
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC Node has not discarded messages due to configured local overload handling for 5 minutes\nTrapName = ptDSCNodesDSCLocalOverloadDiscardCleared,\n";
    
    my $dat_notification_id = 1385;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIWFSS7IWFSS7ConfigurationValid
sub _1_3_6_1_4_1_1556_17_0_1906
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The MTP3 configuration information provided by the SCCP to the IWF matches with the IWF SS7 configuration.\nTrapName = ptIWFSS7IWFSS7ConfigurationValid,\n";
    
    my $dat_notification_id = 1386;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.4"})) {
        $dat_additional_text .= "\nptiwfIWFSS7PCDisplayFormat = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.3"})) {
        $dat_additional_text .= "\nptiwfIWFSS7SCCPPAEncoding = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.5"})) {
        $dat_additional_text .= "\nptiwfIWFSS7PCRoutingFormat = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.1"})) {
        $dat_additional_text .= "\nptiwfIWFSS7SCCPNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotBackupSpaceUsageCriticalAbated
sub _1_3_6_1_4_1_1556_17_0_6271
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "HDD space for backups has returned to reasonable levels. Cause  - HDD space for backups has been restored.  Action - None. Freq   - Irregular.\nTrapName = ptSlotSlotBackupSpaceUsageCriticalAbated,\n";
    
    my $dat_notification_id = 1387;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.18"})) {
        $dat_additional_text .= "\nptSlotBackupSpaceUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.18"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3UAASPAssocUnresolvedLocalHost1
sub _1_3_6_1_4_1_1556_17_0_7700
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that M3UA ASP Association Local IP Address 1 hostname is not resolvable. Cause - The SG is unable to resolve the hostname. Possible Actions - If the DSC has been set up to use a DNS server,  ensure the DNS server is reachable and confirm that the hostname has been configured. If the hostname is intended to resolve locally, ensure the proper hostname entry  has been added using IP Networking > Hostname Resolution. Freq - This trap occurs when the configured hostname becomes unresolvable.\nTrapName = ptM3UAASPAssociationM3UAASPAssocUnresolvedLocalHost1,\n";
    
    my $dat_notification_id = 1388;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCICUATCPServerCicLicClrCritical
sub _1_3_6_1_4_1_1556_17_0_7251
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Critical CIC License Event has been cleared\nTrapName = ptCICUATCPServerCicLicClrCritical,\n";
    
    my $dat_notification_id = 1389;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotIsmEtcPartitionThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_6268
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "ISM /etc partition usage is above the alarm threshold defined in  disk_space_quota.  The slot number indicated in this trap indicates the origin of the alarm. Cause  - ISM /etc partition usage above threshold Action - Identify applications running high on disk space Freq   - Irregular\nTrapName = ptSlotSlotIsmEtcPartitionThresholdExceeded,\n";
    
    my $dat_notification_id = 1390;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCDBPartitionThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_5531
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the DSCDB Partition usage has reached its alarm threshold\nTrapName = ptDSCDBPartitionThresholdExceeded,\n";
    
    my $dat_notification_id = 1391;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionADNConnSecInvalid
sub _1_3_6_1_4_1_1556_17_0_1811
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The ADN Connection security parameter certificate is invalid. The TLS security file is missing or corrupted.\nTrapName = ptADNConnectionADNConnSecInvalid,\n";
    
    my $dat_notification_id = 1392;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSFGUASFGUAMsuDiscardClear
sub _1_3_6_1_4_1_1556_17_0_7381
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for MSU destined to SFG UA has been unexpectedly discarded.\nTrapName = ptSFGUASFGUAMsuDiscardClear,\n";
    
    my $dat_notification_id = 1393;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPM3uaAssocMinStreamsClear
sub _1_3_6_1_4_1_1556_17_0_7347
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The M3UA ASP association causing the minimum stream alarm has been aborted or removed\nTrapName = ptM3UAASPM3uaAssocMinStreamsClear,\n";
    
    my $dat_notification_id = 1394;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPPCSSNRegistrationINAPGWSCCPPCSSNSuccess
sub _1_3_6_1_4_1_1556_17_0_1308
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP PC-SSN registration was successful on all the defined SCCP connections.\nTrapName = ptSCCPPCSSNRegistrationINAPGWSCCPPCSSNSuccess,\n";
    
    my $dat_notification_id = 1395;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.3"})) {
        $dat_additional_text .= "\nptinapgwSCCPPCSSNRegistrationSSN = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.1"})) {
        $dat_additional_text .= "\nptinapgwSCCPPCSSNRegistrationNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.2"})) {
        $dat_additional_text .= "\nptinapgwSCCPPCSSNRegistrationPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.4"})) {
        $dat_additional_text .= "\nptinapgwSCCPPCSSNRegistrationStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexScrServerExit
sub _1_3_6_1_4_1_1556_17_0_2023
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications Scripting Server is shutting down.\nTrapName = ptSS7DBAppsConfigurationSigFlexScrServerExit,\n";
    
    my $dat_notification_id = 1396;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASCCPNAsDiscardMsuFromPeerClear
sub _1_3_6_1_4_1_1556_17_0_7389
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for MSU has been unexpectedly discarded between peers on SCCP NA Connection.\nTrapName = ptSCCPNASCCPNAsDiscardMsuFromPeerClear,\n";
    
    my $dat_notification_id = 1397;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.255.256.1.1.1"})) {
        $dat_additional_text .= "\nptSGSCCPNANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.255.256.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTDBDefGttOpcLoopFilterClear
sub _1_3_6_1_4_1_1556_17_0_4418
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "GTT OPC Loop Detection no longer filters PC List entries for 5 minutes.\nTrapName = ptGTTDBDefGttOpcLoopFilterClear,\n";
    
    my $dat_notification_id = 1398;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.683.684.1.1.1"})) {
        $dat_additional_text .= "\nptGTTGTTDBDefName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.683.684.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaSP2KMultiAssocConnEstablished
sub _1_3_6_1_4_1_1556_17_0_7367
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An ASP multi association established notification is sent when the connection between an ASP and SG is established.\nTrapName = ptM3UAASPAssociationM3uaSP2KMultiAssocConnEstablished,\n";
    
    my $dat_notification_id = 1399;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSwitchWarmStart
sub _1_3_6_1_4_1_1556_17_0_6288
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A switch card has recovered and issued a warm start.  The associated fabric is now operational. Cause  - Switch card is running. Action - None. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Application - ptTrapType:          4  equipment alarm - ptTrapSeverity:      4  warning - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     0  oic\nTrapName = ptSwitchWarmStart,\n";
    
    my $dat_notification_id = 1400;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexDBAuditChecksumError
sub _1_3_6_1_4_1_1556_17_0_2030
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications database audit checksum error.\nTrapName = ptSS7DBAppsConfigurationSigFlexDBAuditChecksumError,\n";
    
    my $dat_notification_id = 1401;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRoutesetRoutesetDestCongestedRecovery
sub _1_3_6_1_4_1_1556_17_0_8178
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that destination is no longer congested. Clears routesetDestCongested.\nTrapName = ptRoutesetRoutesetDestCongestedRecovery,\n";
    
    my $dat_notification_id = 1402;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"})) {
        $dat_additional_text .= "\nptMTPRoutesetContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRoutesetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"})) {
        $dat_additional_text .= "\nptMTPRoutesetDestinationState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"})) {
        $dat_additional_text .= "\nptMTPRoutesetDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAINAPGWSCCPNADown
sub _1_3_6_1_4_1_1556_17_0_1303
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP NA is deactivated or all SCCP NA connections are not connected.\nTrapName = ptSCCPNAINAPGWSCCPNADown,\n";
    
    my $dat_notification_id = 1403;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1.1.2"})) {
        $dat_additional_text .= "\nptinapgwSCCPNAStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1.1.1"})) {
        $dat_additional_text .= "\nptinapgwSCCPNANA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3UAASPAssocResolvedLocalHost1
sub _1_3_6_1_4_1_1556_17_0_7701
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "M3UA ASP Association Local IP Address 1 hostname is resolved\nTrapName = ptM3UAASPAssociationM3UAASPAssocResolvedLocalHost1,\n";
    
    my $dat_notification_id = 1404;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetSs7LinksetHalfOfLinksUnavailable
sub _1_3_6_1_4_1_1556_17_0_8150
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that at least half of the links of an SS7 linkset are unavailable for user traffic. Cause  - The linkset has at least half of the links unavailable. Possible reasons include: - Linkset just started alignment procedure - Links within linkset are no longer aligned Action - Depends on cause  Freq   - This trap will appear when half of the links are unavailable  ptOriginatingOID:    DYNAMIC ptLinkset ptTrapType:          2 communicationAlarm  ptTrapSeverity:      2 major  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptLinksetSs7LinksetHalfOfLinksUnavailable,\n";
    
    my $dat_notification_id = 1405;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLinksetState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGWSTConfigurationGwstDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_4007
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The GWST debugging levels are set to their recommended values.\nTrapName = ptGWSTConfigurationGwstDebugLevelRecommended,\n";
    
    my $dat_notification_id = 1406;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLChannelMpmtp2SigChanLoopbackCleared
sub _1_3_6_1_4_1_1556_17_0_5803
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the signaling channel loopback mode setting has been set to the default DISABLED mode Cause  - A user has reset the attribute to the default or the system has restarted with default values Action - None required Freq   - This trap will appear when the user sets the Loopback attribute to DISABLED or the system has started with this configured value for Loopback Mode. References - ptOriginatingOID:    DYNAMIC ptSignalingChannel - ptTrapType:          2 communication alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptLSLChannelMpmtp2SigChanLoopbackCleared,\n";
    
    my $dat_notification_id = 1407;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1099.1.1.6"})) {
        $dat_additional_text .= "\nptIOHWLSLChannelLoopbackMode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1099.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1099.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWLSLChannelChannelNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1099.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANodeStatusReceivedLic
sub _1_3_6_1_4_1_1556_17_0_9980
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An attempt by the MTP3 NA to obtain a software license has succeeded\nTrapName = ptMTP3NANodeStatusReceivedLic,\n";
    
    my $dat_notification_id = 1408;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.6"})) {
        $dat_additional_text .= "\nptMTPMTP3NAStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAVPRoutingTableDSCAvpDiscardConfiguredCleared
sub _1_3_6_1_4_1_1556_17_0_1842
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC routing table is no longer configured to discard messages.\nTrapName = ptAVPRoutingTableDSCAvpDiscardConfiguredCleared,\n";
    
    my $dat_notification_id = 1409;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1814.1.1.1"})) {
        $dat_additional_text .= "\nptDSCAVPRoutingTableTableName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1814.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodeDSCNodeDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_1871
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All node debug attributes are set to their recommended values.\nTrapName = ptDSCNodeDSCNodeDebugLevelRecommended,\n";
    
    my $dat_notification_id = 1410;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1.1.31"})) {
        $dat_additional_text .= "\nptDSCDSCNodeName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1.1.31"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1.1.1"})) {
        $dat_additional_text .= "\nptDSCDSCNodeNodeDiameterID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paSLSLinkAuditFailure
sub _1_3_6_1_4_1_1556_17_0_9995
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "MTP3 detected an unavailable link in an SLS Table. MSU loss is possible. Cleared by m2paSLSLinkAuditFailureClear. Cause  - MTP3 detected an unavailable link in an SLS Table. Action - This alarm should resolve itself in less than four minutes. If this alarm does not clear itself you should reset the link using the 'Reset' action on the link. Freq   - Operator dependant. References None. This is an implementation specific audit. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        1 critical ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptM2PALinkM2paSLSLinkAuditFailure,\n";
    
    my $dat_notification_id = 1411;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.6"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexMsgError
sub _1_3_6_1_4_1_1556_17_0_2041
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications message error.\nTrapName = ptSS7DBAppsConfigurationSigFlexMsgError,\n";
    
    my $dat_notification_id = 1412;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkRemoteUnblocked
sub _1_3_6_1_4_1_1556_17_0_7114
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been unblocked at a remote node. Causes ,Corrective actions and Frequency   1) ptSpecificTrapCause = linkDeactivated  Cause  -  Unknown Cause 2) ptSpecificTrapCause = unknownCause References 1) Table 2 Q.752 Stop of Remote Processor Outage 2) Q.704 Section 3.3.5       ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 42 Remote node transmission error   ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L3LinkRemoteUnblocked,\n";
    
    my $dat_notification_id = 1413;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPConnectionIWFSCCPConnectionDown
sub _1_3_6_1_4_1_1556_17_0_1909
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The IWF traffic is deactivated or the SCCP Connection is not connected. The SCCP associated NA must be active and available on the given slot.\nTrapName = ptSCCPConnectionIWFSCCPConnectionDown,\n";
    
    my $dat_notification_id = 1414;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1906.1907.1.1.1"})) {
        $dat_additional_text .= "\nptiwfSCCPConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1906.1907.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1906.1907.1.1.2"})) {
        $dat_additional_text .= "\nptiwfSCCPConnectionConnectivityStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1906.1907.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexManualLoadMonitoringStarted
sub _1_3_6_1_4_1_1556_17_0_2038
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications manual load monitoring started.\nTrapName = ptSS7DBAppsConfigurationSigFlexManualLoadMonitoringStarted,\n";
    
    my $dat_notification_id = 1415;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionADNConnectionFirewallBlocked
sub _1_3_6_1_4_1_1556_17_0_1824
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "No IP address resolutions can be made for the Remote Host.  With ADN Remote IP Validation ENABLED no connection can be successful.  Either change Remote Host or add a resolution for that value.\nTrapName = ptADNConnectionADNConnectionFirewallBlocked,\n";
    
    my $dat_notification_id = 1416;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.4"})) {
        $dat_additional_text .= "\nptDSCADNConnectionRemoteHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.4"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCpuUsageMinorThresholdCrossed
sub _1_3_6_1_4_1_1556_17_0_5517
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that CPU Usage has crossed its minor alarm threshold on a CPU Core\nTrapName = ptCpuUsageMinorThresholdCrossed,\n";
    
    my $dat_notification_id = 1417;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1020"})) {
        $dat_additional_text .= "\nptTrapCpuCore = " . $entrada->{"1.3.6.1.4.1.1556.17.1020"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1021"})) {
        $dat_additional_text .= "\nptTrapCpuUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.1021"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptTransportServerServerFirewallBlocked
sub _1_3_6_1_4_1_1556_17_0_1822
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC server has Remote IP Validation enabled and no active or no resolved Allowed IPs.  This may be raised shortly after creation before host resolution has been received. Enabled Allowed IP(s) under the server and/or add host resolutions for those addresses.\nTrapName = ptTransportServerServerFirewallBlocked,\n";
    
    my $dat_notification_id = 1418;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.5"})) {
        $dat_additional_text .= "\nptDSCTransportServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.1"})) {
        $dat_additional_text .= "\nptDSCTransportServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.6"})) {
        $dat_additional_text .= "\nptDSCTransportServerHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.6"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPPCSSNRegistrationNPGWSCCPPCSSNFailure
sub _1_3_6_1_4_1_1556_17_0_1607
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP PC-SSN registration was not successful on all the defined SCCP connections.\nTrapName = ptSCCPPCSSNRegistrationNPGWSCCPPCSSNFailure,\n";
    
    my $dat_notification_id = 1419;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.3"})) {
        $dat_additional_text .= "\nptnpgwSCCPPCSSNRegistrationSSN = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.4"})) {
        $dat_additional_text .= "\nptnpgwSCCPPCSSNRegistrationStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwSCCPPCSSNRegistrationPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwSCCPPCSSNRegistrationNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotOmsSpaceUsageCritical
sub _1_3_6_1_4_1_1556_17_0_6276
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "HDD space for SP2K Specific OMs is dangerously low.  The slot number indicated in this trap indicates the origin of the alarm. Cause  - SP2K Specific OMs using up too much HDD space Action - Delete some old SP2K Specific OMs  Freq   - Irregular\nTrapName = ptSlotSlotOmsSpaceUsageCritical,\n";
    
    my $dat_notification_id = 1420;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.20"})) {
        $dat_additional_text .= "\nptSlotOMsSpaceUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.20"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3AppIDLinkOutage
sub _1_3_6_1_4_1_1556_17_0_8195
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The MTP3 NA has lost the AppID registration and is in Link Outage.\nTrapName = ptMTP3NAMtp3AppIDLinkOutage,\n";
    
    my $dat_notification_id = 1421;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"})) {
        $dat_additional_text .= "\nptMTPMTP3NALocalPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesDSCNodeRoutingDiscardCleared
sub _1_3_6_1_4_1_1556_17_0_1846
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC has not discarded a message via routing table for 5 minutes.\nTrapName = ptDSCNodesDSCNodeRoutingDiscardCleared,\n";
    
    my $dat_notification_id = 1422;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAVPRoutingTableDSCAvpDiscardConfigured
sub _1_3_6_1_4_1_1556_17_0_1841
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC routing table contains at least one table entry that is configured to discard messages.  This is highly discouraged.\nTrapName = ptAVPRoutingTableDSCAvpDiscardConfigured,\n";
    
    my $dat_notification_id = 1423;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1814.1.1.1"})) {
        $dat_additional_text .= "\nptDSCAVPRoutingTableTableName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1814.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkAlarmsDisabled
sub _1_3_6_1_4_1_1556_17_0_8142
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Annex A Link alarms are disabled.\nTrapName = ptAnnexALinkAnnexaL3LinkAlarmsDisabled,\n";
    
    my $dat_notification_id = 1424;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAMultiAssociationASPM3UAMultiAssocASPUp
sub _1_3_6_1_4_1_1556_17_0_7305
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a Multipath ASP is now up. Cause: An ASP has connected and sent an ASPUP notification. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm ptTrapSeverity: 5 cleared ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType: 1 fmic\nTrapName = ptM3UAMultiAssociationASPM3UAMultiAssocASPUp,\n";
    
    my $dat_notification_id = 1425;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAMultiAssociationASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAMultiAssociationASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptProcessEventSlotMgrConnected
sub _1_3_6_1_4_1_1556_17_0_8305
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the peer slot manager is connected.\nTrapName = ptProcessEventSlotMgrConnected,\n";
    
    my $dat_notification_id = 1426;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"})) {
        $dat_additional_text .= "\nptpeereventProcessEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"})) {
        $dat_additional_text .= "\nptpeereventProcessEventSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericL3LinkOscillationFilterClear
sub _1_3_6_1_4_1_1556_17_0_8431
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that Link Oscillation Filter Timer T32 has expired\nTrapName = ptGenericLinkGenericL3LinkOscillationFilterClear,\n";
    
    my $dat_notification_id = 1427;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTDBSummaryInitialDatabaseLoadFailed
sub _1_3_6_1_4_1_1556_17_0_4405
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that GTT was not successful in loading its Live/GTT database at startup.\nTrapName = ptGTTDBSummaryInitialDatabaseLoadFailed,\n";
    
    my $dat_notification_id = 1428;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.1"})) {
        $dat_additional_text .= "\nptGTTGTTDBSummaryDatabaseType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.10"})) {
        $dat_additional_text .= "\nptGTTGTTDBSummaryGTCallingSearches = " . $entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.6"})) {
        $dat_additional_text .= "\nptGTTGTTDBSummaryGTModifications = " . $entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.5"})) {
        $dat_additional_text .= "\nptGTTGTTDBSummaryGTCalledSearches = " . $entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.8"})) {
        $dat_additional_text .= "\nptGTTGTTDBSummaryCommandLists = " . $entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.11"})) {
        $dat_additional_text .= "\nptGTTGTTDBSummaryGTOPCSearches = " . $entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.11"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.7"})) {
        $dat_additional_text .= "\nptGTTGTTDBSummaryPCLists = " . $entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.7"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkOscillationFilterSet
sub _1_3_6_1_4_1_1556_17_0_8168
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that Link Oscillation Filter Timer T32 has started\nTrapName = ptLSLinkSs7L3LinkOscillationFilterSet,\n";
    
    my $dat_notification_id = 1429;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSNAMIConfigurationSNAMIUnavailable
sub _1_3_6_1_4_1_1556_17_0_1505
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SNAMI is user activated but unavailable.\nTrapName = ptSNAMIConfigurationSNAMIUnavailable,\n";
    
    my $dat_notification_id = 1430;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesDSCDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_1868
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug setting is not set to the recommended value. Cause: A debug setting is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptDSCNodesDSCDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1431;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaMultiAssocMinStreamsClear
sub _1_3_6_1_4_1_1556_17_0_7343
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The M3UA multi association causing the minimum stream alarm has been aborted or removed\nTrapName = ptM3UAASPAssociationM3uaMultiAssocMinStreamsClear,\n";
    
    my $dat_notification_id = 1432;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotMonitorSlotBondingARPMonitorClear
sub _1_3_6_1_4_1_1556_17_0_6267
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Bonding driver link monitoring has established ARP communication with the far end. Cause  - Link monitoring has established communication with the far end. Action - None Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4  equipment alarm - ptTrapSeverity:      5  clear - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptSlotMonitorSlotBondingARPMonitorClear,\n";
    
    my $dat_notification_id = 1433;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"})) {
        $dat_additional_text .= "\nptSlotMonitorHostname = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL2LinkUnaligned
sub _1_3_6_1_4_1_1556_17_0_7161
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has lost alignment. Cause  - After a signaling link failure is detected , signaling link initial alignment will take place. The Alignment procedure  passes through a number of states and when the procedure  enters the state not aligned this trap is sent. Action - If the initial alignment procedure does not work then the  operator will have to intervene in order that the link  alignment succeeds. Freq   - This trap will continue to appear each time the initial  alignment procedure enters the state not aligned. This may happen a number of times as the initial alignment  procedure is repeated until alignment has been completed successfully.  References 1) Q.703 , (07/96) Section 7.3  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL2LinkUnaligned,\n";
    
    my $dat_notification_id = 1434;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.8"})) {
        $dat_additional_text .= "\nptMTPATMLinkL2State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPCEConfigurationPceDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_4307
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Debug attributes are set to their recommended values.\nTrapName = ptPCEConfigurationPceDebugLevelRecommended,\n";
    
    my $dat_notification_id = 1435;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3UAASPAssocEndPtConflict
sub _1_3_6_1_4_1_1556_17_0_7708
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that an M3UA ASP Association has conflicting SCTP endpoints with one or more existing M3UA ASP Association and/or one or more M3UA/SUA SCTP Servers . Cause - Same transport address defined for two or more M3UA ASP Associations, or for both  an M3UA ASP Association and an M3UA/SUA SCTP server. Possible Actions - Ensure that the detected SCTP endpoint conflicts are resolved.  A transport address can be defined for one and only one M3UA ASP Association or M3UA/SUA SCTP Server. Freq - This trap occurs when a transport address is defined for two or more SUA Configured ASPs.\nTrapName = ptM3UAASPAssociationM3UAASPAssocEndPtConflict,\n";
    
    my $dat_notification_id = 1436;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMTP3NAsDiscardMsuFromPeerClear
sub _1_3_6_1_4_1_1556_17_0_7387
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for MSU has been unexpectedly discarded between peers on MTP3 NA Connection.\nTrapName = ptMTP3NAMTP3NAsDiscardMsuFromPeerClear,\n";
    
    my $dat_notification_id = 1437;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"})) {
        $dat_additional_text .= "\nptSGMTP3NANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPortMpmtp2PortFarEndLoopbackSet
sub _1_3_6_1_4_1_1556_17_0_5813
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the far end has been instructed to enter loopback mode for testing. Cause  - A user has instructed loopback activation codes to be sent to place the far end in test mode Action - Send Loop Down or Stop BERT to instruct the far end to return to normal operation Freq   - This trap will appear when the user instructs the far end to enter test mode, such as for BERT. References - ptOriginatingOID:    DYNAMIC ptPort - ptTrapType:          2 communication alarm - ptTrapSeverity:      3 minor - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptPortMpmtp2PortFarEndLoopbackSet,\n";
    
    my $dat_notification_id = 1438;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWPortPortNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptProcessEventTrafficStatusNotReady
sub _1_3_6_1_4_1_1556_17_0_8300
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the peer traffic status is not ready.  Not raised during initialization.\nTrapName = ptProcessEventTrafficStatusNotReady,\n";
    
    my $dat_notification_id = 1439;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"})) {
        $dat_additional_text .= "\nptpeereventProcessEventSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"})) {
        $dat_additional_text .= "\nptpeereventProcessEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkAlarmsEnabled
sub _1_3_6_1_4_1_1556_17_0_8147
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "M2PA Link alarms are enabled.\nTrapName = ptM2PALinkM2paL3LinkAlarmsEnabled,\n";
    
    my $dat_notification_id = 1440;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMTP3NAsMsuDiscardClear
sub _1_3_6_1_4_1_1556_17_0_7371
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for MSU has been unexpectedly discarded on MTP3 NA Connection.\nTrapName = ptMTP3NAMTP3NAsMsuDiscardClear,\n";
    
    my $dat_notification_id = 1441;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"})) {
        $dat_additional_text .= "\nptSGMTP3NANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGWSTConfigurationGR310ExcessiveMesssaging
sub _1_3_6_1_4_1_1556_17_0_1005
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Autonomous GR-310 messages discared by GWST destined to the active GR-310 server.\nTrapName = ptGWSTConfigurationGR310ExcessiveMesssaging,\n";
    
    my $dat_notification_id = 1442;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkUnavailable
sub _1_3_6_1_4_1_1556_17_0_8185
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is unavailable for user traffic. Cleared by m2paL3LinkAvailable. Cause  - The link is unavailable to user traffic for some reason (e.g. out of service, blocked, inhibited). Action - Depends on link state. Freq   - Operator dependant. References 1) GR310CORE Issue 3 Section 8.1 2) GR246CORE Issue 10 3) GR82CORE  Issue 10 4) Q.704 ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        3 minor ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptM2PALinkM2paL3LinkUnavailable,\n";
    
    my $dat_notification_id = 1443;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UASCTPServerM3UASCTPServerAddrListMismatch
sub _1_3_6_1_4_1_1556_17_0_7362
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that M3UA SCTP Server is not listening on all configured addresses. Cause - The M3UA SCTP Server is configured to listen on an address but binding to that address/port failed. Possible Actions - Determine if another application is using the  desired address/port, which is preventing the server from binding to the address.  This can be done using IP Networking > IP Utilities > Open Sockets. Determine if the IP addresses are actually valid for the slot that the server is listening on.  Use Network Interaces > View Network Interfaces for the corresponding slot to see if the address is configured for one of the interfaces. If you are using hostnames, you will first need to check which addresses the hostname resolves to using IP Networking > Hostname Resolution (if using DNS you will need to check the DNS Server configuration). If using hostnames, it is possible that each address was not resolvable at startup.  If there are no hostname resolution alarms present for the M3UA SCTP Server, it is possible that deactivating and reactivating the server will correct the issue.  Freq - This trap occurs only when the addresses the server is listening on do not match the addresses configured.\nTrapName = ptM3UASCTPServerM3UASCTPServerAddrListMismatch,\n";
    
    my $dat_notification_id = 1444;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAdjacentDiameterNodeADNDown
sub _1_3_6_1_4_1_1556_17_0_1805
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The ADN is down. Depending on the configuration, an outgoing connection has not been  established or the ADN has not attempted or established connectivity.\nTrapName = ptAdjacentDiameterNodeADNDown,\n";
    
    my $dat_notification_id = 1445;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1.1.2"})) {
        $dat_additional_text .= "\nptDSCAdjacentDiameterNodeAdjacentDiameterID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUASCTPServerSUASCTPServerResolvedHost2
sub _1_3_6_1_4_1_1556_17_0_7361
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An SUA SCTP Server Hostname 2 is resolved\nTrapName = ptSUASCTPServerSUASCTPServerResolvedHost2,\n";
    
    my $dat_notification_id = 1446;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexClxPartyLoadMonitoringStarted
sub _1_3_6_1_4_1_1556_17_0_2039
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications manual called/calling party load monitoring started.\nTrapName = ptSS7DBAppsConfigurationSigFlexClxPartyLoadMonitoringStarted,\n";
    
    my $dat_notification_id = 1447;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlex5129CommandTimeout
sub _1_3_6_1_4_1_1556_17_0_2034
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications 5129 command timeout failure.\nTrapName = ptSS7DBAppsConfigurationSigFlex5129CommandTimeout,\n";
    
    my $dat_notification_id = 1448;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANodeL4NewAppConnection
sub _1_3_6_1_4_1_1556_17_0_8162
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Some L4 application has connected.\nTrapName = ptMTP3NANodeL4NewAppConnection,\n";
    
    my $dat_notification_id = 1449;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"})) {
        $dat_additional_text .= "\nptMTPMTP3NALocalPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPSXsNPGWPSXQueueReady
sub _1_3_6_1_4_1_1556_17_0_1626
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW PSX queue is no longer full for past 5 seconds.\nTrapName = ptPSXsNPGWPSXQueueReady,\n";
    
    my $dat_notification_id = 1450;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUASCTPServerSUASCTPServerUnresolvedHost1
sub _1_3_6_1_4_1_1556_17_0_7358
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that SUA SCTP Server IP Address 1 hostname is not resolvable. Cause - The SG is unable to resolve the hostname. Possible Actions - If the DSC has been set up to use a DNS server,  ensure the DNS server is reachable and confirm that the hostname has been configured. If the hostname is intended to resolve locally, ensure the proper hostname entry  has been added using IP Networking > Hostname Resolution. Freq - This trap occurs when the configured hostname becomes unresolvable.\nTrapName = ptSUASCTPServerSUASCTPServerUnresolvedHost1,\n";
    
    my $dat_notification_id = 1451;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSysMgrDiskUsageOver90Percent
sub _1_3_6_1_4_1_1556_17_0_2007
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Disk usage is over 90% full on SS7 DB Applications CPU\nTrapName = ptSS7DBAppsConfigurationSysMgrDiskUsageOver90Percent,\n";
    
    my $dat_notification_id = 1452;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptNPGWConfigurationNPGWMTP3Up
sub _1_3_6_1_4_1_1556_17_0_1618
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one NPGW MTP3 NA is connected.\nTrapName = ptNPGWConfigurationNPGWMTP3Up,\n";
    
    my $dat_notification_id = 1453;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1601.1.1.3"})) {
        $dat_additional_text .= "\nptnpgwNPGWConfigurationMTP3TrafficStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1601.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkLocalUninhibited
sub _1_3_6_1_4_1_1556_17_0_7176
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been uninhibited at the  local node by operator. References 1) Table 2 Q.752, End of local inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 43 Resource at or near capacity ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkLocalUninhibited,\n";
    
    my $dat_notification_id = 1454;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTGttProcessStartup
sub _1_3_6_1_4_1_1556_17_0_4400
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates the GTT process is starting up. Freq: This trap will appear every time GTT starts up. References: ptOriginatingOID    : ptGTT ptTrapType          : 11 quality of service alarm ptTrapSeverity      : 5 cleared ptTrapProbableCause : 6 Communications subsystem error ptTrapClearType     : 2 oic\nTrapName = ptGTTGttProcessStartup,\n";
    
    my $dat_notification_id = 1455;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkAlarmsDisabled
sub _1_3_6_1_4_1_1556_17_0_8140
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "ATM Link alarms are disabled.\nTrapName = ptATMLinkAtmL3LinkAlarmsDisabled,\n";
    
    my $dat_notification_id = 1456;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIWFDiameterIWFDiameterDown
sub _1_3_6_1_4_1_1556_17_0_1901
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The IWF traffic is deactivated or all Diameter Connections are not connected. The DSC associated Transport Server for the IWF port must be active and UP.\nTrapName = ptIWFDiameterIWFDiameterDown,\n";
    
    my $dat_notification_id = 1457;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.1"})) {
        $dat_additional_text .= "\nptiwfIWFDiameterIWFDiameterID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.7"})) {
        $dat_additional_text .= "\nptiwfIWFDiameterConnectivityStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.5"})) {
        $dat_additional_text .= "\nptiwfIWFDiameterDSCIWFUAPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptModificationRecordModRecvalid
sub _1_3_6_1_4_1_1556_17_0_1834
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Modification Record entry has been changed to be valid or has been deleted.\nTrapName = ptModificationRecordModRecvalid,\n";
    
    my $dat_notification_id = 1458;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPCEPcePeerUp
sub _1_3_6_1_4_1_1556_17_0_4303
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates a PCE peer is reachable.   Sent when a PCE peer communication is established via LDL.\nTrapName = ptPCEPcePeerUp,\n";
    
    my $dat_notification_id = 1459;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANodeMTPRestartInProgress
sub _1_3_6_1_4_1_1556_17_0_8191
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Local MTP Restart procedure is ongoing. This is a stateless trap (no alarm).\nTrapName = ptMTP3NANodeMTPRestartInProgress,\n";
    
    my $dat_notification_id = 1460;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"})) {
        $dat_additional_text .= "\nptMTPMTP3NALocalPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPAppIDRegistrationINAPGWSCCPAppIDSuccess
sub _1_3_6_1_4_1_1556_17_0_1310
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP AppID registration was successful on all the defined SCCP connections.\nTrapName = ptSCCPAppIDRegistrationINAPGWSCCPAppIDSuccess,\n";
    
    my $dat_notification_id = 1461;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1305.1307.1.1.2"})) {
        $dat_additional_text .= "\nptinapgwSCCPAppIDRegistrationApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1305.1307.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1305.1307.1.1.1"})) {
        $dat_additional_text .= "\nptinapgwSCCPAppIDRegistrationNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1305.1307.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1305.1307.1.1.3"})) {
        $dat_additional_text .= "\nptinapgwSCCPAppIDRegistrationStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1305.1307.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptL4ConverterL4cvtrDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_4107
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All debug attributes are set to their recommended values.\nTrapName = ptL4ConverterL4cvtrDebugLevelRecommended,\n";
    
    my $dat_notification_id = 1462;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionADNCLocalEndPointConflictCleared
sub _1_3_6_1_4_1_1556_17_0_1829
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC ADN Connection SCTP local end point conflict has been resolved. Note that deactivating the ADN Connection clears the conflict.\nTrapName = ptADNConnectionADNCLocalEndPointConflictCleared,\n";
    
    my $dat_notification_id = 1463;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.15"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.15"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkAvailable
sub _1_3_6_1_4_1_1556_17_0_8186
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is available for user traffic. Clears m2paL3LinkUnavailable. References 1) GR310CORE Issue 3 Section 8.1 2) GR246CORE Issue 10 3) GR82CORE  Issue 10 4) Q.704 ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptM2PALinkM2paL3LinkAvailable,\n";
    
    my $dat_notification_id = 1464;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRADIUSServerRadiusServerClear
sub _1_3_6_1_4_1_1556_17_0_8501
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A RADIUS server which previously failed to respond to a request within its configured timeout has now done so.\nTrapName = ptRADIUSServerRadiusServerClear,\n";
    
    my $dat_notification_id = 1465;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1024.1025.1.1.4"})) {
        $dat_additional_text .= "\nptuppRADIUSServerTimeout = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1024.1025.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1024.1025.1.1.2"})) {
        $dat_additional_text .= "\nptuppRADIUSServerAddress = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1024.1025.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkRemoteBlocked
sub _1_3_6_1_4_1_1556_17_0_8113
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA signaling link has been blocked at a remote node. Cause  - Signaling link is blocked at the remote node of the link by operator intervention or due to processor outage. Action - The link will be unblocked when the remote node of the  link become unblocked.  Freq   - Operator dependant. References 1) Table 2 Q.752 Start of Remote Processor Outage 2) Q.704 Section 3.3.5       ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        3 minor ptTrapProbableCause:   42 Remote node transmission error   ptTrapClearType:       1 fmic\nTrapName = ptM2PALinkM2paL3LinkRemoteBlocked,\n";
    
    my $dat_notification_id = 1466;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRADIUSServerRadiusServerUnavailable
sub _1_3_6_1_4_1_1556_17_0_8500
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "One of the configured RADIUS servers failed to respond to a request within its configured timeout.\nTrapName = ptRADIUSServerRadiusServerUnavailable,\n";
    
    my $dat_notification_id = 1467;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1024.1025.1.1.4"})) {
        $dat_additional_text .= "\nptuppRADIUSServerTimeout = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1024.1025.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1024.1025.1.1.2"})) {
        $dat_additional_text .= "\nptuppRADIUSServerAddress = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1024.1025.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptTmpDiskPartitionThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_5511
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the /tmp disk partition usage has returned below its alarm threshold\nTrapName = ptTmpDiskPartitionThresholdCleared,\n";
    
    my $dat_notification_id = 1468;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCommandCodeRoutingTableDSCCmdCodeDiscardConfiguredCleared
sub _1_3_6_1_4_1_1556_17_0_1838
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC routing table is no longer configured to discard messages.\nTrapName = ptCommandCodeRoutingTableDSCCmdCodeDiscardConfiguredCleared,\n";
    
    my $dat_notification_id = 1469;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1836.1.1.1"})) {
        $dat_additional_text .= "\nptDSCCommandCodeRoutingTableTableName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1836.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMSAMsaThreshold2Crossed
sub _1_3_6_1_4_1_1556_17_0_8201
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the MSA threshold 2 is crossed.\nTrapName = ptMSAMsaThreshold2Crossed,\n";
    
    my $dat_notification_id = 1470;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.961.962.1.1.1"})) {
        $dat_additional_text .= "\nptmsaMSAName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.961.962.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionADNConnectionFirewallCleared
sub _1_3_6_1_4_1_1556_17_0_1825
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An IP address resolution can be made for the Remote Host.  Connections from that address will pass.\nTrapName = ptADNConnectionADNConnectionFirewallCleared,\n";
    
    my $dat_notification_id = 1471;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.4"})) {
        $dat_additional_text .= "\nptDSCADNConnectionRemoteHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANodeSNMPeerHostShuttingDown
sub _1_3_6_1_4_1_1556_17_0_8159
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SNM Peer Host available. This is a stateless trap (no alarm).\nTrapName = ptMTP3NANodeSNMPeerHostShuttingDown,\n";
    
    my $dat_notification_id = 1472;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"})) {
        $dat_additional_text .= "\nptMTPMTP3NALocalPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptHSLATMChannelMpmtp2SAALChanDeactivated
sub _1_3_6_1_4_1_1556_17_0_5806
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An ATM Link has been manually deactivated.  This is done either directly on the link or at the link manager level. Cause  - ATM link has been deactivated. Action - Re-activate the link Freq   - By user interaction References - ptOriginatingOID:    DYNAMIC ptATMLink - ptTrapType:          11 quality of service - ptTrapSeverity:      3 major - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptHSLATMChannelMpmtp2SAALChanDeactivated,\n";
    
    my $dat_notification_id = 1473;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1084.1102.1.1.3"})) {
        $dat_additional_text .= "\nptIOHWHSLATMChannelPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1084.1102.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1084.1102.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWHSLATMChannelChannelNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1084.1102.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPCRegistrationPcRegistrationError
sub _1_3_6_1_4_1_1556_17_0_4411
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the PC registration is not successful.\nTrapName = ptPCRegistrationPcRegistrationError,\n";
    
    my $dat_notification_id = 1474;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.653.654.655.1.1.1"})) {
        $dat_additional_text .= "\nptGTTPCRegistrationPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.653.654.655.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptProcessEventIMFMgrNotConnected
sub _1_3_6_1_4_1_1556_17_0_8308
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the peer IMF manager is not connected. Not raised during initialization.\nTrapName = ptProcessEventIMFMgrNotConnected,\n";
    
    my $dat_notification_id = 1475;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"})) {
        $dat_additional_text .= "\nptpeereventProcessEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"})) {
        $dat_additional_text .= "\nptpeereventProcessEventSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericL3LinkUsageHighClear
sub _1_3_6_1_4_1_1556_17_0_8438
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the average traffic over this link no longer exceeds predefined threshold. There is no longer potential for traffic loss due to extensive traffic. References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 51 Threshold crossed ptTrapClearType:     1 fmic\nTrapName = ptGenericLinkGenericL3LinkUsageHighClear,\n";
    
    my $dat_notification_id = 1476;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRouteRouteInaccessibleCRDTRecovery
sub _1_3_6_1_4_1_1556_17_0_7160
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap clears routeInaccessibleCRDT. This trap is issued for a route that was previously unavailable because of a failed ANSI Circular Route Detection Test (CRDT) to indicate that traffic may be resumed on this route. Cause  - The route previously failed an ANSI Circular Route Detection Test (CRDT).  That condition has been cleared. Action - None. Freq   - This trap occurs when a route is cleared of a CRDT condition. References  1) GR-246-CORE Issue 10 T1.111.7 Section 2.4 2) GR-82-CORE Issue 10 2) GR-310-CORE Issue 3 Section 8.1 ptOriginatingOID:    DYNAMIC ptRoute  ptTrapType:          2 communicationAlarm  ptTrapSeverity:      5 cleared ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptRouteRouteInaccessibleCRDTRecovery,\n";
    
    my $dat_notification_id = 1477;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRouteCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.6"})) {
        $dat_additional_text .= "\nptMTPRouteLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.5"})) {
        $dat_additional_text .= "\nptMTPRouteState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.2"})) {
        $dat_additional_text .= "\nptMTPRouteAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPortClockingMpmtp2ReferenceClockIsNotPrimary
sub _1_3_6_1_4_1_1556_17_0_5808
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the reference clock source is no longer taken from the primary setting Cause  - The reference clock source has been lost for a number of reasons - Remote equipment failure. - Local Port failure. - Loss of Sync or Framing on the port Action - Depends on the cause Freq   - This trap will appear when the clocking reference has been lost on the PRIMARY reference References - ptOriginatingOID:    DYNAMIC ptTDMCard - ptTrapType:          4 equipment alarm - ptTrapSeverity:      3 minor - ptTrapProbableCause: 6 Communications subsystem error - ptTrapClearType:     1 fmic\nTrapName = ptPortClockingMpmtp2ReferenceClockIsNotPrimary,\n";
    
    my $dat_notification_id = 1478;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1088.1.1.44"})) {
        $dat_additional_text .= "\nptIOHWPortClockingCurrentClockSource = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1088.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionDSCAdncSevereCongestionDiscardCleared
sub _1_3_6_1_4_1_1556_17_0_1852
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC ADN Connection has not discarded any answer message due to severe congestion for 5 minutes\nTrapName = ptADNConnectionDSCAdncSevereCongestionDiscardCleared,\n";
    
    my $dat_notification_id = 1479;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.15"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.15"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotIsmEtcPartitionThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_6269
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "ISM /etc partition usage has returned to acceptable levels. Cause  - ISM /etc partition usage below threshold. Action - None. Freq   - Irregular.\nTrapName = ptSlotSlotIsmEtcPartitionThresholdCleared,\n";
    
    my $dat_notification_id = 1480;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDiscreteSensorSysComponentInserted
sub _1_3_6_1_4_1_1556_17_0_6329
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "System Component inserted/activated. Cause  - System component inserted Action - None Freq   - Infrequent References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptDiscreteSensorSysComponentInserted,\n";
    
    my $dat_notification_id = 1481;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkRemoteBlocked
sub _1_3_6_1_4_1_1556_17_0_7143
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been blocked at a remote node. Cause  - Signaling link is blocked at the remote node of the link by operator intervention or due to processor outage. Action - The link will be unblocked when the remote node of the  link becomes unblocked.  Freq   - Operator dependant. References 1) Table 2 Q.752 Start of Remote Processor Outage 2) Q.704 Section 3.3.5       ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        3 minor ptTrapProbableCause:   42 Remote node transmission error   ptTrapClearType:       1 fmic\nTrapName = ptATMLinkAtmL3LinkRemoteBlocked,\n";
    
    my $dat_notification_id = 1482;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotMonitorSlotLicenseServerConnectivityLoss
sub _1_3_6_1_4_1_1556_17_0_3160
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "System lost connection to the license server.\nTrapName = ptSlotMonitorSlotLicenseServerConnectivityLoss,\n";
    
    my $dat_notification_id = 1483;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"})) {
        $dat_additional_text .= "\nptSlotMonitorHostname = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkRemoteUnblocked
sub _1_3_6_1_4_1_1556_17_0_7184
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been unblocked at a remote node. Causes ,Corrective actions and Frequency   1) ptSpecificTrapCause = linkDeactivated  Cause  -  Unknown Cause 2) ptSpecificTrapCause = unknownCause References 1) Table 2 Q.752 Stop of Remote Processor Outage 2) Q.704 Section 3.3.5       ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 42 Remote node transmission error   ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkRemoteUnblocked,\n";
    
    my $dat_notification_id = 1484;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UASCTPServerM3UASCTPServerUnresolvedHost2
sub _1_3_6_1_4_1_1556_17_0_7354
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that M3UA SCTP Server IP Address 2 hostname is not resolvable. Cause - The SG is unable to resolve the hostname. Possible Actions - If the DSC has been set up to use a DNS server,  ensure the DNS server is reachable and confirm that the hostname has been configured. If the hostname is intended to resolve locally, ensure the proper hostname entry  has been added using IP Networking > Hostname Resolution. Freq - This trap occurs when the configured hostname becomes unresolvable.\nTrapName = ptM3UASCTPServerM3UASCTPServerUnresolvedHost2,\n";
    
    my $dat_notification_id = 1485;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRateLimiterDSCRlLocalOverloadDiscardCleared
sub _1_3_6_1_4_1_1556_17_0_1865
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC RateLimiter has not discarded messages due to configured local overload handling for 5 minutes\nTrapName = ptRateLimiterDSCRlLocalOverloadDiscardCleared,\n";
    
    my $dat_notification_id = 1486;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.2"})) {
        $dat_additional_text .= "\nptDSCRateLimiterCapacityParameterSet = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.1"})) {
        $dat_additional_text .= "\nptDSCRateLimiterName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptL4ConnectionL4ConnCongestion
sub _1_3_6_1_4_1_1556_17_0_9964
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The L4 connection is congested.\nTrapName = ptL4ConnectionL4ConnCongestion,\n";
    
    my $dat_notification_id = 1487;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.66.59.1.1.1"})) {
        $dat_additional_text .= "\nptMTPL4ConnectionContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.66.59.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAManagerSccpDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_4209
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All debug attributes are set to their recommended values.\nTrapName = ptSCCPNAManagerSccpDebugLevelRecommended,\n";
    
    my $dat_notification_id = 1488;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotMonitorSlotNTPServerDown
sub _1_3_6_1_4_1_1556_17_0_3152
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Some of NTP servers configured are invalid or are down. Cause  - Some NTP servers are not working properly Action - Identify Some NTP servers are not working properly Freq   - Irregular\nTrapName = ptSlotMonitorSlotNTPServerDown,\n";
    
    my $dat_notification_id = 1489;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"})) {
        $dat_additional_text .= "\nptSlotMonitorHostname = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPSXHostNPGWPSXHostInactive
sub _1_3_6_1_4_1_1556_17_0_1633
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW PSX Host is deactivated.\nTrapName = ptPSXHostNPGWPSXHostInactive,\n";
    
    my $dat_notification_id = 1490;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwPSXHostPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.6"})) {
        $dat_additional_text .= "\nptnpgwPSXHostUserActivated = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwPSXHostHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAASPSuaUserConnEstablished
sub _1_3_6_1_4_1_1556_17_0_7225
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A user connection established notification is sent when the connection between an ASP and Dinamo is established.\nTrapName = ptSUAASPSuaUserConnEstablished,\n";
    
    my $dat_notification_id = 1491;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"})) {
        $dat_additional_text .= "\nptSGSUAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAMultiAssociationASPM3UAMultiAssocDiscardSet
sub _1_3_6_1_4_1_1556_17_0_7376
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An M3UA Multi ASP message has been unexpectedly discarded in the last 5-minute.\nTrapName = ptM3UAMultiAssociationASPM3UAMultiAssocDiscardSet,\n";
    
    my $dat_notification_id = 1492;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAMultiAssociationASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAMultiAssociationASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUASCTPServersSuaLicCritical
sub _1_3_6_1_4_1_1556_17_0_7238
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Critical SUA License Event has occurred\nTrapName = ptSUASCTPServersSuaLicCritical,\n";
    
    my $dat_notification_id = 1493;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDiscreteSensorSpiFaultDeassert
sub _1_3_6_1_4_1_1556_17_0_6331
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SPIbus test Passed Cause  - SPIbus Hardware is operational on slot Action - None Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptDiscreteSensorSpiFaultDeassert,\n";
    
    my $dat_notification_id = 1494;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCpuLoadExceeded
sub _1_3_6_1_4_1_1556_17_0_5501
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that CPU load has reached its alarm threshold\nTrapName = ptCpuLoadExceeded,\n";
    
    my $dat_notification_id = 1495;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.2021.10.1.3"})) {
        $dat_additional_text .= "\nlaLoad = " . $entrada->{"1.3.6.1.4.1.2021.10.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkActivated
sub _1_3_6_1_4_1_1556_17_0_7134
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been activated either by the operator or as a result of a successful restoration  which was initiated upon detection of an inactive link. This trap could also be generated at restart without a previous corresponding trap 201. References 1)  Q.752, SL Restoration 2)  Q.704, (07/96) Section 12.2 ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 29 Loss of signal  ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL3LinkActivated,\n";
    
    my $dat_notification_id = 1496;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANoActiveRSClear
sub _1_3_6_1_4_1_1556_17_0_8198
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for MSU destined to undefined or inactive routeset has been discarded\nTrapName = ptMTP3NANoActiveRSClear,\n";
    
    my $dat_notification_id = 1497;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDiscreteSensorPowerFaultAssert
sub _1_3_6_1_4_1_1556_17_0_6320
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A discrete sensor power fault alarm was asserted Cause  - A discrete sensor detects a power fault condition Action - Verify sensor Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptDiscreteSensorPowerFaultAssert,\n";
    
    my $dat_notification_id = 1498;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptTargetTargetLoadBalanced
sub _1_3_6_1_4_1_1556_17_0_5006
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The load is either balanced or imbalance was ignored.\nTrapName = ptTargetTargetLoadBalanced,\n";
    
    my $dat_notification_id = 1499;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.5001.5002.5003.1.1.1"})) {
        $dat_additional_text .= "\nptLBTargetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.5001.5002.5003.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASccpNADebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_4211
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All debug attributes are set to their recommended values.\nTrapName = ptSCCPNASccpNADebugLevelRecommended,\n";
    
    my $dat_notification_id = 1500;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAManagerMtp3ConnectedToLicenceD
sub _1_3_6_1_4_1_1556_17_0_8166
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "NA connected succefully to License Daemon\nTrapName = ptMTP3NAManagerMtp3ConnectedToLicenceD,\n";
    
    my $dat_notification_id = 1501;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSFGUASFGUAExchangeDown
sub _1_3_6_1_4_1_1556_17_0_7400
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the SFG UA exchange is down.   Cause: SS7 DB routing application is not listening. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm  ptTrapSeverity: 1 critical ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType: 1 fmic\nTrapName = ptSFGUASFGUAExchangeDown,\n";
    
    my $dat_notification_id = 1502;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.260.1.1.1"})) {
        $dat_additional_text .= "\nptSGSFGUAExchangeName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.260.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.260.1.1.2"})) {
        $dat_additional_text .= "\nptSGSFGUAExchangeStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.260.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAConfiguredASPSUAConfiguredASPDown
sub _1_3_6_1_4_1_1556_17_0_7312
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a Configured ASP is down.   Cause: No ASP has connected to this ID and sent an ASPUP notification. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm  ptTrapSeverity: 3 minor ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType: 1 fmic\nTrapName = ptSUAConfiguredASPSUAConfiguredASPDown,\n";
    
    my $dat_notification_id = 1503;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptThresholdSensorLowerCriticalDeassert
sub _1_3_6_1_4_1_1556_17_0_6351
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A threshold sensor lower critical alarm was deasserted Cause  - A threshold sensor no longer detects a lower critical condition Action - None Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptThresholdSensorLowerCriticalDeassert,\n";
    
    my $dat_notification_id = 1504;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UASCTPServerM3UASCTPServerResolvedHost2
sub _1_3_6_1_4_1_1556_17_0_7355
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "M3UA SCTP Server Hostname 2 is resolved\nTrapName = ptM3UASCTPServerM3UASCTPServerResolvedHost2,\n";
    
    my $dat_notification_id = 1505;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCpuUsageMajorThresholdCrossed
sub _1_3_6_1_4_1_1556_17_0_5519
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that CPU Usage has crossed its major alarm threshold on a CPU Core\nTrapName = ptCpuUsageMajorThresholdCrossed,\n";
    
    my $dat_notification_id = 1506;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1021"})) {
        $dat_additional_text .= "\nptTrapCpuUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.1021"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1020"})) {
        $dat_additional_text .= "\nptTrapCpuCore = " . $entrada->{"1.3.6.1.4.1.1556.17.1020"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptProcessEventStatsMgrConnected
sub _1_3_6_1_4_1_1556_17_0_8307
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the peer stats manager is connected.\nTrapName = ptProcessEventStatsMgrConnected,\n";
    
    my $dat_notification_id = 1507;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"})) {
        $dat_additional_text .= "\nptpeereventProcessEventSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"})) {
        $dat_additional_text .= "\nptpeereventProcessEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCpuUsageCriticalThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_5522
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the CPU Usage has returned below its critical alarm threshold on a CPU Core\nTrapName = ptCpuUsageCriticalThresholdCleared,\n";
    
    my $dat_notification_id = 1508;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1021"})) {
        $dat_additional_text .= "\nptTrapCpuUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.1021"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1020"})) {
        $dat_additional_text .= "\nptTrapCpuCore = " . $entrada->{"1.3.6.1.4.1.1556.17.1020"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationLicenseClrError
sub _1_3_6_1_4_1_1556_17_0_2004
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A critical SS7 DB Applications license error has been cleared\nTrapName = ptSS7DBAppsConfigurationLicenseClrError,\n";
    
    my $dat_notification_id = 1509;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkLocalBlocked
sub _1_3_6_1_4_1_1556_17_0_7115
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been blocked at the local node by  the operator. Cause  - Operator blocks a link. Action - Operator can unblock the link.  Freq   - Operator dependant. References 1) Q.704 Section 3.2       ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 56 Underlying resource unavailable ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L3LinkLocalBlocked,\n";
    
    my $dat_notification_id = 1510;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGWSTGwstPeerDown
sub _1_3_6_1_4_1_1556_17_0_4004
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates a GWST peer is no longer reachable. Sent when a GWST peer communication is lost via LDL. Peer connectivity interruptions include: - GWST peer is terminated - IP connectivity heartbeat/keep alive fails - IP connectivity is lost between GWST processes.\nTrapName = ptGWSTGwstPeerDown,\n";
    
    my $dat_notification_id = 1511;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDiscreteSensorSpiFaultAssert
sub _1_3_6_1_4_1_1556_17_0_6330
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SPIbus test Failed Cause  - SPIbus Hardware fault detected on slot  Action - Verify sensor Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptDiscreteSensorSpiFaultAssert,\n";
    
    my $dat_notification_id = 1512;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRegisteredAppIDAppIdLongMsuDiscard
sub _1_3_6_1_4_1_1556_17_0_8167
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a long MSU message has been received and was discarded in an attempt to route on a App ID that does not support long MSUs.\nTrapName = ptRegisteredAppIDAppIdLongMsuDiscard,\n";
    
    my $dat_notification_id = 1513;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.66.59.74.1.1.1"})) {
        $dat_additional_text .= "\nptMTPRegisteredAppIDName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.66.59.74.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAConnectionNPGWMTP3NAConnectionDown
sub _1_3_6_1_4_1_1556_17_0_1613
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW NA traffic is deactivated or the MTP3 NA connection is not connected.\nTrapName = ptMTP3NAConnectionNPGWMTP3NAConnectionDown,\n";
    
    my $dat_notification_id = 1514;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1604.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwMTP3NAConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1604.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1604.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwMTP3NAConnectionStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1604.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPAppIDRegistrationNPGWSCCPAppIDSuccess
sub _1_3_6_1_4_1_1556_17_0_1610
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP AppID registration was successful on all the defined SCCP connections.\nTrapName = ptSCCPAppIDRegistrationNPGWSCCPAppIDSuccess,\n";
    
    my $dat_notification_id = 1515;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1610.1612.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwSCCPAppIDRegistrationNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1610.1612.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1610.1612.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwSCCPAppIDRegistrationApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1610.1612.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1610.1612.1.1.3"})) {
        $dat_additional_text .= "\nptnpgwSCCPAppIDRegistrationStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1610.1612.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRoutesetRouteSetAlarmsDisabled
sub _1_3_6_1_4_1_1556_17_0_8176
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Routeset alarms are disabled.\nTrapName = ptRoutesetRouteSetAlarmsDisabled,\n";
    
    my $dat_notification_id = 1516;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRoutesetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"})) {
        $dat_additional_text .= "\nptMTPRoutesetDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"})) {
        $dat_additional_text .= "\nptMTPRoutesetDestinationState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"})) {
        $dat_additional_text .= "\nptMTPRoutesetContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptConnectionLocalHostResFail
sub _1_3_6_1_4_1_1556_17_0_5001
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "No IP address resolutions can be made for the Local Host.  No connection can be successful. Either change Local Host or add a resolution for that value.\nTrapName = ptConnectionLocalHostResFail,\n";
    
    my $dat_notification_id = 1517;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.5001.5005.5006.1.1.1"})) {
        $dat_additional_text .= "\nptLBConnectionName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.5001.5005.5006.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCICUATCPServerCicLicCritical
sub _1_3_6_1_4_1_1556_17_0_7250
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Critical CIC License Event has occurred\nTrapName = ptCICUATCPServerCicLicCritical,\n";
    
    my $dat_notification_id = 1518;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCpuCertificateExpired
sub _1_3_6_1_4_1_1556_17_0_3164
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Certificate in this slot has expired.\nTrapName = ptSlotSlotCpuCertificateExpired,\n";
    
    my $dat_notification_id = 1519;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"})) {
        $dat_additional_text .= "\nptSlotPrimaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"})) {
        $dat_additional_text .= "\nptSlotSecondaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAINAPGWSCCPNAUp
sub _1_3_6_1_4_1_1556_17_0_1304
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Atleast one INAPGW SCCP NA connection is connected.\nTrapName = ptSCCPNAINAPGWSCCPNAUp,\n";
    
    my $dat_notification_id = 1520;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1.1.1"})) {
        $dat_additional_text .= "\nptinapgwSCCPNANA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1.1.2"})) {
        $dat_additional_text .= "\nptinapgwSCCPNAStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSFGUASCCPAppServerSFGUADataDiscardClear
sub _1_3_6_1_4_1_1556_17_0_7403
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 18.1.0 This trap indicates that condition which caused the   discarding of data messages at an SCCP SFG UA Application server has been resolved or that no messages have been received in a  5 minute period. Action:  None Freq - this trap occurs after a provisioning change has occurred to address data messages being routed to the unsupported SFG SCCP UA application server. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm  ptTrapSeverity: 3 minor  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType: 1 fmic\nTrapName = ptSFGUASCCPAppServerSFGUADataDiscardClear,\n";
    
    my $dat_notification_id = 1521;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.260.261.263.1.1.1"})) {
        $dat_additional_text .= "\nptSGSFGUASCCPAppServerRoutingContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.260.261.263.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRoutesetRoutesetC20ProvError
sub _1_3_6_1_4_1_1556_17_0_8193
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that there is a routeset provisioning on the C20 Core.\nTrapName = ptRoutesetRoutesetC20ProvError,\n";
    
    my $dat_notification_id = 1522;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"})) {
        $dat_additional_text .= "\nptMTPRoutesetDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.19"})) {
        $dat_additional_text .= "\nptMTPRoutesetRoutesetID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.19"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"})) {
        $dat_additional_text .= "\nptMTPRoutesetDestinationState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRoutesetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"})) {
        $dat_additional_text .= "\nptMTPRoutesetContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkUsageHighSet
sub _1_3_6_1_4_1_1556_17_0_8130
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the average traffic over this link exceeds predefined threshold. There is potential for traffic loss if this condition persists. References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 51 Threshold crossed ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paL3LinkUsageHighSet,\n";
    
    my $dat_notification_id = 1523;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSwitchFabricDown
sub _1_3_6_1_4_1_1556_17_0_6298
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The fabric associated to this switch card is NOT operational. Communication through this fabric has failed for all slots.    The switch card (MCH) might be physically extracted or there has been a software/hardware malfunction. Other cards in the chassis cannot communicate on this fabric. This alarm will be raised on upgrade due to normal operation. Cause  - Fabric is NOT operational. Action - Check the card is inserted and operational. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4  equipment alarm - ptTrapSeverity:      1  critical - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptSwitchFabricDown,\n";
    
    my $dat_notification_id = 1524;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRateLimiterDSCRlCongestionDiscard
sub _1_3_6_1_4_1_1556_17_0_1854
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC RateLimiter discarded a message due to configured congestion handling.\nTrapName = ptRateLimiterDSCRlCongestionDiscard,\n";
    
    my $dat_notification_id = 1525;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.1"})) {
        $dat_additional_text .= "\nptDSCRateLimiterName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.2"})) {
        $dat_additional_text .= "\nptDSCRateLimiterCapacityParameterSet = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPM3uaUserConnLoss
sub _1_3_6_1_4_1_1556_17_0_7228
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A user connection loss notification is sent when the connection between an ASP and Dinamo is lost.\nTrapName = ptM3UAASPM3uaUserConnLoss,\n";
    
    my $dat_notification_id = 1526;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesDSCCongestionDiscard
sub _1_3_6_1_4_1_1556_17_0_1849
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC Node discarded a message due to configured congestion handling.\nTrapName = ptDSCNodesDSCCongestionDiscard,\n";
    
    my $dat_notification_id = 1527;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSigflexDiskPartitionThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_5515
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the directory referenced by the ptTrapDirectoryName variable has reached its alarm threshold\nTrapName = ptSigflexDiskPartitionThresholdExceeded,\n";
    
    my $dat_notification_id = 1528;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1019"})) {
        $dat_additional_text .= "\nptTrapDirectoryName = " . $entrada->{"1.3.6.1.4.1.1556.17.1019"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANodeSTPRoutingLicenseAcquired
sub _1_3_6_1_4_1_1556_17_0_9982
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An attempt by the MTP3 NA to obtain a STP Routing license has succeeded\nTrapName = ptMTP3NANodeSTPRoutingLicenseAcquired,\n";
    
    my $dat_notification_id = 1529;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.6"})) {
        $dat_additional_text .= "\nptMTPMTP3NAStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIsmRootPartitionThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_5523
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the ISM root partition usage has reached its alarm threshold\nTrapName = ptIsmRootPartitionThresholdExceeded,\n";
    
    my $dat_notification_id = 1530;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericL3LinkDeactivated
sub _1_3_6_1_4_1_1556_17_0_8424
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a Generic signaling link has been deactivated. Causes ,Corrective actions and Frequency:   1) ptSpecificTrapCause = operatorDeactivation  Cause  - Operator deactivates link. Action - Operator can activate the link again. Freq   - Operator dependant.  2) ptSpecificTrapCause = timerT17Expiry Cause  - Event appears between each attempt to perform an initial  alignment procedure. After an unsuccessful attempt, a delay T17 expires before the next attempt is initiated. Action - Operator can activate the link.   Freq   - T19 expiry, T19 can take a value between 800 - 1500 ms 3) ptSpecificTrapCause = unknownCause References 1) Table 1 Q.752, SL Failure 2) Q.704 (07/96) Section 12.2  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 29 Loss of signal    ptTrapClearType:     1 fmic\nTrapName = ptGenericLinkGenericL3LinkDeactivated,\n";
    
    my $dat_notification_id = 1531;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesDSCNodeRoutingDiscard
sub _1_3_6_1_4_1_1556_17_0_1845
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC discarded a message via routing table.\nTrapName = ptDSCNodesDSCNodeRoutingDiscard,\n";
    
    my $dat_notification_id = 1532;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCpuUsageMajor
sub _1_3_6_1_4_1_1556_17_0_6242
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "CPU usage is very high.  The slot number indicated in this trap indicates the origin of the alarm.  This condition can lead the kernel to indiscriminately terminate processes causing outage.  A process listing and top output can identify the offending process. Cause  - CPU usage above threshold Action - Identify applications running high on CPU Freq   - Irregular\nTrapName = ptSlotSlotCpuUsageMajor,\n";
    
    my $dat_notification_id = 1533;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotDatabaseClusterMalfunction
sub _1_3_6_1_4_1_1556_17_0_3156
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The database cluster is NOT functioning as expected. Cause - 1. At least two cluster nodes are 'unreachable' to each other (Incorrect network configuration, Port 7000 closed, VM down or Cassandra stopped). 2. The running cluster status does NOT match the configuration information provided by the user during cluster setup, i.e., different tokens/racks/IP addresses,  different cluster sizes or different topologies (more or less than two data centers, more or less than two nodes per data center). Action - If a cluster node is 'unreachable' to the other nodes: - Make sure the corresponding VM is up and Cassandra is running - Make sure the network is properly configured and port 7000 is open. All nodes must successfully telnet  the other nodes on port 7000. If this is not the case, reconfigure the cluster with IPv4/IPv6 addresses belonging  to network interface pkt0 (or matching hostnames). Use WebUI/IP Networking/Routing IP Network to add an  IPv4/IPv6 address belonging to network interface pkt0 - Restart Cassandra If a mismatch between the cluster status and the configuration information provided by the user is observed: - Reconfigure the cluster using startmenu -> 1 - System -> 2 - Software Revisions -> 2 - DSC DB -> DSC DB Configuration. This will restart Cassandra once the configuration is completed Freq   - Irregular.\nTrapName = ptSlotDatabaseClusterMalfunction,\n";
    
    my $dat_notification_id = 1534;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCICUAASPCicUserConnLoss
sub _1_3_6_1_4_1_1556_17_0_7218
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A CIC UA connection loss notification is sent when the connection between an ASP and Dinamo is lost.\nTrapName = ptCICUAASPCicUserConnLoss,\n";
    
    my $dat_notification_id = 1535;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.217.222.223.1.1.3"})) {
        $dat_additional_text .= "\nptSGCICUAASPASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.217.222.223.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.217.222.223.1.1.1"})) {
        $dat_additional_text .= "\nptSGCICUAASPHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.217.222.223.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.217.222.223.1.1.2"})) {
        $dat_additional_text .= "\nptSGCICUAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.217.222.223.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptConnectionRemoteHostResFailCleared
sub _1_3_6_1_4_1_1556_17_0_5004
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An IP address resolution can be made for the Remote Host.  Connections from that address will pass.\nTrapName = ptConnectionRemoteHostResFailCleared,\n";
    
    my $dat_notification_id = 1536;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.5001.5005.5006.1.1.1"})) {
        $dat_additional_text .= "\nptLBConnectionName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.5001.5005.5006.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationLsmsConnDown
sub _1_3_6_1_4_1_1556_17_0_2001
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Connectivity to the LSMS has been lost.\nTrapName = ptSS7DBAppsConfigurationLsmsConnDown,\n";
    
    my $dat_notification_id = 1537;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL2LinkUncongested
sub _1_3_6_1_4_1_1556_17_0_7150
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is no longer congested. Causes and Frequency   1) ptSpecificTrapCause = managementInitiated  Cause  - Protocol Manager detects the condition 2) ptSpecificTrapCause = linkUncongested  Cause  - Trap occurs when the number of MSUs in the transmission or re-transmission buffer goes from a value in excess of the thresholds for congestion to a value which is less  than the thresholds.    Freq   - Dependant on throughput of MSUs . References 1) Q.704 , Section 3.8.2  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 49 Storage capacity problem ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL2LinkUncongested,\n";
    
    my $dat_notification_id = 1538;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkDeactivated
sub _1_3_6_1_4_1_1556_17_0_7133
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been deactivated. Causes ,Corrective actions and Frequency:   1) ptSpecificTrapCause = operatorDeactivation  Cause  - Operator deactivates link. Action - Operator can activate the link again. Freq   - Operator dependant.  2) ptSpecificTrapCause = timerT17Expiry Cause  - Event appears between each attempt to perform an initial  alignment procedure. After an unsuccessful attempt, a delay T17 expires before the next attempt is initiated. Action - Operator can activate the link.   Freq   - T19 expiry , T19 can take a value between 800 - 1500 ms 3) ptSpecificTrapCause = unknownCause References 1) Table 1 Q.752, SL Failure 2) Q.704 (07/96) Section 12.2  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 29 Loss of signal    ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL3LinkDeactivated,\n";
    
    my $dat_notification_id = 1539;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3UserOpcEqualsDpcClear
sub _1_3_6_1_4_1_1556_17_0_9957
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "MTP3 no longer detects user messages with OPC equals DPC for 5 minutes.\nTrapName = ptMTP3NAMtp3UserOpcEqualsDpcClear,\n";
    
    my $dat_notification_id = 1540;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NALongMsuUnsupportedClear
sub _1_3_6_1_4_1_1556_17_0_8154
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the timer that is monitoring the attempted routing of a long MSU message has expired and no new long MSU routing failures have occurred. The previous alarm has been cleared. Action - No action required Freq - this trap once after the timer has expired for monitoring long MSU discards. ptOriginatingOID:    DYNAMIC ptLinkset ptTrapType:          2 communicationAlarm  ptTrapSeverity:      5 clear  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptMTP3NALongMsuUnsupportedClear,\n";
    
    my $dat_notification_id = 1541;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAAppServerSUADiscardMsuFromPeerSet
sub _1_3_6_1_4_1_1556_17_0_7384
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MSU has been unexpectedly discarded between peers on SUA AS in the last 5-minute.\nTrapName = ptSUAAppServerSUADiscardMsuFromPeerSet,\n";
    
    my $dat_notification_id = 1542;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.9"})) {
        $dat_additional_text .= "\nptSGSUAAppServerApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUAAppServerSSN = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUAAppServerRoutingContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAAppServerNetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUAAppServerDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3RegistrationNPGWMTP3AppIDFailure
sub _1_3_6_1_4_1_1556_17_0_1615
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The MTP3 AppID registration was not successful on all the defined MTP3 connections.\nTrapName = ptMTP3RegistrationNPGWMTP3AppIDFailure,\n";
    
    my $dat_notification_id = 1543;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1605.1606.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwMTP3RegistrationApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1605.1606.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1605.1606.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwMTP3RegistrationNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1605.1606.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1605.1606.1.1.3"})) {
        $dat_additional_text .= "\nptnpgwMTP3RegistrationStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1605.1606.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMigrationRecordMigrationRecordSetToDiscardClear
sub _1_3_6_1_4_1_1556_17_0_8007
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Migration Record no longer has its New DPC attribute set to Discard\nTrapName = ptMigrationRecordMigrationRecordSetToDiscardClear,\n";
    
    my $dat_notification_id = 1544;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.792.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMigrationRecordOPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.792.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.792.1.1.2"})) {
        $dat_additional_text .= "\nptMTPMigrationRecordDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.792.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.792.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMigrationRecordMessageCategory = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.792.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAInvalidIncomingTraffic
sub _1_3_6_1_4_1_1556_17_0_9960
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An incoming MSU was discarded due to an invalid formatting.   This could be a malicious event or just misformed data.\nTrapName = ptMTP3NAInvalidIncomingTraffic,\n";
    
    my $dat_notification_id = 1545;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexMemoryError
sub _1_3_6_1_4_1_1556_17_0_2027
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications memory error.\nTrapName = ptSS7DBAppsConfigurationSigFlexMemoryError,\n";
    
    my $dat_notification_id = 1546;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCICUAAppServerSuccessEstablishCicServer
sub _1_3_6_1_4_1_1556_17_0_7203
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Successfully established CIC UA TCP Server.\nTrapName = ptCICUAAppServerSuccessEstablishCicServer,\n";
    
    my $dat_notification_id = 1547;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.2"})) {
        $dat_additional_text .= "\nptSGCICUAAppServerDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.5"})) {
        $dat_additional_text .= "\nptSGCICUAAppServerStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDiscreteSensorThermTripAssert
sub _1_3_6_1_4_1_1556_17_0_6324
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A discrete sensor therm trip alarm was asserted Cause  - A discrete sensor detects a therm trip condition Action - Verify sensor Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptDiscreteSensorThermTripAssert,\n";
    
    my $dat_notification_id = 1548;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRshRequestThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_5512
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the rsh request from audit_cpu to the master cpu has reached its alarm threshold\nTrapName = ptRshRequestThresholdExceeded,\n";
    
    my $dat_notification_id = 1549;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAASPSuaAssocMinStreamsFail
sub _1_3_6_1_4_1_1556_17_0_7348
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An SUA ASP association has been established with less than the minimum 2 steam requirement\nTrapName = ptSUAASPSuaAssocMinStreamsFail,\n";
    
    my $dat_notification_id = 1550;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"})) {
        $dat_additional_text .= "\nptSGSUAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCpuUsageMajorAbated
sub _1_3_6_1_4_1_1556_17_0_6243
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "CPU usage has returned to reasonable levels. Cause  - CPU usage below threshold. Action - None. Freq   - Irregular.\nTrapName = ptSlotSlotCpuUsageMajorAbated,\n";
    
    my $dat_notification_id = 1551;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptThresholdSensorUpperMajorAssert
sub _1_3_6_1_4_1_1556_17_0_6342
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A threshold sensor upper major alarm was asserted Cause  - A threshold sensor detects an upper major condition Action - Verify sensor Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      2 major - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptThresholdSensorUpperMajorAssert,\n";
    
    my $dat_notification_id = 1552;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptTransportServerServerUnavailable
sub _1_3_6_1_4_1_1556_17_0_1807
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC cannot setup the server for the given host and port.   The host might not resolve to a configured address for that slot.\nTrapName = ptTransportServerServerUnavailable,\n";
    
    my $dat_notification_id = 1553;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.5"})) {
        $dat_additional_text .= "\nptDSCTransportServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.6"})) {
        $dat_additional_text .= "\nptDSCTransportServerHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.1"})) {
        $dat_additional_text .= "\nptDSCTransportServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRouteRouteInaccessibleCRDT
sub _1_3_6_1_4_1_1556_17_0_7159
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a route is no longer accessible because it failed the ANSI Circular Route Detection Test (CRDT). It is cleared by a routeInaccessibleCRDTRecovery trap. Cause  - The route failed an ANSI Circular Route Detection Test (CRDT).  It will remain unavailable until maintenance personnel reset the state of the route using the Reset State action (presumably after investigating and removing the routing loop). Action - Investigate and remove the cause of circular routing, then reset the route state using the Reset State action. Freq   - This trap will appear when the route fails an ANSI CRDT. References  1) GR-246-CORE Issue 10 T1.111.7 Section 2.4 2) GR-82-CORE Issue 10 ptOriginatingOID:    DYNAMIC ptRoute  ptTrapType:          2 communicationAlarm  ptTrapSeverity:      1 critical ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptRouteRouteInaccessibleCRDT,\n";
    
    my $dat_notification_id = 1554;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.6"})) {
        $dat_additional_text .= "\nptMTPRouteLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRouteCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.2"})) {
        $dat_additional_text .= "\nptMTPRouteAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.5"})) {
        $dat_additional_text .= "\nptMTPRouteState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPCEConfigurationPceDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_4306
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptPCEConfigurationPceDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1555;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2UALinkM2uaL3LinkUsageAlarmSet
sub _1_3_6_1_4_1_1556_17_0_7197
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 8.2.0. This trap indicates that the average traffic over this link exceeds  predefined threshold. There is potential for traffic loss if this  condition persists References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 51 Threshold crossed  ptTrapClearType:     2 oic\nTrapName = ptM2UALinkM2uaL3LinkUsageAlarmSet,\n";
    
    my $dat_notification_id = 1556;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"})) {
        $dat_additional_text .= "\nptMTPM2UALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2UALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2UALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2UALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2UALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2UALinkIID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAM3UAASMasterNAMismatch
sub _1_3_6_1_4_1_1556_17_0_7318
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an AS Master has NA data on the C20 Core but not on the SG. It could be caused by deletion operation failure or a synchronization issue. The user should compare the C20 Core with the SG NA data and fix it manually. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm ptTrapSeverity: 2 major  ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType: 1 fmic\nTrapName = ptM3UAM3UAASMasterNAMismatch,\n";
    
    my $dat_notification_id = 1557;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionADNCLocalEndPointConflict
sub _1_3_6_1_4_1_1556_17_0_1828
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC ADN Connection SCTP local end point has a conflict.  The local host and port combination is in use by another server, ADNC, or different application. Review SCTP usage on the slot and host resolution for conflict.\nTrapName = ptADNConnectionADNCLocalEndPointConflict,\n";
    
    my $dat_notification_id = 1558;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.15"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.15"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMSAMsaThreshold1Cleared
sub _1_3_6_1_4_1_1556_17_0_8205
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the MSA threshold 1 is cleared.\nTrapName = ptMSAMsaThreshold1Cleared,\n";
    
    my $dat_notification_id = 1559;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.961.962.1.1.1"})) {
        $dat_additional_text .= "\nptmsaMSAName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.961.962.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptHardwareMonitorHwMonInitSlow
sub _1_3_6_1_4_1_1556_17_0_6302
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Hardware Monitor initialization slow. The initialization process is taking longer than expected. The portald might still be busy populating its database. Cause  - Hardware Monitor Initialization Slow Action - Check portald process listing Freq   - Infrequent\nTrapName = ptHardwareMonitorHwMonInitSlow,\n";
    
    my $dat_notification_id = 1560;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1.1.1"})) {
        $dat_additional_text .= "\npthwmonHardwareMonitorStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptL4ConverterL4cvtrPeerUp
sub _1_3_6_1_4_1_1556_17_0_4103
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates a L4Cvtr peer is reachable.   Sent when a L4Cvtr peer communication is established via LDL.\nTrapName = ptL4ConverterL4cvtrPeerUp,\n";
    
    my $dat_notification_id = 1561;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptThresholdSensorLowerMajorAssert
sub _1_3_6_1_4_1_1556_17_0_6348
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A threshold sensor lower major alarm was asserted Cause  - A threshold sensor detects a lower major condition Action - Verify sensor Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      2 major - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptThresholdSensorLowerMajorAssert,\n";
    
    my $dat_notification_id = 1562;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionADNConnAssocPathEstablished
sub _1_3_6_1_4_1_1556_17_0_1815
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "ADN Connection path is up on a multi-homed user connection, following a path failure.\nTrapName = ptADNConnectionADNConnAssocPathEstablished,\n";
    
    my $dat_notification_id = 1563;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaMultiASPAssocHighReceiveUsageAbateme
sub _1_3_6_1_4_1_1556_17_0_7335
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The amount of traffic being received by the SG on a single M3UA Multi ASP association has resumed normal levels. The conditions of this clear event are controlled by the user using the M3UA High Usage Abatement setting.\nTrapName = ptM3UAASPAssociationM3uaMultiASPAssocHighReceiveUsageAbateme,\n";
    
    my $dat_notification_id = 1564;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAdjacentDiameterNodeADNCleared
sub _1_3_6_1_4_1_1556_17_0_1806
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The ADN is now either deactivated, or connectivity is established on at least one connection.\nTrapName = ptAdjacentDiameterNodeADNCleared,\n";
    
    my $dat_notification_id = 1565;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1.1.2"})) {
        $dat_additional_text .= "\nptDSCAdjacentDiameterNodeAdjacentDiameterID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptL4ConverterL4cvtrDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_4106
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptL4ConverterL4cvtrDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1566;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesDSCNodesRequestRejectedQueueFull
sub _1_3_6_1_4_1_1556_17_0_1874
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This alarm indicates that at least one Diameter Request message has been recently rejected because of excessive memory used by queued Diameter Request messages. In this context, 'recently' means in the last 5 minutes and 'rejected' means that an error is returned with Result-Code DIAMETER_UNABLE_TO_DELIVER. Cause: At least one Diameter Request message has been recently rejected because of excessive memory used by queued Diameter Request messages. Possible Actions - Excessive memory use for queued requests usually happens because a large number of requests are not answered. This is an unusual situation. First, check that the DSC MSA objects with Name QUEUE USAGE <slot> have reasonable Max Size attributes. The Maximum Size attribute represents the number of megabytes that may be queued. If this queue size is too low it could lead to unnecessary request rejection. Next, large amounts of queued requests usually mean that requests are timing out. These request timeouts should be generating paced logs in ptidbglog that gives some characteristics of the discarded messages. Investigate the timeouts and see if the root cause can be determined (are all the timeouts relating to the same Destination-Realm and Application-Id, for example).\nTrapName = ptDSCNodesDSCNodesRequestRejectedQueueFull,\n";
    
    my $dat_notification_id = 1567;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetSs7LinksetAlarmsDisabled
sub _1_3_6_1_4_1_1556_17_0_7167
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Linkset alarms are disabled.\nTrapName = ptLinksetSs7LinksetAlarmsDisabled,\n";
    
    my $dat_notification_id = 1568;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLinksetState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetLinksetOPCVerificationDisabled
sub _1_3_6_1_4_1_1556_17_0_8002
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The Linkset OPC verification field is set to a value other than enabled. Please verify the performed OPC checks are required\nTrapName = ptLinksetLinksetOPCVerificationDisabled,\n";
    
    my $dat_notification_id = 1569;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLinksetState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMigrationRecordMigrationRecordSetToDiscard
sub _1_3_6_1_4_1_1556_17_0_8006
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Migration Record has its New DPC attribute set to Discard\nTrapName = ptMigrationRecordMigrationRecordSetToDiscard,\n";
    
    my $dat_notification_id = 1570;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.792.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMigrationRecordMessageCategory = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.792.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.792.1.1.2"})) {
        $dat_additional_text .= "\nptMTPMigrationRecordDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.792.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.792.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMigrationRecordOPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.792.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericL3LinkAlarmsEnabled
sub _1_3_6_1_4_1_1556_17_0_8164
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Generic Link alarms are enabled.\nTrapName = ptGenericLinkGenericL3LinkAlarmsEnabled,\n";
    
    my $dat_notification_id = 1571;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationBulkInputFailError
sub _1_3_6_1_4_1_1556_17_0_2013
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "NP Database Bulk Input completed with some failed entry.\nTrapName = ptSS7DBAppsConfigurationBulkInputFailError,\n";
    
    my $dat_notification_id = 1572;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptHardwareMonitorHwMonShutdown
sub _1_3_6_1_4_1_1556_17_0_6300
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Hardware Monitor stopped. Cause  - Hardware Monitor stopped Action - Check process listing Freq   - Infrequent References - ptOriginatingOID:    DYNAMIC ptHwMon - ptTrapType:          4 equipment alarm - ptTrapSeverity:      2 major - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptHardwareMonitorHwMonShutdown,\n";
    
    my $dat_notification_id = 1573;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1.1.1"})) {
        $dat_additional_text .= "\npthwmonHardwareMonitorStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionDSCAdncRoutingDiscard
sub _1_3_6_1_4_1_1556_17_0_1847
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC ADN Connection discarded a message via routing table.\nTrapName = ptADNConnectionDSCAdncRoutingDiscard,\n";
    
    my $dat_notification_id = 1574;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.15"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.15"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptHardwareMonitorHwMonInitCompleted
sub _1_3_6_1_4_1_1556_17_0_6303
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Hardware Monitor initialization completed. Cause  - Hardware Monitor initialization completed Action - None Freq   - Infrequent\nTrapName = ptHardwareMonitorHwMonInitCompleted,\n";
    
    my $dat_notification_id = 1575;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1.1.1"})) {
        $dat_additional_text .= "\npthwmonHardwareMonitorStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPPCSSNRegistrationNPGWSCCPPCSSNSuccess
sub _1_3_6_1_4_1_1556_17_0_1608
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP PC-SSN registration was successful on all the defined SCCP connections.\nTrapName = ptSCCPPCSSNRegistrationNPGWSCCPPCSSNSuccess,\n";
    
    my $dat_notification_id = 1576;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.3"})) {
        $dat_additional_text .= "\nptnpgwSCCPPCSSNRegistrationSSN = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwSCCPPCSSNRegistrationNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.4"})) {
        $dat_additional_text .= "\nptnpgwSCCPPCSSNRegistrationStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwSCCPPCSSNRegistrationPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1610.1611.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCpuUsageMajorThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_5520
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the CPU Usage has returned below its major alarm threshold on a CPU Core\nTrapName = ptCpuUsageMajorThresholdCleared,\n";
    
    my $dat_notification_id = 1577;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1021"})) {
        $dat_additional_text .= "\nptTrapCpuUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.1021"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1020"})) {
        $dat_additional_text .= "\nptTrapCpuCore = " . $entrada->{"1.3.6.1.4.1.1556.17.1020"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCPUMemUsageCriticalPersists
sub _1_3_6_1_4_1_1556_17_0_6262
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Memory availability continues to be lower than the Free Memory Threshold configured in the Web UI.  The slot number shown in this trap indicates the origin of the alarm. Cause  - Memory usage it too high Action - Identify applications consuming memory Freq   - Irregular References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     0 oic\nTrapName = ptSlotSlotCPUMemUsageCriticalPersists,\n";
    
    my $dat_notification_id = 1578;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"})) {
        $dat_additional_text .= "\nptSlotCPUMemoryUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPortMpmtp2PortPrbsSet
sub _1_3_6_1_4_1_1556_17_0_5815
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the PRBS test is active. Cause  - A user has activated PRBS testing Action - Stop PRBS or Stop BERT to deactivate PRBS testing Freq   - This trap will appear when the user instructs the port to perform PRBS testing, such as for BERT. References - ptOriginatingOID:    DYNAMIC ptPort - ptTrapType:          2 communication alarm - ptTrapSeverity:      3 minor - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptPortMpmtp2PortPrbsSet,\n";
    
    my $dat_notification_id = 1579;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWPortPortNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptHardwareMonitorHwMonDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_6305
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All debug attributes are set to their recommended values.\nTrapName = ptHardwareMonitorHwMonDebugLevelRecommended,\n";
    
    my $dat_notification_id = 1580;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UASCTPServersM3uaLicClrCritical
sub _1_3_6_1_4_1_1556_17_0_7235
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Critical M3UA License Event has been cleared\nTrapName = ptM3UASCTPServersM3uaLicClrCritical,\n";
    
    my $dat_notification_id = 1581;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotMonitorMissingIOcfgFile
sub _1_3_6_1_4_1_1556_17_0_3184
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = " \nTrapName = ptSlotMonitorMissingIOcfgFile,\n";
    
    my $dat_notification_id = 1582;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"})) {
        $dat_additional_text .= "\nptSlotMonitorHostname = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotMonitorSlotTIPCAuditClear
sub _1_3_6_1_4_1_1556_17_0_6259
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A TIPC discrepancy state has been cleared.  A subsequent audit has not detected anything wrong. Cause  - TIPC audit detected no problems. Action - None Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4  equipment alarm - ptTrapSeverity:      5  clear - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptSlotMonitorSlotTIPCAuditClear,\n";
    
    my $dat_notification_id = 1583;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"})) {
        $dat_additional_text .= "\nptSlotMonitorHostname = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3NAConnected
sub _1_3_6_1_4_1_1556_17_0_7231
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MTP3 NA connected notification is sent when the connectivity between the Dinamo and MTP3 is established.\nTrapName = ptMTP3NAMtp3NAConnected,\n";
    
    my $dat_notification_id = 1584;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"})) {
        $dat_additional_text .= "\nptSGMTP3NANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDiscreteSensorPowerFaultDeassert
sub _1_3_6_1_4_1_1556_17_0_6321
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A discrete sensor power fault alarm was deasserted Cause  - A discrete sensor no longer detects a power fault condition Action - None Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptDiscreteSensorPowerFaultDeassert,\n";
    
    my $dat_notification_id = 1585;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSNAMIConfigurationGR310TL1ConnUp
sub _1_3_6_1_4_1_1556_17_0_1502
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The GR310 server TL1 connection is now up or interval has expired.\nTrapName = ptSNAMIConfigurationGR310TL1ConnUp,\n";
    
    my $dat_notification_id = 1586;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptApplicationSlotApplicationStarted
sub _1_3_6_1_4_1_1556_17_0_6257
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The named application is running. Cause  - Application in running. Action - None. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Application - ptTrapType:          4  equipment alarm - ptTrapSeverity:      5  clear - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptApplicationSlotApplicationStarted,\n";
    
    my $dat_notification_id = 1587;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.603.1.1.3"})) {
        $dat_additional_text .= "\nptApplicationApplicationState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.603.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.603.1.1.2"})) {
        $dat_additional_text .= "\nptApplicationApplicationName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.603.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.603.1.1.1"})) {
        $dat_additional_text .= "\nptApplicationSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.603.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2UALinkM2uaL3LinkAlarmsDisabled
sub _1_3_6_1_4_1_1556_17_0_8144
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "M2UA Link alarms are disabled.\nTrapName = ptM2UALinkM2uaL3LinkAlarmsDisabled,\n";
    
    my $dat_notification_id = 1588;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2UALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2UALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2UALinkIID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2UALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2UALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"})) {
        $dat_additional_text .= "\nptMTPM2UALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaMultiASPAssocHighTransmitUsageOnset
sub _1_3_6_1_4_1_1556_17_0_7332
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The amount of traffic being transmitted by the SG on a single M3UA Multi ASP association has reached excessive levels. The conditions of this clear event are controlled by the user using the M3UA High Usage Onset setting.\nTrapName = ptM3UAASPAssociationM3uaMultiASPAssocHighTransmitUsageOnset,\n";
    
    my $dat_notification_id = 1589;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptINAPGWConfigurationINAPGWDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_1312
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All debug attributes are set to their recommended values.\nTrapName = ptINAPGWConfigurationINAPGWDebugLevelRecommended,\n";
    
    my $dat_notification_id = 1590;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3UAASPAssocUnresolvedLocalHost2
sub _1_3_6_1_4_1_1556_17_0_7702
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that M3UA ASP Association Local IP Address 2 hostname is not resolvable. Cause - The SG is unable to resolve the hostname. Possible Actions - If the DSC has been set up to use a DNS server,  ensure the DNS server is reachable and confirm that the hostname has been configured. If the hostname is intended to resolve locally, ensure the proper hostname entry  has been added using IP Networking > Hostname Resolution. Freq - This trap occurs when the configured hostname becomes unresolvable.\nTrapName = ptM3UAASPAssociationM3UAASPAssocUnresolvedLocalHost2,\n";
    
    my $dat_notification_id = 1591;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSFGUASFGUAExchangeUp
sub _1_3_6_1_4_1_1556_17_0_7401
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the SFG UA exchange is now up.   Cause: SS7 DB routing application is now available and ready. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm  ptTrapSeverity: 5 cleared  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType: 1 fmic\nTrapName = ptSFGUASFGUAExchangeUp,\n";
    
    my $dat_notification_id = 1592;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.260.1.1.1"})) {
        $dat_additional_text .= "\nptSGSFGUAExchangeName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.260.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.260.1.1.2"})) {
        $dat_additional_text .= "\nptSGSFGUAExchangeStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.260.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ucdStart
sub _1_3_6_1_4_1_2021_251_1
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap could in principle be sent when the agent start\nTrapName = ucdStart,\n";
    
    my $dat_notification_id = 1593;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAManagerSccpPeerDown
sub _1_3_6_1_4_1_1556_17_0_4204
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates a SCCP peer is no longer reachable.   Sent when a SCCP peer communication is lost via LDL. Peer connectivity interruptions include: - SCCP peer is terminated - IP connectivity heartbeat/keep alive fails - IP connectivity is lost between SCCP processes.\nTrapName = ptSCCPNAManagerSccpPeerDown,\n";
    
    my $dat_notification_id = 1594;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3UAASPAssocResolvedRemoteHost2
sub _1_3_6_1_4_1_1556_17_0_7707
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "M3UA ASP Association Remote IP Address 2 hostname is resolved\nTrapName = ptM3UAASPAssociationM3UAASPAssocResolvedRemoteHost2,\n";
    
    my $dat_notification_id = 1595;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UASCTPServersM3uaLicCritical
sub _1_3_6_1_4_1_1556_17_0_7234
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Critical M3UA License Event has occurred\nTrapName = ptM3UASCTPServersM3uaLicCritical,\n";
    
    my $dat_notification_id = 1596;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPSXHostConnectionNPGWPSXHostConnUp
sub _1_3_6_1_4_1_1556_17_0_1622
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW PSX Host Connection is connected.\nTrapName = ptPSXHostConnectionNPGWPSXHostConnUp,\n";
    
    my $dat_notification_id = 1597;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1620.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwPSXHostConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1620.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1620.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwPSXHostConnectionStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1620.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionADNConnectionCleared
sub _1_3_6_1_4_1_1556_17_0_1802
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The ADN Connection is either deactivated, or connectivity is established on it.\nTrapName = ptADNConnectionADNConnectionCleared,\n";
    
    my $dat_notification_id = 1598;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3NAC20SyncFail
sub _1_3_6_1_4_1_1556_17_0_7320
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MTP3 NA Sync Failed notification is sent when Dinamo fails to synchronize the newly add NA value to C20 Core and mismatch occurs.\nTrapName = ptMTP3NAMtp3NAC20SyncFail,\n";
    
    my $dat_notification_id = 1599;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"})) {
        $dat_additional_text .= "\nptSGMTP3NANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2UALinkM2uaL3LinkOscillationFilterClear
sub _1_3_6_1_4_1_1556_17_0_8173
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that Link Oscillation Filter Timer T32 has expired\nTrapName = ptM2UALinkM2uaL3LinkOscillationFilterClear,\n";
    
    my $dat_notification_id = 1600;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"})) {
        $dat_additional_text .= "\nptMTPM2UALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2UALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2UALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2UALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2UALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2UALinkIID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANodeSNMHostGoingStandby
sub _1_3_6_1_4_1_1556_17_0_8156
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SNM Host going Standby. This is a stateless trap (no alarm).\nTrapName = ptMTP3NANodeSNMHostGoingStandby,\n";
    
    my $dat_notification_id = 1601;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"})) {
        $dat_additional_text .= "\nptMTPMTP3NALocalPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptINAPGWConfigurationINAPGWDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_1311
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptINAPGWConfigurationINAPGWDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1602;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UASCTPServerM3UASCTPServerUp
sub _1_3_6_1_4_1_1556_17_0_7351
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An M3UA SCTP server is up\nTrapName = ptM3UASCTPServerM3UASCTPServerUp,\n";
    
    my $dat_notification_id = 1603;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotAvailableMemThresh50Exceeded
sub _1_3_6_1_4_1_1556_17_0_3174
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Memory availability has dropped below 50% of total memory.  The slot number shown in this trap indicates the origin of the alarm.   Cause  - Memory usage reached a certain threshold Action - Identify applications consuming memory Freq   - Irregular References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     1 fmic\nTrapName = ptSlotAvailableMemThresh50Exceeded,\n";
    
    my $dat_notification_id = 1604;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"})) {
        $dat_additional_text .= "\nptSlotCPUMemoryUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkUsageAlarmSet
sub _1_3_6_1_4_1_1556_17_0_7124
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 8.2.0. This trap indicates that the average traffic over this link exceeds  predefined threshold. There is potential for traffic loss if this  condition persists References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 51 Threshold crossed  ptTrapClearType:     2 oic\nTrapName = ptLSLinkSs7L3LinkUsageAlarmSet,\n";
    
    my $dat_notification_id = 1605;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptProcessEventStatsMgrNotConnected
sub _1_3_6_1_4_1_1556_17_0_8306
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the peer stats manager is not connected. Not raised during initialization.\nTrapName = ptProcessEventStatsMgrNotConnected,\n";
    
    my $dat_notification_id = 1606;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"})) {
        $dat_additional_text .= "\nptpeereventProcessEventSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"})) {
        $dat_additional_text .= "\nptpeereventProcessEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptL4ConverterL4cvtrProcessStartup
sub _1_3_6_1_4_1_1556_17_0_4101
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates the L4Cvtr process is starting up.   Sent every time L4Cvtr starts up via a manual intervention or typically  via the watchdog.\nTrapName = ptL4ConverterL4cvtrProcessStartup,\n";
    
    my $dat_notification_id = 1607;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSNAMIConfigurationGR310MessageLoss
sub _1_3_6_1_4_1_1556_17_0_1503
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The GR310 server has rejected a message due to UPL header or message decode error, unsupported message, or response message cannot be returned due to loss  of client. The event will be cleared if no other occurrences is raised in the next  5 minutes.\nTrapName = ptSNAMIConfigurationGR310MessageLoss,\n";
    
    my $dat_notification_id = 1608;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaMultiAssocPathEstablished
sub _1_3_6_1_4_1_1556_17_0_7341
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An path is up on a multi-homed user connection\nTrapName = ptM3UAASPAssociationM3uaMultiAssocPathEstablished,\n";
    
    my $dat_notification_id = 1609;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAManagerSccpDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_4208
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptSCCPNAManagerSccpDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1610;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTDBDefGttOpcLoopFilterDetect
sub _1_3_6_1_4_1_1556_17_0_4417
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "GTT OPC Loop Detection filters PC List entries. This alarm will clear automatically if no more message results in PC List entry filtering by OPC Loop Detection for 5 minutes.\nTrapName = ptGTTDBDefGttOpcLoopFilterDetect,\n";
    
    my $dat_notification_id = 1611;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.683.684.1.1.1"})) {
        $dat_additional_text .= "\nptGTTGTTDBDefName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.683.684.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2UALinkM2uaL3LinkAvailable
sub _1_3_6_1_4_1_1556_17_0_8188
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is available for user traffic. Clears m2uaL3LinkUnavailable. References 1) GR310CORE Issue 3 Section 8.1 2) GR246CORE Issue 10 3) GR82CORE  Issue 10 4) Q.704 ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptM2UALinkM2uaL3LinkAvailable,\n";
    
    my $dat_notification_id = 1612;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"})) {
        $dat_additional_text .= "\nptMTPM2UALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2UALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2UALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2UALinkIID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2UALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2UALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIWFDiameterIWFDiameterAnswerMatchClear
sub _1_3_6_1_4_1_1556_17_0_1916
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The IWF did not received a Diameter answer without a match in the last 5 minutes.\nTrapName = ptIWFDiameterIWFDiameterAnswerMatchClear,\n";
    
    my $dat_notification_id = 1613;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.5"})) {
        $dat_additional_text .= "\nptiwfIWFDiameterDSCIWFUAPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.1"})) {
        $dat_additional_text .= "\nptiwfIWFDiameterIWFDiameterID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.7"})) {
        $dat_additional_text .= "\nptiwfIWFDiameterConnectivityStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.7"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesDSCNodesRequestRejectedQueueFullClear
sub _1_3_6_1_4_1_1556_17_0_1875
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This alarm clears ptDSCNodesRequestRejectedQueueFull. There have been no discards due to excessive memory usage for 5 minutes.\nTrapName = ptDSCNodesDSCNodesRequestRejectedQueueFullClear,\n";
    
    my $dat_notification_id = 1614;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPSXHostNPGWPSXHostActive
sub _1_3_6_1_4_1_1556_17_0_1634
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW PSX Host is active.\nTrapName = ptPSXHostNPGWPSXHostActive,\n";
    
    my $dat_notification_id = 1615;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwPSXHostPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.6"})) {
        $dat_additional_text .= "\nptnpgwPSXHostUserActivated = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwPSXHostHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NALongMsuUnsupportedSet
sub _1_3_6_1_4_1_1556_17_0_8153
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a long MSU message has been received and was discarded in an attempt to route on a linkset, user part or app id that  does not support Long MSU messages.  This alarm will persist for the duration of the timer  Long MSU Discard Interval from the time of the last  discarded long MSU. Cause - Possible causes include incorrect setting of the  Long MSU Support option for the linkset, or a user part or app id not registered as  supporting long MSUs. Another cause could be an adjacent node or user part  that could be sending long MSUs without the correct NA configuration  in the Maximum MSU Length attribute. Action - Check that the provisioning is correct. See the sys logs and debug logs for more details on the MSUs that were discarded. Freq - this trap will occur while long MSUs are being sent to a linkset,  user part or app ID, for the duration defined by the  NA attribute: Long MSU Discard Interval.  If another Long MSU is  discarded during the interval, then the timer will restart.  When the interval timer expires, the dashboard alarm will be removed. ptOriginatingOID:    DYNAMIC ptLinkset ptTrapType:          2 communicationAlarm  ptTrapSeverity:      3 minor  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptMTP3NALongMsuUnsupportedSet,\n";
    
    my $dat_notification_id = 1616;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetLinksetPCMappingInUse
sub _1_3_6_1_4_1_1556_17_0_8000
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The Linkset PC Mapping field is not empty and so PC Mapping will be performed on this linkset.\nTrapName = ptLinksetLinksetPCMappingInUse,\n";
    
    my $dat_notification_id = 1617;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLinksetState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotIsmVarPartitionThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_6248
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "ISM /opt partition usage is above the alarm threshold defined in  disk_space_quota.  The slot number indicated in this trap indicates the origin of the alarm. Cause  - ISM /opt partition usage above threshold Action - Identify applications running high on disk space Freq   - Irregular\nTrapName = ptSlotSlotIsmVarPartitionThresholdExceeded,\n";
    
    my $dat_notification_id = 1618;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkUsageHighSet
sub _1_3_6_1_4_1_1556_17_0_8136
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the average traffic over this link exceeds predefined threshold. There is potential for traffic loss if this condition persists. References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 51 Threshold crossed ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL3LinkUsageHighSet,\n";
    
    my $dat_notification_id = 1619;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCPeerSyncTimeoutClear
sub _1_3_6_1_4_1_1556_17_0_1867
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Peersync is successful\nTrapName = ptDSCPeerSyncTimeoutClear,\n";
    
    my $dat_notification_id = 1620;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.1"})) {
        $dat_additional_text .= "\nptDSCDSCDSCName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.2"})) {
        $dat_additional_text .= "\nptDSCDSCDSCInstanceID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGWSTGwstProcessStartup
sub _1_3_6_1_4_1_1556_17_0_4001
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates the GWST process is starting up. Sent every time GWST starts up via a manual intervention or typically via the watchdog.\nTrapName = ptGWSTGwstProcessStartup,\n";
    
    my $dat_notification_id = 1621;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkUnavailable
sub _1_3_6_1_4_1_1556_17_0_8183
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is unavailable for user traffic. Cleared by atmL3LinkAvailable. Cause  - The link is unavailable to user traffic for some reason (e.g. out of service, blocked, inhibited). Action - Depends on link state. Freq   - Operator dependant. References 1) GR310CORE Issue 3 Section 8.1 2) GR246CORE Issue 10 3) GR82CORE  Issue 10 4) Q.704 ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        3 minor ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptATMLinkAtmL3LinkUnavailable,\n";
    
    my $dat_notification_id = 1622;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotIsmOptPartitionThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_6247
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "ISM /opt partition usage has returned to acceptable levels. Cause  - ISM /opt partition usage below threshold. Action - None. Freq   - Irregular.\nTrapName = ptSlotSlotIsmOptPartitionThresholdCleared,\n";
    
    my $dat_notification_id = 1623;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationBulkInputCongClear
sub _1_3_6_1_4_1_1556_17_0_2016
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "NP Database Bulk Input congestion alarm cleared.\nTrapName = ptSS7DBAppsConfigurationBulkInputCongClear,\n";
    
    my $dat_notification_id = 1624;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptExternalPortSwitchPortUp
sub _1_3_6_1_4_1_1556_17_0_6283
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A switch external port is up.  Cause  - External port now responsive. Action - None. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Application - ptTrapType:          4  equipment alarm - ptTrapSeverity:      5  clear - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptExternalPortSwitchPortUp,\n";
    
    my $dat_notification_id = 1625;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.2"})) {
        $dat_additional_text .= "\nptSWMExternalPortPortNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.3"})) {
        $dat_additional_text .= "\nptSWMExternalPortState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.5"})) {
        $dat_additional_text .= "\nptSWMExternalPortPortName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.1"})) {
        $dat_additional_text .= "\nptSWMExternalPortSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRouteRouteInaccessible
sub _1_3_6_1_4_1_1556_17_0_7151
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a route is no longer accessible. It is cleared by a routeAccessible trap. Cause  - The route may become inaccessible for a number of reasons including - SS7 Node can no longer receive SS7 traffic - All links to this route have been removed  Action - Depends on the cause  Freq   - This trap will appear when the status of a route changes to inaccessible.   References  1) Q.703 , (07/96) Section 7.3  ptOriginatingOID:    DYNAMIC ptRoute  ptTrapType:          2 communicationAlarm  ptTrapSeverity:      3 minor ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptRouteRouteInaccessible,\n";
    
    my $dat_notification_id = 1626;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.5"})) {
        $dat_additional_text .= "\nptMTPRouteState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.2"})) {
        $dat_additional_text .= "\nptMTPRouteAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRouteCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.6"})) {
        $dat_additional_text .= "\nptMTPRouteLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericSLSLinkAuditFailure
sub _1_3_6_1_4_1_1556_17_0_9997
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "MTP3 detected an unavailable link in an SLS Table. MSU loss is possible. Cleared by GenericSLSLinkAuditFailureClear. Cause  - MTP3 detected an unavailable link in an SLS Table. Action - This alarm should resolve itself in less than four minutes. If this alarm does not clear itself you should deactivate and activate the link. Freq   - Operator dependant. References None. This is an implementation specific audit. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        1 critical ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptGenericLinkGenericSLSLinkAuditFailure,\n";
    
    my $dat_notification_id = 1627;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSwitchSwitchIntegrityFailed
sub _1_3_6_1_4_1_1556_17_0_6292
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The integrity status of this switch is failed. This status is determined by on-board background tests performed continually. Cause  - Switch Integrity has been reported as Failed. Action - Check log files for messages from this card. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4  equipment alarm - ptTrapSeverity:      2  major - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptSwitchSwitchIntegrityFailed,\n";
    
    my $dat_notification_id = 1628;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkRemoteInhibited
sub _1_3_6_1_4_1_1556_17_0_7177
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been inhibited at a  remote node. Cause  - Operator has inhibited remote end of the link. Action - Link is inhibited until the operator uninhibits the  remote end of the link. Freq   - Operator dependant.  References 1) Table 2 Q.752, Start of remote inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm  ptTrapSeverity:      4 warning ptTrapProbableCause: 43 Resource at or near capacity   ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkRemoteInhibited,\n";
    
    my $dat_notification_id = 1629;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkFailCraftRefTimerExpiry
sub _1_3_6_1_4_1_1556_17_0_8125
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the fail link craft referral timer expired without having signaling link activated. The fail link craft referral timer is the duration allowed for a signaling link to come into service. After expiry of this timer, this alarm is generated as per the system configuration. References 1) GR246 Core, section 12.2.1, 12.3.1, 12.3.2 2) GR-82-CORE,  CR6-43 [673] 3) GR-310-CORE, Issue 3, Section 8.1 ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 29 Loss of signal  ptTrapClearType:     2 oic\nTrapName = ptM2PALinkM2paL3LinkFailCraftRefTimerExpiry,\n";
    
    my $dat_notification_id = 1630;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptThresholdSensorLowerMajorDeassert
sub _1_3_6_1_4_1_1556_17_0_6349
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A threshold sensor lower major alarm was deasserted Cause  - A threshold sensor no longer detects a lower major condition Action - None Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptThresholdSensorLowerMajorDeassert,\n";
    
    my $dat_notification_id = 1631;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotAIDEErrorDetected
sub _1_3_6_1_4_1_1556_17_0_3172
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "AIDE has detected file modification on one or more files. Cause: A file has been modified since the last AIDE database initialization. Possible Actions - Investigate the audittrail log to determine which files have been modified and which  action(s) may have caused them to be modified.    Reinitilazing the AIDE database via the System Manager will clear the alarm.\nTrapName = ptSlotSlotAIDEErrorDetected,\n";
    
    my $dat_notification_id = 1632;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionADNConnAssocMaxMsgSizeDiscardClear
sub _1_3_6_1_4_1_1556_17_0_1819
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "ADN Connection Association has not received a message exceeding the maximum size in the past 30 seconds.\nTrapName = ptADNConnectionADNConnAssocMaxMsgSizeDiscardClear,\n";
    
    my $dat_notification_id = 1633;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesTpsServerSetupFailure
sub _1_3_6_1_4_1_1556_17_0_1862
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "DSC TPS Update Server setup failed\nTrapName = ptDSCNodesTpsServerSetupFailure,\n";
    
    my $dat_notification_id = 1634;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetSs7LinksetAccessible
sub _1_3_6_1_4_1_1556_17_0_7156
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an SS7 linkset is now accessible. Cause  - The linkset may become accessible when links in the linkset are aligned  Action - None required Freq   - This trap will appear when the status of a linkset changes to active.   References  1) Q.703 , (07/96) Section 7.3  ptOriginatingOID:    DYNAMIC ptLinkset ptTrapType:          2 communicationAlarm  ptTrapSeverity:      5 cleared  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptLinksetSs7LinksetAccessible,\n";
    
    my $dat_notification_id = 1635;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLinksetState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRateLimiterDSCRlSevereCongestionDiscardCleared
sub _1_3_6_1_4_1_1556_17_0_1857
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC RateLimiter has not discarded any answer message due to severe congestion for 5 minutes\nTrapName = ptRateLimiterDSCRlSevereCongestionDiscardCleared,\n";
    
    my $dat_notification_id = 1636;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.1"})) {
        $dat_additional_text .= "\nptDSCRateLimiterName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.2"})) {
        $dat_additional_text .= "\nptDSCRateLimiterCapacityParameterSet = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAConfiguredASPM3UAConfiguredASPUp
sub _1_3_6_1_4_1_1556_17_0_7303
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a Configured ASP is now up.   Cause: An ASP has connected and sent an ASPUP notification. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm  ptTrapSeverity: 5 cleared  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType: 1 fmic\nTrapName = ptM3UAConfiguredASPM3UAConfiguredASPUp,\n";
    
    my $dat_notification_id = 1637;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3UAASPAssocResolvedLocalHost2
sub _1_3_6_1_4_1_1556_17_0_7703
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "M3UA ASP Association Local IP Address 2 hostname is resolved\nTrapName = ptM3UAASPAssociationM3UAASPAssocResolvedLocalHost2,\n";
    
    my $dat_notification_id = 1638;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkOscillationFilterClear
sub _1_3_6_1_4_1_1556_17_0_8171
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that Link Oscillation Filter Timer T32 has expired\nTrapName = ptATMLinkAtmL3LinkOscillationFilterClear,\n";
    
    my $dat_notification_id = 1639;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCRoutingTablesDSCRoutingLoopClear
sub _1_3_6_1_4_1_1556_17_0_1810
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC clears routing looping alarm after table record modification. The alarm should only be cleared when the customer modify the  followings to remove the loop routing lookup. These include 1. Modificiation to nextTable/modTable attributes of the AVPRoutingRecord/ApplicationID/CommandCode/IncomingADN routing records. 2. Delete an AVPRoutingRecord/ApplicationID/CommandCode/ IncomingADN/ModificationTable routing record. 3. Modification to the Command attribute of the ModificationTable. The alarm will be re-raised if the routing loop is not fixed properly\nTrapName = ptDSCRoutingTablesDSCRoutingLoopClear,\n";
    
    my $dat_notification_id = 1640;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NADiscardMsuToL2Set
sub _1_3_6_1_4_1_1556_17_0_9952
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MSU destined to SS7/IP network has been discarded within the last 30 seconds.\nTrapName = ptMTP3NADiscardMsuToL2Set,\n";
    
    my $dat_notification_id = 1641;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMTP3NAsDiscardMsuFromPeerSet
sub _1_3_6_1_4_1_1556_17_0_7386
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MSU has been unexpectedly discarded between peers on MTP3 NA Connection in the last 5-minute interval.\nTrapName = ptMTP3NAMTP3NAsDiscardMsuFromPeerSet,\n";
    
    my $dat_notification_id = 1642;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"})) {
        $dat_additional_text .= "\nptSGMTP3NANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMTP3NAsMsuDiscardSet
sub _1_3_6_1_4_1_1556_17_0_7370
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MSU has been unexpectedly discarded on MTP3 NA Connection in the last 5-minute interval.\nTrapName = ptMTP3NAMTP3NAsMsuDiscardSet,\n";
    
    my $dat_notification_id = 1643;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"})) {
        $dat_additional_text .= "\nptSGMTP3NANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRootDiskPartitionThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_5507
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that root disk partition usage has reached its alarm threshold\nTrapName = ptRootDiskPartitionThresholdExceeded,\n";
    
    my $dat_notification_id = 1644;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCAnswerMessageHitResultOrErrorTableClear
sub _1_3_6_1_4_1_1556_17_0_1873
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An answer message did not hit a result or dsc_error table in the last 5 minutes.\nTrapName = ptDSCAnswerMessageHitResultOrErrorTableClear,\n";
    
    my $dat_notification_id = 1645;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.1"})) {
        $dat_additional_text .= "\nptDSCDSCDSCName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.2"})) {
        $dat_additional_text .= "\nptDSCDSCDSCInstanceID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesDSCDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_1869
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Debug levels are set to their recommended values.\nTrapName = ptDSCNodesDSCDebugLevelRecommended,\n";
    
    my $dat_notification_id = 1646;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetSs7LinksetLongMsuDiscard
sub _1_3_6_1_4_1_1556_17_0_8152
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a long MSU message has been received and was discarded in an attempt to route on a linkset that does not support Long MSU messages. This is a stateless trap (no alarm). Cause - Possible causes include incorrect setting of the  Long MSU Support option for the linkset. Also adjacent node, application or user part could  be sending long MSUs without the correct network configuration. Action - Check that the provisioning is correct. Freq - this trap will occur up to the maximum number of times N in the  interval time M where N and M are defined for the host MTP3 NA. ptOriginatingOID:    DYNAMIC ptLinkset ptTrapType:          2 communicationAlarm  ptTrapSeverity:      3 minor  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmoic\nTrapName = ptLinksetSs7LinksetLongMsuDiscard,\n";
    
    my $dat_notification_id = 1647;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesDSCLicenseUnavailable
sub _1_3_6_1_4_1_1556_17_0_1803
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The license server may not be running or may not have valid license keys.  The DSC feature cannot be started.\nTrapName = ptDSCNodesDSCLicenseUnavailable,\n";
    
    my $dat_notification_id = 1648;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotMTUSizeNotAsConfigured
sub _1_3_6_1_4_1_1556_17_0_3170
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "MTU Size for one (or more) interfaces is currently not as configured. Cause: MTU size of interface does not match the configured value. Possible Actions - Ensure MTU size for the physical interface is greater than or equal to all associated VLAN interfaces. VLAN interfaces may not have an MTU size  larger than the physical interface to which it is tied.  Care should be taken  when adjusting MTU size, as raising the MTU size could cause packets to be  discarded in the network.\nTrapName = ptSlotSlotMTUSizeNotAsConfigured,\n";
    
    my $dat_notification_id = 1649;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCapacityParameterSetDSCCapDiscardConfigured
sub _1_3_6_1_4_1_1556_17_0_1843
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC capacity parameter set is configured to discard messages when handling an overload. This is highly discouraged.\nTrapName = ptCapacityParameterSetDSCCapDiscardConfigured,\n";
    
    my $dat_notification_id = 1650;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1822.1.1.1"})) {
        $dat_additional_text .= "\nptDSCCapacityParameterSetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1822.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSFGUASFGUAMsuDiscardSet
sub _1_3_6_1_4_1_1556_17_0_7380
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MSU destined to SFG UA has been unexpectedly discarded in the last 5-minute interval.\nTrapName = ptSFGUASFGUAMsuDiscardSet,\n";
    
    my $dat_notification_id = 1651;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCpuLoadCleared
sub _1_3_6_1_4_1_1556_17_0_5502
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the CPU load has returned below its alarm threshold\nTrapName = ptCpuLoadCleared,\n";
    
    my $dat_notification_id = 1652;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.2021.10.1.3"})) {
        $dat_additional_text .= "\nlaLoad = " . $entrada->{"1.3.6.1.4.1.2021.10.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkDeactivated
sub _1_3_6_1_4_1_1556_17_0_7173
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been deactivated. Causes ,Corrective actions and Frequency:   1) ptSpecificTrapCause = operatorDeactivation  Cause  - Operator deactivates link. Action - Operator can activate the link again. Freq   - Operator dependant.  2) ptSpecificTrapCause = timerT17Expiry Cause  - Event appears between each attempt to perform an initial  alignment procedure. After an unsuccessful attempt, a delay T17 expires before the next attempt is initiated. Action - Operator can activate the link.   Freq   - T19 expiry , T19 can take a value between 800 - 1500 ms 3) ptSpecificTrapCause = unknownCause References 1) Table 1 Q.752, SL Failure 2) Q.704 (07/96) Section 12.2  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 29 Loss of signal    ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkDeactivated,\n";
    
    my $dat_notification_id = 1653;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDiscreteSensorPsFaultAssert
sub _1_3_6_1_4_1_1556_17_0_6326
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A discrete sensor power supply fault alarm was asserted Cause  - A discrete sensor detects a power supply fault condition Action - Verify sensor Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptDiscreteSensorPsFaultAssert,\n";
    
    my $dat_notification_id = 1654;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotMonitorSlotBondingARPMonitorFault
sub _1_3_6_1_4_1_1556_17_0_6266
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Bonding driver link monitoring has detected an ARP failure.  One or more of the Ethernet devices may have failed. Cause  - Link monitoring has lost communication with the far end. Action - Verify Ethernet connections of the bonded network interface. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4  equipment alarm - ptTrapSeverity:      2  major - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptSlotMonitorSlotBondingARPMonitorFault,\n";
    
    my $dat_notification_id = 1655;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"})) {
        $dat_additional_text .= "\nptSlotMonitorHostname = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANodeL4LostAppConnection
sub _1_3_6_1_4_1_1556_17_0_8161
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Lost some L4 application connection. This is a stateless trap (no alarm).\nTrapName = ptMTP3NANodeL4LostAppConnection,\n";
    
    my $dat_notification_id = 1656;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"})) {
        $dat_additional_text .= "\nptMTPMTP3NALocalPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAConfiguredASPM3UAConfiguredASPDown
sub _1_3_6_1_4_1_1556_17_0_7302
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a Configured ASP is down.   Cause: No ASP has connected to this ID and sent an ASPUP notification. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm  ptTrapSeverity: 3 minor ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType: 1 fmic\nTrapName = ptM3UAConfiguredASPM3UAConfiguredASPDown,\n";
    
    my $dat_notification_id = 1657;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkLocalUninhibited
sub _1_3_6_1_4_1_1556_17_0_7106
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been uninhibited at the  local node by operator. References 1) Table 2 Q.752, End of local inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 43 Resource at or near capacity ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L3LinkLocalUninhibited,\n";
    
    my $dat_notification_id = 1658;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptL4ConverterL4cvtrProcessShutdown
sub _1_3_6_1_4_1_1556_17_0_4102
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates the L4Cvtr process is shutting down.   Sent every time L4Cvtr is terminated (intentionally or not). System based termination include: - LDL Configuration error - Process received a terminating signal (SIGINT, SIGTERM).\nTrapName = ptL4ConverterL4cvtrProcessShutdown,\n";
    
    my $dat_notification_id = 1659;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotMonitorSlotLicenseServerConnectivityEstablished
sub _1_3_6_1_4_1_1556_17_0_3161
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "System re-established connection to the license server.\nTrapName = ptSlotMonitorSlotLicenseServerConnectivityEstablished,\n";
    
    my $dat_notification_id = 1660;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"})) {
        $dat_additional_text .= "\nptSlotMonitorHostname = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3RegistrationNPGWMTP3AppIDSuccess
sub _1_3_6_1_4_1_1556_17_0_1616
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The MTP3 AppID registration was successful on all the defined MTP3 connections.\nTrapName = ptMTP3RegistrationNPGWMTP3AppIDSuccess,\n";
    
    my $dat_notification_id = 1661;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1605.1606.1.1.3"})) {
        $dat_additional_text .= "\nptnpgwMTP3RegistrationStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1605.1606.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1605.1606.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwMTP3RegistrationNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1605.1606.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1605.1606.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwMTP3RegistrationApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1605.1606.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptEventAlarmAckStateUpdate
sub _1_3_6_1_4_1_1556_17_0_6665
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the event object has changed state.\nTrapName = ptEventAlarmAckStateUpdate,\n";
    
    my $dat_notification_id = 1662;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.981.982.1.1.4"})) {
        $dat_additional_text .= "\nptLIBEVEventEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.981.982.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.981.982.1.1.6"})) {
        $dat_additional_text .= "\nptLIBEVEventInstanceId = " . $entrada->{"1.3.6.1.4.1.1556.17.15.981.982.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.981.982.1.1.16"})) {
        $dat_additional_text .= "\nptLIBEVEventAckBy = " . $entrada->{"1.3.6.1.4.1.1556.17.15.981.982.1.1.16"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkUsageAlarmSet
sub _1_3_6_1_4_1_1556_17_0_7164
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 8.2.0. This trap indicates that the average traffic over this link exceeds  predefined threshold. There is potential for traffic loss if this  condition persists References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 51 Threshold crossed  ptTrapClearType:     2 oic\nTrapName = ptATMLinkAtmL3LinkUsageAlarmSet,\n";
    
    my $dat_notification_id = 1663;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANoActiveRSSet
sub _1_3_6_1_4_1_1556_17_0_8197
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MSU destined to an undefined or inactive routeset has been discarded  within the last 5 minutes. Check the debuglog for paced logging of the discarded MSU(s) information which will include routing label breakdown. The issue may be resolved by updating the Gateway Screening if the destination is unexpected or by adding and activating a routeset for the associated DPC.\nTrapName = ptMTP3NANoActiveRSSet,\n";
    
    my $dat_notification_id = 1664;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkFailCraftRefTimerExpiry
sub _1_3_6_1_4_1_1556_17_0_7123
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the fail link craft referral timer expired without having signaling link activated. The fail link craft referral timer is the duration allowed for a signaling link to come into service. After expiry of this timer, this alarm is generated as per the system configuration. This is a stateless trap (no alarm). References 1) GR246 Core, section 12.2.1, 12.3.1, 12.3.2 2) GR-82-CORE, CR6-43 [673] ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 29 Loss of signal  ptTrapClearType:     2 oic\nTrapName = ptLSLinkSs7L3LinkFailCraftRefTimerExpiry,\n";
    
    my $dat_notification_id = 1665;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGR310ServerConfigurationGR310ServerUp
sub _1_3_6_1_4_1_1556_17_0_1508
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The GR310 server is up.\nTrapName = ptGR310ServerConfigurationGR310ServerUp,\n";
    
    my $dat_notification_id = 1666;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1506.1.1.1"})) {
        $dat_additional_text .= "\nptsnamiGR310ServerConfigurationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1506.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRateLimiterDSCRlSevereCongestionDiscard
sub _1_3_6_1_4_1_1556_17_0_1856
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC RateLimiter discarded an answer message due to severe congestion.\nTrapName = ptRateLimiterDSCRlSevereCongestionDiscard,\n";
    
    my $dat_notification_id = 1667;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.1"})) {
        $dat_additional_text .= "\nptDSCRateLimiterName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.2"})) {
        $dat_additional_text .= "\nptDSCRateLimiterCapacityParameterSet = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptExternalPortSwitchPortDown
sub _1_3_6_1_4_1_1556_17_0_6282
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A switch external port is down. Cause  - External port non responsive. Action - Check the cable connected to the port and the remote end of the cable. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4  equipment alarm - ptTrapSeverity:      1  critical - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptExternalPortSwitchPortDown,\n";
    
    my $dat_notification_id = 1668;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.2"})) {
        $dat_additional_text .= "\nptSWMExternalPortPortNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.1"})) {
        $dat_additional_text .= "\nptSWMExternalPortSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.3"})) {
        $dat_additional_text .= "\nptSWMExternalPortState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.5"})) {
        $dat_additional_text .= "\nptSWMExternalPortPortName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1184.1.1.5"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotMonitorSlotNTPServerDownCleared
sub _1_3_6_1_4_1_1556_17_0_3153
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The invalid NTP servers are removed from configuration or the down NTP servers are back to work. Cause  - The invalid NTP servers are removed from configuration or the down NTP servers are back to work. Action - None. Freq   - Irregular.\nTrapName = ptSlotMonitorSlotNTPServerDownCleared,\n";
    
    my $dat_notification_id = 1669;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"})) {
        $dat_additional_text .= "\nptSlotMonitorHostname = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAConfiguredASPSUAConfASPEndPtConflict
sub _1_3_6_1_4_1_1556_17_0_7604
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that two or more SUA Configured ASPs have conflicting SCTP endpoints. Cause - Same transport address defined for two or more SUA Configured ASPs. Possible Actions - Ensure that the detected SCTP endpoint conflicts are resolved.  A transport address can be defined for one and only one SUA Configured ASP. Freq - This trap occurs when a transport address is defined for two or more SUA Configured ASPs.\nTrapName = ptSUAConfiguredASPSUAConfASPEndPtConflict,\n";
    
    my $dat_notification_id = 1670;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCapacityParameterSetDSCCapDiscardConfiguredCleared
sub _1_3_6_1_4_1_1556_17_0_1844
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC Capacity Parameter Set is no longer configured to discard messages.\nTrapName = ptCapacityParameterSetDSCCapDiscardConfiguredCleared,\n";
    
    my $dat_notification_id = 1671;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1822.1.1.1"})) {
        $dat_additional_text .= "\nptDSCCapacityParameterSetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1822.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAConfiguredASPM3UAConfASPEndPtConflict
sub _1_3_6_1_4_1_1556_17_0_7504
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that two or more M3UA Configured ASPs have conflicting SCTP endpoints. Cause - Same transport address defined for two or more M3UA Configured ASPs. Possible Actions - Ensure that the detected SCTP endpoint conflicts are resolved.  A transport address can be defined for one and only one M3UA Configured ASP. Freq - This trap occurs when a transport address is defined for two or more M3UA Configured ASPs.\nTrapName = ptM3UAConfiguredASPM3UAConfASPEndPtConflict,\n";
    
    my $dat_notification_id = 1672;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkLocalInhibited
sub _1_3_6_1_4_1_1556_17_0_7105
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been inhibited  by operator at the local node. Cause  - Operator inhibits the link. Action - Operator can uninhibit the link. Freq   - Operator dependant.  References 1) Table 2 Q.752, Start of local inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 43 Resource at or near capacity    ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L3LinkLocalInhibited,\n";
    
    my $dat_notification_id = 1673;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAASPSuaUserAssocPathEstablished
sub _1_3_6_1_4_1_1556_17_0_7273
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A path is up on a multi-homed user connection\nTrapName = ptSUAASPSuaUserAssocPathEstablished,\n";
    
    my $dat_notification_id = 1674;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"})) {
        $dat_additional_text .= "\nptSGSUAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCPeerSyncTimeout
sub _1_3_6_1_4_1_1556_17_0_1866
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Peersync is taking longer than expected. Restart the peers having trouble syncing to rectify the situation.\nTrapName = ptDSCPeerSyncTimeout,\n";
    
    my $dat_notification_id = 1675;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.1"})) {
        $dat_additional_text .= "\nptDSCDSCDSCName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.2"})) {
        $dat_additional_text .= "\nptDSCDSCDSCInstanceID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASccpNADiscardMSUMTP3
sub _1_3_6_1_4_1_1556_17_0_4214
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An unexpected MSU was discarded by a SCCP MTP3 NA  in the past 5 minutes.\nTrapName = ptSCCPNASccpNADiscardMSUMTP3,\n";
    
    my $dat_notification_id = 1676;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"})) {
        $dat_additional_text .= "\nptSCCPSCCPNAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAConfiguredASPM3UAConfASPResolvedHost1
sub _1_3_6_1_4_1_1556_17_0_7501
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "M3UA Configured ASP IP Address 1 hostname is resolved\nTrapName = ptM3UAConfiguredASPM3UAConfASPResolvedHost1,\n";
    
    my $dat_notification_id = 1677;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexFileSystemError
sub _1_3_6_1_4_1_1556_17_0_2026
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications file system sync error.\nTrapName = ptSS7DBAppsConfigurationSigFlexFileSystemError,\n";
    
    my $dat_notification_id = 1678;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCICUAAppServerFailedEstablishCicServer
sub _1_3_6_1_4_1_1556_17_0_7202
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Failed to establish CIC UA TCP Server.\nTrapName = ptCICUAAppServerFailedEstablishCicServer,\n";
    
    my $dat_notification_id = 1679;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.5"})) {
        $dat_additional_text .= "\nptSGCICUAAppServerStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.2"})) {
        $dat_additional_text .= "\nptSGCICUAAppServerDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesDSCLocalOverloadDiscard
sub _1_3_6_1_4_1_1556_17_0_1858
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC Node discarded a message due to configured local overload handling.\nTrapName = ptDSCNodesDSCLocalOverloadDiscard,\n";
    
    my $dat_notification_id = 1680;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkRemoteInhibited
sub _1_3_6_1_4_1_1556_17_0_8107
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA signaling link has been inhibited at a  remote node. Cause  - Operator has inhibited remote end of the link. Action - Link is inhibited until the operator uninhibits the  remote end of the link. Freq   - Operator dependant.  References 1) Table 2 Q.752, Start of remote inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm  ptTrapSeverity:      4 warning ptTrapProbableCause: 43 Resource at or near capacity   ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paL3LinkRemoteInhibited,\n";
    
    my $dat_notification_id = 1681;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSysMgrDiskFullClear
sub _1_3_6_1_4_1_1556_17_0_2006
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Disk is no longer full on SS7 DB Applications CPU\nTrapName = ptSS7DBAppsConfigurationSysMgrDiskFullClear,\n";
    
    my $dat_notification_id = 1682;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkInhibitDenied
sub _1_3_6_1_4_1_1556_17_0_7179
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an attempt to inhibit a signaling link  has failed. This is a stateless trap (no alarm). Causes ,Corrective actions and Frequency:  1) ptSpecificTrapCause = DPC not available  Cause  - This trap occurs when a request to inhibit a link will result in a destination becoming inaccessible and therefore the request is denied. Action - Operator will have to create another link  to access the destination before attempting to inhibit this  one. Freq   - Depends on how many destinations have single links and how often management wants to inhibit them.  2) ptSpecificTrapCause = Negative ACK from remote end Cause  - This trap occurs when a request to inhibit the link at the  remote end of a link results in a destination becoming  inaccessible.  Action - Operator will have to wait until another link is available to the destination before inhibiting this one.   Freq   - Depends on how many destinations have single links and how often management wants to inhibit them.  3) ptSpecificTrapCause = UnknownCause  References 1) Q.704 , (07/96) Section 10.2        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm  ptTrapSeverity:      4 warning ptTrapProbableCause: 56 Underlying resource unavailable  ptTrapClearType:     2 oic\nTrapName = ptAnnexALinkAnnexaL3LinkInhibitDenied,\n";
    
    my $dat_notification_id = 1683;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptNPGWConfigurationNPGWDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_1636
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All debug attributes are set to their recommended values.\nTrapName = ptNPGWConfigurationNPGWDebugLevelRecommended,\n";
    
    my $dat_notification_id = 1684;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRegisteredUPUserPartLongMsuDiscard
sub _1_3_6_1_4_1_1556_17_0_8160
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a long MSU message has been received and was discarded in an attempt to route on a user part that does not support long MSUs. ptOriginatingOID:    DYNAMIC ptLinkset ptTrapType:          2 communicationAlarm  ptTrapSeverity:      3 Minor  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptRegisteredUPUserPartLongMsuDiscard,\n";
    
    my $dat_notification_id = 1685;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.66.59.60.1.1.1"})) {
        $dat_additional_text .= "\nptMTPRegisteredUPContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.66.59.60.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.66.59.60.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRegisteredUPSI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.66.59.60.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.66.59.60.1.1.3"})) {
        $dat_additional_text .= "\nptMTPRegisteredUPPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.66.59.60.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASccpNADebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_4210
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptSCCPNASccpNADebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1686;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkAlarmsEnabled
sub _1_3_6_1_4_1_1556_17_0_8141
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "ATM Link alarms  are enabled.\nTrapName = ptATMLinkAtmL3LinkAlarmsEnabled,\n";
    
    my $dat_notification_id = 1687;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptProcessEventFileWriteSuccess
sub _1_3_6_1_4_1_1556_17_0_8303
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the peer no longer has a write failure.\nTrapName = ptProcessEventFileWriteSuccess,\n";
    
    my $dat_notification_id = 1688;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"})) {
        $dat_additional_text .= "\nptpeereventProcessEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"})) {
        $dat_additional_text .= "\nptpeereventProcessEventSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptTransportServerServerAvailable
sub _1_3_6_1_4_1_1556_17_0_1808
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC has setup the server on the given host and port.\nTrapName = ptTransportServerServerAvailable,\n";
    
    my $dat_notification_id = 1689;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.1"})) {
        $dat_additional_text .= "\nptDSCTransportServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.6"})) {
        $dat_additional_text .= "\nptDSCTransportServerHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.5"})) {
        $dat_additional_text .= "\nptDSCTransportServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.5"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGWSTGwstPeerUp
sub _1_3_6_1_4_1_1556_17_0_4003
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates a GWST peer is reachable. Sent when a GWST peer communication is established via LDL.\nTrapName = ptGWSTGwstPeerUp,\n";
    
    my $dat_notification_id = 1690;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAConfiguredASPSUAConfASPUnresolvedHost1
sub _1_3_6_1_4_1_1556_17_0_7600
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that SUA Configured ASP IP Address 1 hostname is not resolvable. Cause - The SG is unable to resolve the hostname. Possible Actions - If the DSC has been set up to use a DNS server,  ensure the DNS server is reachable and confirm that the hostname has been configured. If the hostname is intended to resolve locally, ensure the proper hostname entry  has been added using IP Networking > Hostname Resolution. Freq - This trap occurs when the configured hostname becomes unresolvable.\nTrapName = ptSUAConfiguredASPSUAConfASPUnresolvedHost1,\n";
    
    my $dat_notification_id = 1691;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCAnswerMessageHitResultOrErrorTable
sub _1_3_6_1_4_1_1556_17_0_1872
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An answer message hit a result or dsc_error table. Cause - The DSC explicit routing is possibly misconfigured and an answer message hits a result or dsc_error table.  Possible Actions -  Search the debug log for a warning entry indicating that an answer message hit a result or  dsc_error table. Note down the following information after the warning log entry: DSC instance, DSC Node name, Request Incoming ADN Name, Answer Incoming ADN Name,  Initial Routing Table Name, and Outgoing Answer Routing Table, and the message content in HEX. Note that the message content must be cleaned up as copied from the debug log.  Using the DSC Search Utility of the DSC instance reporting the alarm and log, upload the message and fill in the required information based on the information collected from the debug log. Perform a search and inspect the DSC Table Records the message goes through before hitting the result or error table. Change the configuration so that the answer message is properly routed and does not hit a result or error table. If the results of the Search do not output any DSC Table Records, use the Outgoing Answer Routing Table as the Initial Routing Table Name of the DSC Search Utility and perform a search again. If you still do not get any DSC Table Records, use the Outgoing Answer Routing Table as your starting point and trace the message flow through the routing tables until you find a record that puts the answer message through a result or dsc_error table. Note that some answer messages may be generated by the DSC ( errors for example ) and might not have an Answer Incoming ADN Name value. For this particular case, the Outgoing Answer  Routing Table of the Request Incoming ADN Name is routing the answer message through a  result or error routing table.\nTrapName = ptDSCAnswerMessageHitResultOrErrorTable,\n";
    
    my $dat_notification_id = 1692;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.2"})) {
        $dat_additional_text .= "\nptDSCDSCDSCInstanceID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.1"})) {
        $dat_additional_text .= "\nptDSCDSCDSCName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3UAASPAssocEndPtConflictResolved
sub _1_3_6_1_4_1_1556_17_0_7709
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "IP Conflicts with existing M3UA ASP Associations or M3UA/SUA SCTP Servers resolved\nTrapName = ptM3UAASPAssociationM3UAASPAssocEndPtConflictResolved,\n";
    
    my $dat_notification_id = 1693;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkActivated
sub _1_3_6_1_4_1_1556_17_0_7104
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been activated either by the operator or as a result of a successful restoration  which was initiated upon detection of an inactive link. This trap could also be generated at restart without a previous corresponding trap 201. References 1)  Q.752, SL Restoration 2)  Q.704, (07/96) Section 12.2 ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 29 Loss of signal  ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L3LinkActivated,\n";
    
    my $dat_notification_id = 1694;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL2LinkUncongested
sub _1_3_6_1_4_1_1556_17_0_7190
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is no longer congested. Causes and Frequency   1) ptSpecificTrapCause = managementInitiated  Cause  - Protocol Manager detects the condition 2) ptSpecificTrapCause = linkUncongested  Cause  - Trap occurs when the number of MSUs in the transmission or re-transmission buffer goes from a value in excess of the thresholds for congestion to a value which is less  than the thresholds.    Freq   - Dependant on throughput of MSUs . References 1) Q.704 , Section 3.8.2  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 49 Storage capacity problem ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL2LinkUncongested,\n";
    
    my $dat_notification_id = 1695;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPPCSSNRegistrationINAPGWSCCPPCSSNFailure
sub _1_3_6_1_4_1_1556_17_0_1307
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP PC-SSN registration was not successful on all the defined SCCP connections.\nTrapName = ptSCCPPCSSNRegistrationINAPGWSCCPPCSSNFailure,\n";
    
    my $dat_notification_id = 1696;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.3"})) {
        $dat_additional_text .= "\nptinapgwSCCPPCSSNRegistrationSSN = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.1"})) {
        $dat_additional_text .= "\nptinapgwSCCPPCSSNRegistrationNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.4"})) {
        $dat_additional_text .= "\nptinapgwSCCPPCSSNRegistrationStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.2"})) {
        $dat_additional_text .= "\nptinapgwSCCPPCSSNRegistrationPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1305.1306.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAppIDRegistrationAppIDRegistrationError
sub _1_3_6_1_4_1_1556_17_0_4413
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the AppID registration is not successful.\nTrapName = ptAppIDRegistrationAppIDRegistrationError,\n";
    
    my $dat_notification_id = 1697;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.653.654.674.1.1.1"})) {
        $dat_additional_text .= "\nptGTTAppIDRegistrationApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.653.654.674.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPAppIDRegistrationNPGWSCCPAppIDFailure
sub _1_3_6_1_4_1_1556_17_0_1609
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP AppID registration was not successful on all the defined SCCP connections.\nTrapName = ptSCCPAppIDRegistrationNPGWSCCPAppIDFailure,\n";
    
    my $dat_notification_id = 1698;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1610.1612.1.1.3"})) {
        $dat_additional_text .= "\nptnpgwSCCPAppIDRegistrationStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1610.1612.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1610.1612.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwSCCPAppIDRegistrationApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1610.1612.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1610.1612.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwSCCPAppIDRegistrationNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1610.1612.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIWFDiameterIWFDiameterAnswerNoMatch
sub _1_3_6_1_4_1_1556_17_0_1915
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The IWF received a Diameter answer with no match in the last 5 minutes.\nTrapName = ptIWFDiameterIWFDiameterAnswerNoMatch,\n";
    
    my $dat_notification_id = 1699;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.5"})) {
        $dat_additional_text .= "\nptiwfIWFDiameterDSCIWFUAPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.1"})) {
        $dat_additional_text .= "\nptiwfIWFDiameterIWFDiameterID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.7"})) {
        $dat_additional_text .= "\nptiwfIWFDiameterConnectivityStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotDatabaseClusterFunction
sub _1_3_6_1_4_1_1556_17_0_3157
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The database cluster is functioning as expected. Cause  - None. Action - None. Freq   - Irregular.\nTrapName = ptSlotDatabaseClusterFunction,\n";
    
    my $dat_notification_id = 1700;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUASCTPServerSUASCTPServerUnresolvedHost2
sub _1_3_6_1_4_1_1556_17_0_7360
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that SUA SCTP Server IP Address 2 hostname is not resolvable.  Cause - The SG is unable to resolve the hostname. Possible Actions - If the DSC has been set up to use a DNS server,  ensure the DNS server is reachable and confirm that the hostname has been configured. If the hostname is intended to resolve locally, ensure the proper hostname entry  has been added using IP Networking > Hostname Resolution. Freq - This trap occurs when the configured hostname becomes unresolvable.\nTrapName = ptSUASCTPServerSUASCTPServerUnresolvedHost2,\n";
    
    my $dat_notification_id = 1701;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptNPGWConfigurationNPGWSCCPDown
sub _1_3_6_1_4_1_1556_17_0_1601
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW traffic is deactivated or all SCCP NAs are not connected.\nTrapName = ptNPGWConfigurationNPGWSCCPDown,\n";
    
    my $dat_notification_id = 1702;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1601.1.1.4"})) {
        $dat_additional_text .= "\nptnpgwNPGWConfigurationSCCPTrafficStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1601.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaSLSLinkAuditFailureClear
sub _1_3_6_1_4_1_1556_17_0_9992
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an SLS Table Link Audit has concluded and this link is no longer included incorrectly in SLS Tables. The link may have been removed from SLS Tables, or its state may have changed so it is now appropriate for use in SLS Tables. Clears annexaSLSLinkAuditFailure. References None. This is an implementation specific audit. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptAnnexALinkAnnexaSLSLinkAuditFailureClear,\n";
    
    my $dat_notification_id = 1703;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptFreeMemTresholdCleared
sub _1_3_6_1_4_1_1556_17_0_5504
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the memory usage has returned below its alarm threshold\nTrapName = ptFreeMemTresholdCleared,\n";
    
    my $dat_notification_id = 1704;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.2021.4.11"})) {
        $dat_additional_text .= "\nmemTotalFree = " . $entrada->{"1.3.6.1.4.1.2021.4.11"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotUSBDeviceInserted
sub _1_3_6_1_4_1_1556_17_0_3154
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A USB device has been connected to the card in the specified slot.  Ensure that all devices are removed unless needed. Cause  - USB device attached to faceplate connector. Action - Ensure that all devices are removed unless needed. Freq   - Irregular.\nTrapName = ptSlotSlotUSBDeviceInserted,\n";
    
    my $dat_notification_id = 1705;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkRemoteUninhibited
sub _1_3_6_1_4_1_1556_17_0_7108
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been uninhibited  at the remote end of a link. This can be requested by the operator or by signaling routing control function . Signaling routing  control will initiate signaling link uninhibit if an inhibited  link is found to be a member of a linkset in a route to a destination which has become inaccessible.  References 1) Table 2 Q.752, End of remote inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 43 Resource at or near capacity   ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L3LinkRemoteUninhibited,\n";
    
    my $dat_notification_id = 1706;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRouteRouteAlarmsDisabled
sub _1_3_6_1_4_1_1556_17_0_7165
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Route alarms are disabled.\nTrapName = ptRouteRouteAlarmsDisabled,\n";
    
    my $dat_notification_id = 1707;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.5"})) {
        $dat_additional_text .= "\nptMTPRouteState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.2"})) {
        $dat_additional_text .= "\nptMTPRouteAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRouteCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.6"})) {
        $dat_additional_text .= "\nptMTPRouteLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.6"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDiameterConnectionIWFDiameterConnectionDown
sub _1_3_6_1_4_1_1556_17_0_1903
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The IWF traffic is deactivated or the Diameter Connection is not connected. The DSC associated Transport Server for the IWF port must be active and UP on this slot.\nTrapName = ptDiameterConnectionIWFDiameterConnectionDown,\n";
    
    my $dat_notification_id = 1708;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1903.1904.1.1.1"})) {
        $dat_additional_text .= "\nptiwfDiameterConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1903.1904.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1903.1904.1.1.2"})) {
        $dat_additional_text .= "\nptiwfDiameterConnectionConnectivityStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1903.1904.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUASCTPServerSUASCTPServerAddrListMismatch
sub _1_3_6_1_4_1_1556_17_0_7364
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that SUA SCTP Server is not listening on all configured addresses. Cause - The SUA SCTP Server is configured to listen on an address but binding to that address/port failed. Possible Actions - Determine if another application is using the  desired address/port, which is preventing the server from binding to the address.  This can be done using IP Networking > IP Utilities > Open Sockets. Determine if the IP addresses are actually valid for the slot that the server is listening on.  Use Network Interaces > View Network Interfaces for the corresponding slot to see if the address is configured for one of the interfaces. If you are using hostnames, you will first need to check which addresses the hostname resolves to using IP Networking > Hostname Resolution (if using DNS you will need to check the DNS Server configuration). If using hostnames, it is possible that each address was not resolvable at startup.  If there are no hostname resolution alarms present for the SUA SCTP Server, it is possible that deactivating and reactivating the server will correct the issue.  Freq - This trap occurs only when the addresses the server is listening on do not match the addresses configured.\nTrapName = ptSUASCTPServerSUASCTPServerAddrListMismatch,\n";
    
    my $dat_notification_id = 1709;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIWFSS7IWFSS7Down
sub _1_3_6_1_4_1_1556_17_0_1907
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The IWF traffic is deactivated or all SCCP Connections are not connected. The SCCP associated NA must be active and available.\nTrapName = ptIWFSS7IWFSS7Down,\n";
    
    my $dat_notification_id = 1710;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.7"})) {
        $dat_additional_text .= "\nptiwfIWFSS7ConnectivityStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.1"})) {
        $dat_additional_text .= "\nptiwfIWFSS7SCCPNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationNsmConnDown
sub _1_3_6_1_4_1_1556_17_0_2011
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Connectivity to the NSM has been lost.\nTrapName = ptSS7DBAppsConfigurationNsmConnDown,\n";
    
    my $dat_notification_id = 1711;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paLinkUncongested
sub _1_3_6_1_4_1_1556_17_0_8120
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA signaling link is no longer congested. Causes and Frequency   1) ptSpecificTrapCause = managementInitiated  Cause  - Protocol Manager detects the condition 2) ptSpecificTrapCause = linkUncongested  Cause  - Trap occurs when the number of MSUs in the transmission or re-transmission buffer goes from a value in excess of the thresholds for congestion to a value which is less  than the thresholds.    Freq   - Dependant on throughput of MSUs . References 1) Q.704 , Section 3.8.2  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 49 Storage capacity problem ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paLinkUncongested,\n";
    
    my $dat_notification_id = 1712;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPAppIDRegistrationIWFSCCPAppIDSuccess
sub _1_3_6_1_4_1_1556_17_0_1914
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP AppID Registration was successful on all the defined SCCP Connections.\nTrapName = ptSCCPAppIDRegistrationIWFSCCPAppIDSuccess,\n";
    
    my $dat_notification_id = 1713;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1910.1.1.1"})) {
        $dat_additional_text .= "\nptiwfSCCPAppIDRegistrationApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1910.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1910.1.1.2"})) {
        $dat_additional_text .= "\nptiwfSCCPAppIDRegistrationStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1910.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSNAMIConfigurationSNAMIAvailable
sub _1_3_6_1_4_1_1556_17_0_1506
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SNAMI is available.\nTrapName = ptSNAMIConfigurationSNAMIAvailable,\n";
    
    my $dat_notification_id = 1714;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptFreeMemThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_5503
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the memory usage has reached its alarm threshold\nTrapName = ptFreeMemThresholdExceeded,\n";
    
    my $dat_notification_id = 1715;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.2021.4.11"})) {
        $dat_additional_text .= "\nmemTotalFree = " . $entrada->{"1.3.6.1.4.1.2021.4.11"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUASCTPServersSuaLicClrMajor
sub _1_3_6_1_4_1_1556_17_0_7241
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Major SUA License Event has been cleared\nTrapName = ptSUASCTPServersSuaLicClrMajor,\n";
    
    my $dat_notification_id = 1716;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionDSCAdncRoutingDiscardCleared
sub _1_3_6_1_4_1_1556_17_0_1848
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC ADN Connection has not discarded a message via routing table for 5 minutes.\nTrapName = ptADNConnectionDSCAdncRoutingDiscardCleared,\n";
    
    my $dat_notification_id = 1717;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.15"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.15"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIMFConfigurationIMFDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_8406
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All debug attributes are set to their recommended values.\nTrapName = ptIMFConfigurationIMFDebugLevelRecommended,\n";
    
    my $dat_notification_id = 1718;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASccpNADiscardMSUUnexpectedSIClear
sub _1_3_6_1_4_1_1556_17_0_4213
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SCCP has not received an MSU from MTP3 with an SI not equal to 3 which is unexpected in the past 5 minutes.\nTrapName = ptSCCPNASccpNADiscardMSUUnexpectedSIClear,\n";
    
    my $dat_notification_id = 1719;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"})) {
        $dat_additional_text .= "\nptSCCPSCCPNAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCpuCertificateRenewed
sub _1_3_6_1_4_1_1556_17_0_3165
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Expired certificate in this slot is now renewed.\nTrapName = ptSlotSlotCpuCertificateRenewed,\n";
    
    my $dat_notification_id = 1720;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"})) {
        $dat_additional_text .= "\nptSlotSecondaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"})) {
        $dat_additional_text .= "\nptSlotPrimaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASccpNADiscardMSUGTT
sub _1_3_6_1_4_1_1556_17_0_4218
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An unexpected MSU has been discarded by a SCCP GTT Connection  in the past 5 minutes.\nTrapName = ptSCCPNASccpNADiscardMSUGTT,\n";
    
    my $dat_notification_id = 1721;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"})) {
        $dat_additional_text .= "\nptSCCPSCCPNAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaMultiAssocDeactivated
sub _1_3_6_1_4_1_1556_17_0_7406
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An M3UA multi association has been deactivated by the user.  Possible uses are to block an ASP from connecting whilst performing  configuration maintenance.\nTrapName = ptM3UAASPAssociationM3uaMultiAssocDeactivated,\n";
    
    my $dat_notification_id = 1722;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAConnectionINAPGWSCCPNAConnectionDown
sub _1_3_6_1_4_1_1556_17_0_1305
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The INAPGW NA traffic is deactivated or the SCCP NA connection is not connected.\nTrapName = ptSCCPNAConnectionINAPGWSCCPNAConnectionDown,\n";
    
    my $dat_notification_id = 1723;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1304.1.1.1"})) {
        $dat_additional_text .= "\nptinapgwSCCPNAConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1304.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1304.1.1.2"})) {
        $dat_additional_text .= "\nptinapgwSCCPNAConnectionStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1304.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMSAMsaThreshold3Crossed
sub _1_3_6_1_4_1_1556_17_0_8202
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the MSA threshold 3 is crossed.\nTrapName = ptMSAMsaThreshold3Crossed,\n";
    
    my $dat_notification_id = 1724;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.961.962.1.1.1"})) {
        $dat_additional_text .= "\nptmsaMSAName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.961.962.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSysMgrDiskUsageUnder90Percent
sub _1_3_6_1_4_1_1556_17_0_2008
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Disk usage is no longer over 90% full on SS7 DB Applications CPU\nTrapName = ptSS7DBAppsConfigurationSysMgrDiskUsageUnder90Percent,\n";
    
    my $dat_notification_id = 1725;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionADNConnectionDown
sub _1_3_6_1_4_1_1556_17_0_1801
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The ADN Connection is down. Depending on the configuration, an outgoing connection has not been  established or the ADN has not attempted or established connectivity.\nTrapName = ptADNConnectionADNConnectionDown,\n";
    
    my $dat_notification_id = 1726;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L2LinkCongested
sub _1_3_6_1_4_1_1556_17_0_7119
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is congested. Causes and Corrective Action   1) ptSpecificTrapCause = managementInitiated  Cause  - Protocol manager detects the condition.   2) ptSpecificTrapCause = linkCongestion  Cause  - Trap occurs when the thresholds for the number of MSUs in the transmission or re-transmission buffer are exceeded.   Action - Wait until the MSUs are sent . References 1) Q.704 , Section 3.8.2  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 49 Storage capacity problem ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L2LinkCongested,\n";
    
    my $dat_notification_id = 1727;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIsmVarPartitionThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_5527
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the ISM /var partition usage has reached its alarm threshold\nTrapName = ptIsmVarPartitionThresholdExceeded,\n";
    
    my $dat_notification_id = 1728;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIMFPacketCaptureImfPacketCaptureActive
sub _1_3_6_1_4_1_1556_17_0_8402
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A packet capture is running on the processors and may impact overall capacity.\nTrapName = ptIMFPacketCaptureImfPacketCaptureActive,\n";
    
    my $dat_notification_id = 1729;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmSLSLinkAuditFailureClear
sub _1_3_6_1_4_1_1556_17_0_9990
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an SLS Table Link Audit has concluded and this link is no longer included incorrectly in SLS Tables. The link may have been removed from SLS Tables, or its state may have changed so it is now appropriate for use in SLS Tables. Clears atmSLSLinkAuditFailure. References None. This is an implementation specific audit. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptATMLinkAtmSLSLinkAuditFailureClear,\n";
    
    my $dat_notification_id = 1730;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationBulkInputCongRaised
sub _1_3_6_1_4_1_1556_17_0_2015
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "NP Database Bulk Input congestion detected on FLXMGR to DSS path\nTrapName = ptSS7DBAppsConfigurationBulkInputCongRaised,\n";
    
    my $dat_notification_id = 1731;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSysMgr5129ThrottlingOff
sub _1_3_6_1_4_1_1556_17_0_2010
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Throttling has abated for 5129 messages.\nTrapName = ptSS7DBAppsConfigurationSysMgr5129ThrottlingOff,\n";
    
    my $dat_notification_id = 1732;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkAlarmsDisabled
sub _1_3_6_1_4_1_1556_17_0_8146
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "M2PA Link alarms are disabled.\nTrapName = ptM2PALinkM2paL3LinkAlarmsDisabled,\n";
    
    my $dat_notification_id = 1733;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAConfiguredASPM3UAConfASPUnresolvedHost2
sub _1_3_6_1_4_1_1556_17_0_7502
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that M3UA Configured ASP IP Address 2 hostname is not resolvable. Cause - The SG is unable to resolve the hostname. Possible Actions - If the DSC has been set up to use a DNS server,  ensure the DNS server is reachable and confirm that the hostname has been configured. If the hostname is intended to resolve locally, ensure the proper hostname entry  has been added using IP Networking > Hostname Resolution. Freq - This trap occurs when the configured hostname becomes unresolvable.\nTrapName = ptM3UAConfiguredASPM3UAConfASPUnresolvedHost2,\n";
    
    my $dat_notification_id = 1734;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetCLinkLongMsuSupportFailureClear
sub _1_3_6_1_4_1_1556_17_0_8149
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that condition set by C-link linkset not supporting long MSUs and the MTP NA Maximum MSU Length option set above 273 bytes has been resolved.  Action:  None Freq - this trap occurs after a provisioning change has occurred to  address the conflict between the NA and the C-link linkset. ptOriginatingOID:    DYNAMIC ptLinkset ptTrapType:          2 communicationAlarm  ptTrapSeverity:      5 clear  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptLinksetCLinkLongMsuSupportFailureClear,\n";
    
    my $dat_notification_id = 1735;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLinksetState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDiscreteSensorCpuErrorAssert
sub _1_3_6_1_4_1_1556_17_0_6322
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A discrete sensor CPU error alarm was asserted Cause  - A discrete sensor detects a CPU error condition Action - Verify sensor Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptDiscreteSensorCpuErrorAssert,\n";
    
    my $dat_notification_id = 1736;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paLinkSCTPPathAvailable
sub _1_3_6_1_4_1_1556_17_0_8129
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the SCTP Association that carries M2PA Traffic is no longer operating with a path failure. Clears m2paLinkSCTPPathUnavailable. References This trap is implementation specific. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:  29 Loss of signal    ptTrapClearType:       1 fmic\nTrapName = ptM2PALinkM2paLinkSCTPPathAvailable,\n";
    
    my $dat_notification_id = 1737;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.6"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkAlarmsEnabled
sub _1_3_6_1_4_1_1556_17_0_8143
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Annex A Link alarms are enabled.\nTrapName = ptAnnexALinkAnnexaL3LinkAlarmsEnabled,\n";
    
    my $dat_notification_id = 1738;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPM3uaAssocPathLoss
sub _1_3_6_1_4_1_1556_17_0_7270
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A path is down on a multi-homed user connection\nTrapName = ptM3UAASPM3uaAssocPathLoss,\n";
    
    my $dat_notification_id = 1739;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkUsageHighClear
sub _1_3_6_1_4_1_1556_17_0_8135
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the average traffic over this link no longer exceeds predefined threshold. There is no longer potential for traffic loss due to extensive traffic. References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 51 Threshold crossed ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L3LinkUsageHighClear,\n";
    
    my $dat_notification_id = 1740;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetMtp3LinksetDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_8208
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that at least one MTP3 NA debug attribute has been changed to a non recommended value. Cause: A user has altered at least one NA debugging attribute to a non recommended value. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their recommended values.\nTrapName = ptLinksetMtp3LinksetDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1741;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesMsgRetryExceeded
sub _1_3_6_1_4_1_1556_17_0_1853
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A message has exceeded the maximum number of allowed retransmits allowd by the sending node\nTrapName = ptDSCNodesMsgRetryExceeded,\n";
    
    my $dat_notification_id = 1742;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptHSLATMChannelMpmtp2SAALChanActivated
sub _1_3_6_1_4_1_1556_17_0_5807
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An ATM Link has been manually deactivated.  This is done either directly on the link or at the link manager level. Cause  - ATM link has been deactivated. Action - Re-activate the link Freq   - By user interaction References - ptOriginatingOID:    DYNAMIC ptATMLink - ptTrapType:          11 quality of service - ptTrapSeverity:      3 major - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptHSLATMChannelMpmtp2SAALChanActivated,\n";
    
    my $dat_notification_id = 1743;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1084.1102.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWHSLATMChannelChannelNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1084.1102.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1084.1102.1.1.3"})) {
        $dat_additional_text .= "\nptIOHWHSLATMChannelPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1084.1102.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkAvailable
sub _1_3_6_1_4_1_1556_17_0_8182
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is available for user traffic. Clears annexaL3LinkUnavailable. References 1) GR310CORE Issue 3 Section 8.1 2) GR246CORE Issue 10 3) GR82CORE  Issue 10 4) Q.704 ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkAvailable,\n";
    
    my $dat_notification_id = 1744;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericLinkAligned
sub _1_3_6_1_4_1_1556_17_0_8435
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an generic signaling link has been aligned. Cause  - After a signaling link failure is detected, signaling link initial alignment will take place. The Alignment procedure passes through a number of states and when the procedure enters the state aligned this trap is sent. Freq   - Once the alignment procedure enters the aligned state then the alignment procedure will not be repeated. References 1) Q.703 , (07/96) Section 7.3 ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType:     1 fmic\nTrapName = ptGenericLinkGenericLinkAligned,\n";
    
    my $dat_notification_id = 1745;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.11"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL2State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.11"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPCRegistrationPcRegistrationSuccess
sub _1_3_6_1_4_1_1556_17_0_4412
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the PC registration is successful.\nTrapName = ptPCRegistrationPcRegistrationSuccess,\n";
    
    my $dat_notification_id = 1746;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.653.654.655.1.1.1"})) {
        $dat_additional_text .= "\nptGTTPCRegistrationPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.653.654.655.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptNPGWConfigurationNPGWDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_1635
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptNPGWConfigurationNPGWDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1747;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkDeactivated
sub _1_3_6_1_4_1_1556_17_0_7103
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been deactivated. Causes ,Corrective actions and Frequency:   1) ptSpecificTrapCause = operatorDeactivation  Cause  - Operator deactivates link. Action - Operator can activate the link again. Freq   - Operator dependant.  2) ptSpecificTrapCause = timerT17Expiry Cause  - Event appears between each attempt to perform an initial  alignment procedure. After an unsuccessful attempt, a delay T17 expires before the next attempt is initiated. Action - Operator can activate the link.   Freq   - T19 expiry , T19 can take a value between 800 - 1500 ms 3) ptSpecificTrapCause = unknownCause References 1) Table 1 Q.752, SL Failure 2) Q.704 (07/96) Section 12.2  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 29 Loss of signal    ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L3LinkDeactivated,\n";
    
    my $dat_notification_id = 1748;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAManagerMtp3DebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_8206
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: At least one debug attribute is not set to the recommended value. Possible Actions - The user should perform the 'Restore Debug Defaults' action to rest all debug attributes to their recommended values.\nTrapName = ptMTP3NAManagerMtp3DebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1749;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ucdShutdown
sub _1_3_6_1_4_1_2021_251_2
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap is sent when the agent terminates\nTrapName = ucdShutdown,\n";
    
    my $dat_notification_id = 1750;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTConfigurationGttLicenseError
sub _1_3_6_1_4_1_1556_17_0_4409
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that GTT process cannot a  license.\nTrapName = ptGTTConfigurationGttLicenseError,\n";
    
    my $dat_notification_id = 1751;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkRemoteUninhibited
sub _1_3_6_1_4_1_1556_17_0_8108
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA signaling link has been uninhibited  at the remote end of a link. This can be requested by the operator or by signaling routing control function . Signaling routing  control will initiate signaling link uninhibit if an inhibited  link is found to be a member of a link set in a route to a destination which has become inaccessible.  References 1) Table 2 Q.752, End of remote inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 43 Resource at or near capacity   ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paL3LinkRemoteUninhibited,\n";
    
    my $dat_notification_id = 1752;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGWSTConfigurationGR310ExcessiveMessagingClear
sub _1_3_6_1_4_1_1556_17_0_1006
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "No further autonomous messages have been discarded destined the active GR-310 server in the last 5 minutes\nTrapName = ptGWSTConfigurationGR310ExcessiveMessagingClear,\n";
    
    my $dat_notification_id = 1753;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkRemoteBlocked
sub _1_3_6_1_4_1_1556_17_0_7183
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been blocked at a remote node. Cause  - Signaling link is blocked at the remote node of the link by operator intervention or due to processor outage. Action - The link will be unblocked when the remote node of the  link becomes unblocked.  Freq   - Operator dependant. References 1) Table 2 Q.752 Start of Remote Processor Outage 2) Q.704 Section 3.3.5       ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        3 minor ptTrapProbableCause:   42 Remote node transmission error   ptTrapClearType:       1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkRemoteBlocked,\n";
    
    my $dat_notification_id = 1754;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAAppServerM3UAAppServerActive
sub _1_3_6_1_4_1_1556_17_0_7301
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an App Server is now active.   Cause: An ASP has activated the associated routing context (RC). ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm  ptTrapSeverity: 5 cleared  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType: 1 fmic\nTrapName = ptM3UAAppServerM3UAAppServerActive,\n";
    
    my $dat_notification_id = 1755;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerNetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerSI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerRoutingContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.9"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3NANotConnected
sub _1_3_6_1_4_1_1556_17_0_7230
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MTP3 NA not connected notification is sent when the connectivity between the Dinamo and MTP3 NA is lost.\nTrapName = ptMTP3NAMtp3NANotConnected,\n";
    
    my $dat_notification_id = 1756;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"})) {
        $dat_additional_text .= "\nptSGMTP3NANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPAppIDRegistrationIWFSCCPAppIDFailure
sub _1_3_6_1_4_1_1556_17_0_1913
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP AppID Registration was unsuccessful on all the defined SCCP Connections.\nTrapName = ptSCCPAppIDRegistrationIWFSCCPAppIDFailure,\n";
    
    my $dat_notification_id = 1757;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1910.1.1.1"})) {
        $dat_additional_text .= "\nptiwfSCCPAppIDRegistrationApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1910.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1910.1.1.2"})) {
        $dat_additional_text .= "\nptiwfSCCPAppIDRegistrationStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1910.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptThresholdSensorUpperCriticalAssert
sub _1_3_6_1_4_1_1556_17_0_6340
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A threshold sensor upper critical alarm was asserted Cause  - A threshold sensor detects an upper critical condition Action - Verify sensor Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptThresholdSensorUpperCriticalAssert,\n";
    
    my $dat_notification_id = 1758;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaMultiAssocConnEstablished
sub _1_3_6_1_4_1_1556_17_0_7405
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An ASP multi association established notification is sent when the connection between an ASP and SG is established.\nTrapName = ptM3UAASPAssociationM3uaMultiAssocConnEstablished,\n";
    
    my $dat_notification_id = 1759;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIWFDiameterIWFDiameterUp
sub _1_3_6_1_4_1_1556_17_0_1902
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one Diameter Connection is connected.\nTrapName = ptIWFDiameterIWFDiameterUp,\n";
    
    my $dat_notification_id = 1760;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.5"})) {
        $dat_additional_text .= "\nptiwfIWFDiameterDSCIWFUAPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.1"})) {
        $dat_additional_text .= "\nptiwfIWFDiameterIWFDiameterID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.7"})) {
        $dat_additional_text .= "\nptiwfIWFDiameterConnectivityStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetSs7LinksetAlarmsEnabled
sub _1_3_6_1_4_1_1556_17_0_7168
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Linkset alarms are enabled.\nTrapName = ptLinksetSs7LinksetAlarmsEnabled,\n";
    
    my $dat_notification_id = 1761;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLinksetState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotOmsSpaceUsageCriticalAbated
sub _1_3_6_1_4_1_1556_17_0_6277
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "HDD space for SP2K Specific OMs has returned to reasonable levels. Cause  - HDD space for SP2K Specific OMs has been restored.  Action - None. Freq   - Irregular.\nTrapName = ptSlotSlotOmsSpaceUsageCriticalAbated,\n";
    
    my $dat_notification_id = 1762;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.20"})) {
        $dat_additional_text .= "\nptSlotOMsSpaceUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.20"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSwitchMonitorSwitchmonDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_6295
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All debug attributes are set to their recommended values.\nTrapName = ptSwitchMonitorSwitchmonDebugLevelRecommended,\n";
    
    my $dat_notification_id = 1763;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIsmRootPartitionThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_5524
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the ISM root partition usage has returned below its alarm threshold\nTrapName = ptIsmRootPartitionThresholdCleared,\n";
    
    my $dat_notification_id = 1764;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmSLSLinkAuditFailure
sub _1_3_6_1_4_1_1556_17_0_9989
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "MTP3 detected an unavailable link in an SLS Table. MSU loss is possible. Cleared by atmSLSLinkAuditFailureClear. Cause  - MTP3 detected an unavailable link in an SLS Table. Action - This alarm should resolve itself in less than four minutes. If this alarm does not clear itself you should reset the link using the 'Reset' action on the link. Freq   - Operator dependant. References None. This is an implementation specific audit. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        1 critical ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptATMLinkAtmSLSLinkAuditFailure,\n";
    
    my $dat_notification_id = 1765;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotMTUSizeAsConfigured
sub _1_3_6_1_4_1_1556_17_0_3171
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Current MTU sizes match configuration.\nTrapName = ptSlotSlotMTUSizeAsConfigured,\n";
    
    my $dat_notification_id = 1766;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAConfiguredASPSUAConfASPUnresolvedHost2
sub _1_3_6_1_4_1_1556_17_0_7602
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that SUA Configured ASP IP Address 2 hostname is not resolvable. Cause - The SG is unable to resolve the hostname. Possible Actions - If the DSC has been set up to use a DNS server,  ensure the DNS server is reachable and confirm that the hostname has been configured. If the hostname is intended to resolve locally, ensure the proper hostname entry  has been added using IP Networking > Hostname Resolution. Freq - This trap occurs when the configured hostname becomes unresolvable.\nTrapName = ptSUAConfiguredASPSUAConfASPUnresolvedHost2,\n";
    
    my $dat_notification_id = 1767;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkOscillationFilterSet
sub _1_3_6_1_4_1_1556_17_0_8170
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that Link Oscillation Filter Timer T32 has started\nTrapName = ptATMLinkAtmL3LinkOscillationFilterSet,\n";
    
    my $dat_notification_id = 1768;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANodeMTPRestartBegin
sub _1_3_6_1_4_1_1556_17_0_8189
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Local MTP Restart procedure has begun.\nTrapName = ptMTP3NANodeMTPRestartBegin,\n";
    
    my $dat_notification_id = 1769;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"})) {
        $dat_additional_text .= "\nptMTPMTP3NALocalPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkLocalUnblocked
sub _1_3_6_1_4_1_1556_17_0_7146
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been unblocked at the local node  by the operator. References 1) Q.704 Section 3.2       ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 56 Underlying resource unavailable ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL3LinkLocalUnblocked,\n";
    
    my $dat_notification_id = 1770;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkUsageHighClear
sub _1_3_6_1_4_1_1556_17_0_8137
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the average traffic over this link no longer exceeds predefined threshold. There is no longer potential for traffic loss due to extensive traffic. References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 51 Threshold crossed ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL3LinkUsageHighClear,\n";
    
    my $dat_notification_id = 1771;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericLinkSCTPUnavailable
sub _1_3_6_1_4_1_1556_17_0_8426
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is unavailable for user traffic because the underlying SCTP Association is unavailable. Cleared by GenericLinkSCTPAvailable. Cause  - Most likely an IP Network issues, or perhaps communication was lost to a DRE. Action - Check the availability of the corresponding DRE. If available, troubleshoot the IP connectivity. Freq   - Operator dependant. References 1) GR310CORE Issue 3 Section 8.6 (REPT-SCTP-ASOCTRMD) ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        3 minor ptTrapProbableCause:  29 Loss of signal    ptTrapClearType:       1 fmic\nTrapName = ptGenericLinkGenericLinkSCTPUnavailable,\n";
    
    my $dat_notification_id = 1772;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPSXsNPGWPSXQueueFull
sub _1_3_6_1_4_1_1556_17_0_1625
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW PSX queue is full.\nTrapName = ptPSXsNPGWPSXQueueFull,\n";
    
    my $dat_notification_id = 1773;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L2LinkUnaligned
sub _1_3_6_1_4_1_1556_17_0_7121
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has lost alignment. Cause  - After a signaling link failure is detected , signaling link initial alignment will take place. The Alignment procedure  passes through a number of states and when the procedure  enters the state not aligned this trap is sent. Action - If the initial alignment procedure does not work then the  operator will have to intervene in order that the link  alignment succeeds. Freq   - This trap will continue to appear each time the initial  alignment procedure enters the state not aligned. This may happen a number of times as the initial alignment  procedure is repeated until alignment has been completed successfully.  References 1) Q.703 , (07/96) Section 7.3  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L2LinkUnaligned,\n";
    
    my $dat_notification_id = 1774;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.8"})) {
        $dat_additional_text .= "\nptMTPLSLinkL2State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericL3LinkUnavailable
sub _1_3_6_1_4_1_1556_17_0_8432
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is unavailable for user traffic. Cleared by GenericL3LinkAvailable. Cause  - The link is unavailable to user traffic for some reason (e.g. out of service, blocked, inhibited). Action - Depends on link state. Freq   - Operator dependant. References 1) GR310CORE Issue 3 Section 8.1 2) GR246CORE Issue 10 3) GR82CORE  Issue 10 4) Q.704 ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        3 minor ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptGenericLinkGenericL3LinkUnavailable,\n";
    
    my $dat_notification_id = 1775;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotTIPCBearerLoss
sub _1_3_6_1_4_1_1556_17_0_6296
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one required TIPC is unavailable  Cause  - TIPC is reporting an unavailable bearer. Possible Actions - Invetigate the systems TIPC configuration.\nTrapName = ptSlotSlotTIPCBearerLoss,\n";
    
    my $dat_notification_id = 1776;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2UALinkM2uaL3LinkUsageHighSet
sub _1_3_6_1_4_1_1556_17_0_8132
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the average traffic over this link exceeds predefined threshold. There is potential for traffic loss if this condition persists. References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 51 Threshold crossed ptTrapClearType:     1 fmic\nTrapName = ptM2UALinkM2uaL3LinkUsageHighSet,\n";
    
    my $dat_notification_id = 1777;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2UALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2UALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2UALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2UALinkIID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"})) {
        $dat_additional_text .= "\nptMTPM2UALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2UALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIWFSS7IWFSS7ConfigurationMismatch
sub _1_3_6_1_4_1_1556_17_0_1905
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The MTP3 configuration information provided by the SCCP to the IWF does not match with  the IWF SS7 configuration.  The associated MTP3 NA necessary configuration must match.\nTrapName = ptIWFSS7IWFSS7ConfigurationMismatch,\n";
    
    my $dat_notification_id = 1778;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.3"})) {
        $dat_additional_text .= "\nptiwfIWFSS7SCCPPAEncoding = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.4"})) {
        $dat_additional_text .= "\nptiwfIWFSS7PCDisplayFormat = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.5"})) {
        $dat_additional_text .= "\nptiwfIWFSS7PCRoutingFormat = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.1"})) {
        $dat_additional_text .= "\nptiwfIWFSS7SCCPNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNANPGWSCCPNAUp
sub _1_3_6_1_4_1_1556_17_0_1604
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Atleast one NPGW SCCP NA connection is connected.\nTrapName = ptSCCPNANPGWSCCPNAUp,\n";
    
    my $dat_notification_id = 1779;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwSCCPNANA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwSCCPNAStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3LinkInvalidOpcClear
sub _1_3_6_1_4_1_1556_17_0_9955
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "MTP3 no longer detects messages with invalid OPC for 5 minutes.\nTrapName = ptMTP3NAMtp3LinkInvalidOpcClear,\n";
    
    my $dat_notification_id = 1780;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPSXNPGWPSXActive
sub _1_3_6_1_4_1_1556_17_0_1632
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW PSX is active.\nTrapName = ptPSXNPGWPSXActive,\n";
    
    my $dat_notification_id = 1781;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwPSXName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.4"})) {
        $dat_additional_text .= "\nptnpgwPSXUserActivated = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.4"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDiscreteSensorPsFaultDeassert
sub _1_3_6_1_4_1_1556_17_0_6327
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A discrete sensor power supply fault alarm was deasserted Cause  - A discrete sensor no longer detects a power supply fault condition Action - None Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptDiscreteSensorPsFaultDeassert,\n";
    
    my $dat_notification_id = 1782;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paLinkSCTPPathUnavailable
sub _1_3_6_1_4_1_1556_17_0_8128
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the SCTP Association that carries M2PA Traffic is operating in a vulnerable state, an additional path failure could cause a link failure. Cleared by m2paLinkSCTPPathAvailable. Cause  - Most likely an IP Network issue. Action - Troubleshoot IP connectivity. Freq   - Operator dependant. References This trap is implementation specific. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        3 minor ptTrapProbableCause:  29 Loss of signal    ptTrapClearType:       1 fmic\nTrapName = ptM2PALinkM2paLinkSCTPPathUnavailable,\n";
    
    my $dat_notification_id = 1783;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.6"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesTpsServerSetupSuccess
sub _1_3_6_1_4_1_1556_17_0_1863
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "DSC TPS Server setup is successful\nTrapName = ptDSCNodesTpsServerSetupSuccess,\n";
    
    my $dat_notification_id = 1784;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAManagerSccpProcessShutdown
sub _1_3_6_1_4_1_1556_17_0_4202
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates the SCCP process is shutting down.   Sent every time SCCP is terminated (intentionally or not). System based termination include: - LDL Configuration error - Process received a terminating signal (SIGINT, SIGTERM).\nTrapName = ptSCCPNAManagerSccpProcessShutdown,\n";
    
    my $dat_notification_id = 1785;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3NAConfigWriteError
sub _1_3_6_1_4_1_1556_17_0_9984
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that there was an error writing the MTP3 NA configuration file to disk.  Recent changes may not have been committed to persistent storage. This is a stateless trap (no alarm). Cause  - A configuration file write could fail for a number of reasons, including but not limited to - disk full - file permissions - temporary file and real file are on different mount points If the cause is not evident, the corresponding syslog entry may have more details. Action - Resolve the issue with the disk, then prompt a rewrite of the configuration file by modifying a value in the UI. Freq   - This trap occurs if there is an error committing the configuration to persistent storage. References  None.  This is implementation specific.\nTrapName = ptMTP3NAMtp3NAConfigWriteError,\n";
    
    my $dat_notification_id = 1786;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"})) {
        $dat_additional_text .= "\nptMTPMTP3NALocalPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptServerPoolServerPoolNoDBPeerUP
sub _1_3_6_1_4_1_1556_17_0_1816
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "No DB Peer is UP for use with Server Pool.\nTrapName = ptServerPoolServerPoolNoDBPeerUP,\n";
    
    my $dat_notification_id = 1787;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkRemoteUnblocked
sub _1_3_6_1_4_1_1556_17_0_7144
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been unblocked at a remote node. Causes ,Corrective actions and Frequency   1) ptSpecificTrapCause = linkDeactivated  Cause  -  Unknown Cause 2) ptSpecificTrapCause = unknownCause References 1) Table 2 Q.752 Stop of Remote Processor Outage 2) Q.704 Section 3.3.5       ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 42 Remote node transmission error   ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL3LinkRemoteUnblocked,\n";
    
    my $dat_notification_id = 1788;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAConfiguredASPM3UAConfASPUnresolvedHost1
sub _1_3_6_1_4_1_1556_17_0_7500
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that M3UA Configured ASP IP Address 1 hostname is not resolvable. Cause - The SG is unable to resolve the hostname. Possible Actions - If the DSC has been set up to use a DNS server,  ensure the DNS server is reachable and confirm that the hostname has been configured. If the hostname is intended to resolve locally, ensure the proper hostname entry  has been added using IP Networking > Hostname Resolution. Freq - This trap occurs when the configured hostname becomes unresolvable.\nTrapName = ptM3UAConfiguredASPM3UAConfASPUnresolvedHost1,\n";
    
    my $dat_notification_id = 1789;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptTmpDiskPartitionThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_5510
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that /tmp disk partition usage has reached its alarm threshold\nTrapName = ptTmpDiskPartitionThresholdExceeded,\n";
    
    my $dat_notification_id = 1790;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSwitchColdStart
sub _1_3_6_1_4_1_1556_17_0_6287
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A switch card has recovered and issued a cold start.  The associated fabric is now operational. Cause  - Switch card is running. Action - None. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Application - ptTrapType:          4  equipment alarm - ptTrapSeverity:      4  warning - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     2  oic\nTrapName = ptSwitchColdStart,\n";
    
    my $dat_notification_id = 1791;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRootDiskPartitionThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_5508
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the root disk partition usage has returned below its alarm threshold\nTrapName = ptRootDiskPartitionThresholdCleared,\n";
    
    my $dat_notification_id = 1792;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANodeSNMPeerHostAvailable
sub _1_3_6_1_4_1_1556_17_0_8158
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SNM Peer Host available.\nTrapName = ptMTP3NANodeSNMPeerHostAvailable,\n";
    
    my $dat_notification_id = 1793;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"})) {
        $dat_additional_text .= "\nptMTPMTP3NALocalPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPCEPceProcessStartup
sub _1_3_6_1_4_1_1556_17_0_4301
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates the PCE process is starting up.   Sent every time PCE starts up via a manual intervention or typically  via the watchdog.\nTrapName = ptPCEPceProcessStartup,\n";
    
    my $dat_notification_id = 1794;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotMonitorMissingIOcfgFileClear
sub _1_3_6_1_4_1_1556_17_0_3185
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = " \nTrapName = ptSlotMonitorMissingIOcfgFileClear,\n";
    
    my $dat_notification_id = 1795;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"})) {
        $dat_additional_text .= "\nptSlotMonitorHostname = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkUsageHighSet
sub _1_3_6_1_4_1_1556_17_0_8138
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the average traffic over this link exceeds predefined threshold. There is potential for traffic loss if this condition persists. References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 51 Threshold crossed ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkUsageHighSet,\n";
    
    my $dat_notification_id = 1796;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSwitchSwitchReachable
sub _1_3_6_1_4_1_1556_17_0_6281
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A switch card has recovered and is responding.  The associated fabric is now operational. Cause  - Switch card is running. Action - None. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Application - ptTrapType:          4  equipment alarm - ptTrapSeverity:      5  clear - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptSwitchSwitchReachable,\n";
    
    my $dat_notification_id = 1797;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetSs7LinksetActivated
sub _1_3_6_1_4_1_1556_17_0_8601
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an SS7 linkset has been activated by the user.\nTrapName = ptLinksetSs7LinksetActivated,\n";
    
    my $dat_notification_id = 1798;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLinksetState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotDSCDBPartitionThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_3151
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "DSC DB partition usage has returned to acceptable levels. Cause  - DSC DB partition usage below threshold. Action - None. Freq   - Irregular.\nTrapName = ptSlotSlotDSCDBPartitionThresholdCleared,\n";
    
    my $dat_notification_id = 1799;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3NADebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_8211
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The MTP3 NA debug attributes are set to their recommended values.\nTrapName = ptMTP3NAMtp3NADebugLevelRecommended,\n";
    
    my $dat_notification_id = 1800;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptProcessEventSlotMgrNotConnected
sub _1_3_6_1_4_1_1556_17_0_8304
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the peer slot manager is not connected. Not raised during initialization.\nTrapName = ptProcessEventSlotMgrNotConnected,\n";
    
    my $dat_notification_id = 1801;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"})) {
        $dat_additional_text .= "\nptpeereventProcessEventSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"})) {
        $dat_additional_text .= "\nptpeereventProcessEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASccpNADiscardMSUMTP3Clear
sub _1_3_6_1_4_1_1556_17_0_4215
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for MSU has been discarded by a SCCP MTP3 NA.\nTrapName = ptSCCPNASccpNADiscardMSUMTP3Clear,\n";
    
    my $dat_notification_id = 1802;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"})) {
        $dat_additional_text .= "\nptSCCPSCCPNAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSwitchTopologyChange
sub _1_3_6_1_4_1_1556_17_0_6285
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A rapid spanning tree topology change has been issued.  Cause  - Change in the IP network. Action - None. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Application - ptTrapType:          4  equipment alarm - ptTrapSeverity:      4  Warning - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     0  oic\nTrapName = ptSwitchTopologyChange,\n";
    
    my $dat_notification_id = 1803;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAAppServerM3UADiscardMsuFromPeerSet
sub _1_3_6_1_4_1_1556_17_0_7382
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MSU has been unexpectedly discarded between peers on M3UA AS in the last 5-minute.\nTrapName = ptM3UAAppServerM3UADiscardMsuFromPeerSet,\n";
    
    my $dat_notification_id = 1804;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.9"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerRoutingContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerSI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerNetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.5"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptTmpSelmonIpmitoolUp
sub _1_3_6_1_4_1_1556_17_0_5514
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that sel_mon is now operable, and the ipmitool responding properly\nTrapName = ptTmpSelmonIpmitoolUp,\n";
    
    my $dat_notification_id = 1805;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPM3uaUserAssocPathEstablished
sub _1_3_6_1_4_1_1556_17_0_7271
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A path is up on a multi-homed user connection\nTrapName = ptM3UAASPM3uaUserAssocPathEstablished,\n";
    
    my $dat_notification_id = 1806;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAInvalidIncomingTrafficClear
sub _1_3_6_1_4_1_1556_17_0_9961
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for invalid incoming traffic.\nTrapName = ptMTP3NAInvalidIncomingTrafficClear,\n";
    
    my $dat_notification_id = 1807;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkUsageAlarmSet
sub _1_3_6_1_4_1_1556_17_0_8124
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 8.2.0. This trap indicates that the average traffic over this link exceeds  predefined threshold. There is potential for traffic loss if this  condition persists References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 51 Threshold crossed  ptTrapClearType:     2 oic\nTrapName = ptM2PALinkM2paL3LinkUsageAlarmSet,\n";
    
    my $dat_notification_id = 1808;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaSP2KMultiAssocActivated
sub _1_3_6_1_4_1_1556_17_0_7369
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An M3UA multi association has been  activated by the user.\nTrapName = ptM3UAASPAssociationM3uaSP2KMultiAssocActivated,\n";
    
    my $dat_notification_id = 1809;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptTransportServerServerFirewallCleared
sub _1_3_6_1_4_1_1556_17_0_1823
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC server has at least one resolved Allowed IP address.\nTrapName = ptTransportServerServerFirewallCleared,\n";
    
    my $dat_notification_id = 1810;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.6"})) {
        $dat_additional_text .= "\nptDSCTransportServerHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.1"})) {
        $dat_additional_text .= "\nptDSCTransportServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.5"})) {
        $dat_additional_text .= "\nptDSCTransportServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSGConfigurationLicConnClrCritical
sub _1_3_6_1_4_1_1556_17_0_7275
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A critical SG license error has been cleared\nTrapName = ptSGConfigurationLicConnClrCritical,\n";
    
    my $dat_notification_id = 1811;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationBulkInputFailErrorClear
sub _1_3_6_1_4_1_1556_17_0_2014
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "NP Database Bulk Input failed entry alarm cleared.\nTrapName = ptSS7DBAppsConfigurationBulkInputFailErrorClear,\n";
    
    my $dat_notification_id = 1812;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCommandCodeRoutingTableDSCCmdCodeDiscardConfigured
sub _1_3_6_1_4_1_1556_17_0_1837
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC routing table contains at least one table entry that is configured to discard messages.  This is highly discouraged.\nTrapName = ptCommandCodeRoutingTableDSCCmdCodeDiscardConfigured,\n";
    
    my $dat_notification_id = 1813;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1836.1.1.1"})) {
        $dat_additional_text .= "\nptDSCCommandCodeRoutingTableTableName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1836.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionADNConnAssocMaxMsgSizeDiscard
sub _1_3_6_1_4_1_1556_17_0_1818
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "ADN Connection Association discarded one or more messages exceeding maximum size.\nTrapName = ptADNConnectionADNConnAssocMaxMsgSizeDiscard,\n";
    
    my $dat_notification_id = 1814;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL2LinkAligned
sub _1_3_6_1_4_1_1556_17_0_7192
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been aligned. Cause  - After a signaling link failure is detected, signaling link initial alignment will take place. The Alignment procedure  passes through a number of states and when the procedure  enters the state aligned this trap is sent. Freq   - Once the alignment procedure enters the aligned state then the alignment procedure will not be repeated.  References 1) Q.703 , (07/96) Section 7.3  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL2LinkAligned,\n";
    
    my $dat_notification_id = 1815;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.8"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL2State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSwitchSwitchSyncUp
sub _1_3_6_1_4_1_1556_17_0_6291
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A sync interface has recovered and is operational.  Cause  - Sync interface is connected and is operational. Action - None. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Application - ptTrapType:          4  equipment alarm - ptTrapSeverity:      5  clear - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptSwitchSwitchSyncUp,\n";
    
    my $dat_notification_id = 1816;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAConfiguredASPM3UAConfASPResolvedHost2
sub _1_3_6_1_4_1_1556_17_0_7503
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "M3UA Configured ASP IP Address 2 Hostname is resolved\nTrapName = ptM3UAConfiguredASPM3UAConfASPResolvedHost2,\n";
    
    my $dat_notification_id = 1817;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMSAMsaThreshold2Cleared
sub _1_3_6_1_4_1_1556_17_0_8204
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the MSA threshold 2 is cleared.\nTrapName = ptMSAMsaThreshold2Cleared,\n";
    
    my $dat_notification_id = 1818;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.961.962.1.1.1"})) {
        $dat_additional_text .= "\nptmsaMSAName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.961.962.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotAvailableMemThresh40Exceeded
sub _1_3_6_1_4_1_1556_17_0_3176
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Memory availability has dropped below 40% of total memory.  The slot number shown in this trap indicates the origin of the alarm.   Cause  - Memory usage reached a certain threshold Action - Identify applications consuming memory Freq   - Irregular References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     1 fmic\nTrapName = ptSlotAvailableMemThresh40Exceeded,\n";
    
    my $dat_notification_id = 1819;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"})) {
        $dat_additional_text .= "\nptSlotCPUMemoryUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkUninhibitDenied
sub _1_3_6_1_4_1_1556_17_0_7181
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an attempt to uninhibit a signaling link has failed. This is a stateless trap (no alarm). Cause  - A request to uninhibit a link from the local node to a  destination will fail if all the routes to the destination are unavailable. Action - Operator will have to wait until a route to the destination becomes available in order that it can send an uninhibit link  message.  Freq   - Operator dependant. References 1) Q.704 , (07/96) Section 10.2        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 56 Underlying resource unavailable ptTrapClearType:     2 oic\nTrapName = ptAnnexALinkAnnexaL3LinkUninhibitDenied,\n";
    
    my $dat_notification_id = 1820;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotAvailableMemThresh20Exceeded
sub _1_3_6_1_4_1_1556_17_0_3180
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Memory availability has dropped below 20% of total memory.  The slot number shown in this trap indicates the origin of the alarm.   Cause  - Memory usage reached a certain threshold Action - Identify applications consuming memory Freq   - Irregular References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     1 fmic\nTrapName = ptSlotAvailableMemThresh20Exceeded,\n";
    
    my $dat_notification_id = 1821;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"})) {
        $dat_additional_text .= "\nptSlotCPUMemoryUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIWFConfigurationIWFDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_1919
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptIWFConfigurationIWFDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1822;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptConnectionRemoteHostResFail
sub _1_3_6_1_4_1_1556_17_0_5003
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "No IP address resolutions can be made for the Remote Host.  No connection can be successful. Either change Remote Host or add a resolution for that value.\nTrapName = ptConnectionRemoteHostResFail,\n";
    
    my $dat_notification_id = 1823;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.5001.5005.5006.1.1.1"})) {
        $dat_additional_text .= "\nptLBConnectionName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.5001.5005.5006.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAManagerMtp3DebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_8207
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All debug attributes are set to their recommended values.\nTrapName = ptMTP3NAManagerMtp3DebugLevelRecommended,\n";
    
    my $dat_notification_id = 1824;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASCCPNAsDiscardMsuFromPeerSet
sub _1_3_6_1_4_1_1556_17_0_7388
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MSU has been unexpectedly discarded between peers on SCCP NA Connection in the last 5-minute interval.\nTrapName = ptSCCPNASCCPNAsDiscardMsuFromPeerSet,\n";
    
    my $dat_notification_id = 1825;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.255.256.1.1.1"})) {
        $dat_additional_text .= "\nptSGSCCPNANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.255.256.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkAlarmsEnabled
sub _1_3_6_1_4_1_1556_17_0_8101
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "LS Link alarms are enabled.\nTrapName = ptLSLinkSs7L3LinkAlarmsEnabled,\n";
    
    my $dat_notification_id = 1826;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkActivated
sub _1_3_6_1_4_1_1556_17_0_8104
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA signaling link has been activated either by operator or as a result of a successful restoration  which was initiated upon detection of an inactive link. This trap could also be generated at restart without a previous corresponding trap 201. References 1)  Q.752, SL Restoration 2)  Q.704, (07/96) Section 12.2 ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 29 Loss of signal  ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paL3LinkActivated,\n";
    
    my $dat_notification_id = 1827;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotIsmVarPartitionThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_6249
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "ISM /var partition usage has returned to acceptable levels. Cause  - ISM /var partition usage below threshold. Action - None. Freq   - Irregular.\nTrapName = ptSlotSlotIsmVarPartitionThresholdCleared,\n";
    
    my $dat_notification_id = 1828;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCpuUsageCriticalAbated
sub _1_3_6_1_4_1_1556_17_0_6245
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "CPU usage has returned to reasonable levels. Cause  - CPU usage below threshold. Action - None. Freq   - Irregular.\nTrapName = ptSlotSlotCpuUsageCriticalAbated,\n";
    
    my $dat_notification_id = 1829;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericSLSLinkAuditFailureClear
sub _1_3_6_1_4_1_1556_17_0_9998
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an SLS Table Link Audit has concluded and this link is no longer included incorrectly in SLS Tables. The link may have been removed from SLS Tables, or its state may have changed so it is now appropriate for use in SLS Tables. Clears GenericSLSLinkAuditFailure. References None. This is an implementation specific audit. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptGenericLinkGenericSLSLinkAuditFailureClear,\n";
    
    my $dat_notification_id = 1830;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2UALinkM2uaSLSLinkAuditFailure
sub _1_3_6_1_4_1_1556_17_0_9993
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "MTP3 detected an unavailable link in an SLS Table. MSU loss is possible. Cleared by m2uaSLSLinkAuditFailureClear. Cause  - MTP3 detected an unavailable link in an SLS Table. Action - This alarm should resolve itself in less than four minutes. If this alarm does not clear itself you should reset the link using the 'Reset' action on the link. Freq   - Operator dependant. References None. This is an implementation specific audit. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        1 critical ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptM2UALinkM2uaSLSLinkAuditFailure,\n";
    
    my $dat_notification_id = 1831;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2UALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"})) {
        $dat_additional_text .= "\nptMTPM2UALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2UALinkIID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2UALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2UALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2UALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDREDRECongestionClear
sub _1_3_6_1_4_1_1556_17_0_9963
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for DRE congestion.\nTrapName = ptDREDRECongestionClear,\n";
    
    my $dat_notification_id = 1832;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotAvailableMemThresh20Cleared
sub _1_3_6_1_4_1_1556_17_0_3181
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Memory availability is restored to more than 20% of total memory. Cause  - Applications have freed memory. Action - None. Freq   - Irregular. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     0 oic\nTrapName = ptSlotAvailableMemThresh20Cleared,\n";
    
    my $dat_notification_id = 1833;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"})) {
        $dat_additional_text .= "\nptSlotCPUMemoryUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCDBPartitionThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_5532
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the DSCDB Partition usage has returned below its alarm threshold\nTrapName = ptDSCDBPartitionThresholdCleared,\n";
    
    my $dat_notification_id = 1834;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGWSTConfigurationGwstDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_4006
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that at least one GWST debug flag has been changed to a non recommended value. Cause: A user has altered at least one debugging flag to a non recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action. This action is displayed in the GWST Debug Configuration screen. It restores all log flags to the default values which in turn clears the alarm.\nTrapName = ptGWSTConfigurationGwstDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1835;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkLocalInhibited
sub _1_3_6_1_4_1_1556_17_0_7175
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been inhibited  by operator at the local node. Cause  - Operator inhibits the link. Action - Operator can uninhibit the link. Freq   - Operator dependant.  References 1) Table 2 Q.752, Start of local inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 43 Resource at or near capacity    ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkLocalInhibited,\n";
    
    my $dat_notification_id = 1836;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotDSCDBPartitionThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_3150
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "DSC DB partition usage is above the alarm threshold defined in  disk_space_quota.  The slot number indicated in this trap indicates the origin of the alarm. Cause  - DSC DB partition usage above threshold Action - Identify applications running high on disk space Freq   - Irregular\nTrapName = ptSlotSlotDSCDBPartitionThresholdExceeded,\n";
    
    my $dat_notification_id = 1837;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaMultiAssocActivated
sub _1_3_6_1_4_1_1556_17_0_7407
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An M3UA multi association has been  activated by the user.\nTrapName = ptM3UAASPAssociationM3uaMultiAssocActivated,\n";
    
    my $dat_notification_id = 1838;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPortMpmtp2PortFarEndLoopbackCleared
sub _1_3_6_1_4_1_1556_17_0_5814
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the far end has been instructed to exit loopback mode for normal operation. Cause  - A user has instructed loopback deactivation codes to be sent to restore the far end to normal operation Action - None required Freq   - This trap will appear when the user instructs the far end to exit test mode, such as for BERT. References - ptOriginatingOID:    DYNAMIC ptPort - ptTrapType:          2 communication alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptPortMpmtp2PortFarEndLoopbackCleared,\n";
    
    my $dat_notification_id = 1839;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWPortPortNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkLocalInhibited
sub _1_3_6_1_4_1_1556_17_0_7135
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been inhibited  by operator at the local node. Cause  - Operator inhibits the link. Action - Operator can uninhibit the link. Freq   - Operator dependant.  References 1) Table 2 Q.752, Start of local inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 43 Resource at or near capacity    ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL3LinkLocalInhibited,\n";
    
    my $dat_notification_id = 1840;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotBackupSpaceUsageCritical
sub _1_3_6_1_4_1_1556_17_0_6270
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "HDD space for backups is dangerously low.  The slot number indicated in this trap indicates the origin of the alarm. Cause  - Backups using up too much HDD space Action - Delete some old Backups  Freq   - Irregular\nTrapName = ptSlotSlotBackupSpaceUsageCritical,\n";
    
    my $dat_notification_id = 1841;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.18"})) {
        $dat_additional_text .= "\nptSlotBackupSpaceUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.18"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericL3LinkOscillationFilterSet
sub _1_3_6_1_4_1_1556_17_0_8430
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that Link Oscillation Filter Timer T32 has started\nTrapName = ptGenericLinkGenericL3LinkOscillationFilterSet,\n";
    
    my $dat_notification_id = 1842;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANPGWMTP3NADown
sub _1_3_6_1_4_1_1556_17_0_1611
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The MTP3 NA is deactivated or all MTP3 NA connections are not connected.\nTrapName = ptMTP3NANPGWMTP3NADown,\n";
    
    my $dat_notification_id = 1843;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwMTP3NANA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwMTP3NAStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPM3uaAssocHighTransmitUsageAbatement
sub _1_3_6_1_4_1_1556_17_0_7329
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The amount of traffic being transmitted to an M3UA ASP has received normal levels. The conditions of this clear event are controlled by the user using the M3UA High Usage Abatement setting.\nTrapName = ptM3UAASPM3uaAssocHighTransmitUsageAbatement,\n";
    
    my $dat_notification_id = 1844;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIWFSS7IWFSCCPResponseMatchClear
sub _1_3_6_1_4_1_1556_17_0_1918
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The IWF did not received a SCCP response without a match in the last 5 minutes.\nTrapName = ptIWFSS7IWFSCCPResponseMatchClear,\n";
    
    my $dat_notification_id = 1845;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.1"})) {
        $dat_additional_text .= "\nptiwfIWFSS7SCCPNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.7"})) {
        $dat_additional_text .= "\nptiwfIWFSS7ConnectivityStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptNPGWConfigurationNPGWSCCPUp
sub _1_3_6_1_4_1_1556_17_0_1602
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one NPGW SCCP NA is connected.\nTrapName = ptNPGWConfigurationNPGWSCCPUp,\n";
    
    my $dat_notification_id = 1846;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1601.1.1.4"})) {
        $dat_additional_text .= "\nptnpgwNPGWConfigurationSCCPTrafficStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1601.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptNPGWConfigurationNPGWMTP3Down
sub _1_3_6_1_4_1_1556_17_0_1617
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW traffic is deactivated or all MTP3 NAs are not connected.\nTrapName = ptNPGWConfigurationNPGWMTP3Down,\n";
    
    my $dat_notification_id = 1847;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1601.1.1.3"})) {
        $dat_additional_text .= "\nptnpgwNPGWConfigurationMTP3TrafficStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1601.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptINAPGWConfigurationINAPGWSS7Up
sub _1_3_6_1_4_1_1556_17_0_1302
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one INAPGW SCCP NA is connected.\nTrapName = ptINAPGWConfigurationINAPGWSS7Up,\n";
    
    my $dat_notification_id = 1848;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1301.1.1.2"})) {
        $dat_additional_text .= "\nptinapgwINAPGWConfigurationTrafficStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1301.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationLsmsPingFailure
sub _1_3_6_1_4_1_1556_17_0_2021
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "LSMS ping test failed.\nTrapName = ptSS7DBAppsConfigurationLsmsPingFailure,\n";
    
    my $dat_notification_id = 1849;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptThresholdSensorUpperMinorDeassert
sub _1_3_6_1_4_1_1556_17_0_6345
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A threshold sensor upper minor alarm was deasserted Cause  - A threshold sensor no longer detects an upper minor condition Action - None Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptThresholdSensorUpperMinorDeassert,\n";
    
    my $dat_notification_id = 1850;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRoutesetRoutesetDestCongested
sub _1_3_6_1_4_1_1556_17_0_8155
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that destination is congested. Cleared by routesetDestCongestedRecovery.\nTrapName = ptRoutesetRoutesetDestCongested,\n";
    
    my $dat_notification_id = 1851;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"})) {
        $dat_additional_text .= "\nptMTPRoutesetDestinationState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"})) {
        $dat_additional_text .= "\nptMTPRoutesetContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"})) {
        $dat_additional_text .= "\nptMTPRoutesetDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRoutesetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSGConfigurationSgDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_7277
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All debug attributes are set to their recommended values.\nTrapName = ptSGConfigurationSgDebugLevelRecommended,\n";
    
    my $dat_notification_id = 1852;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGWSTConfigurationGR310ConnectionDown
sub _1_3_6_1_4_1_1556_17_0_1001
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A connection loss was detected on at least one routing CPU and the active GR-310 server.\nTrapName = ptGWSTConfigurationGR310ConnectionDown,\n";
    
    my $dat_notification_id = 1853;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPortMpmtp2PortStatusCritical
sub _1_3_6_1_4_1_1556_17_0_5820
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an MTP2 critical port status event has occurred. Cause  - An error has occurred on the port. Action - Verify the functionality of the link and ports both locally and at the remote end. Freq   - This trap will appear whenever a critical port status event occurs References - ptOriginatingOID:    DYNAMIC ptPort - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 6 Communications subsystem error - ptTrapClearType:     1 fmic\nTrapName = ptPortMpmtp2PortStatusCritical,\n";
    
    my $dat_notification_id = 1854;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWPortPortNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDREDRECongestion
sub _1_3_6_1_4_1_1556_17_0_9962
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The inter-DRE communication is congested.\nTrapName = ptDREDRECongestion,\n";
    
    my $dat_notification_id = 1855;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.49.47.1.1.1"})) {
        $dat_additional_text .= "\nptMTPDREContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.49.47.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptL4ConverterL4cvtrWriteFailure
sub _1_3_6_1_4_1_1556_17_0_4105
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates a L4Cvtr write to file failed.   Sent when a L4Cvtr configuration or database write fails. Write failures include: - Invalid file permissions - Out of memory in file system\nTrapName = ptL4ConverterL4cvtrWriteFailure,\n";
    
    my $dat_notification_id = 1856;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationNsmConnUp
sub _1_3_6_1_4_1_1556_17_0_2012
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Connectivy to the NSM has been restored\nTrapName = ptSS7DBAppsConfigurationNsmConnUp,\n";
    
    my $dat_notification_id = 1857;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetCLinkLongMsuSupportFailureSet
sub _1_3_6_1_4_1_1556_17_0_8148
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This alarm indicates that the Network Appearance (NA) supports messages larger than 273, but the C-Linkset does not have the  long MSU Support option set to enabled. MTP3B traffic may be  lost if redirected over the C-Linkset. Action:  - ensure that the mate STP can support long MSUs and set the Long MSU Support option to ENABLED. - or -  - deactivate the C-link linkset - or -  - reduce the NA Maximum MSU Length to 273 bytes. Freq - this trap occurs during provisioning or when the SNM application is restarted. ptOriginatingOID:    DYNAMIC ptLinkset ptTrapType:          2 communicationAlarm  ptTrapSeverity:      3 minor  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptLinksetCLinkLongMsuSupportFailureSet,\n";
    
    my $dat_notification_id = 1858;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLinksetState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASccpNAConnected
sub _1_3_6_1_4_1_1556_17_0_7233
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An SCCP NA connected notification is sent when the connectivity between the Dinamo and SCCP is established.\nTrapName = ptSCCPNASccpNAConnected,\n";
    
    my $dat_notification_id = 1859;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.255.256.1.1.1"})) {
        $dat_additional_text .= "\nptSGSCCPNANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.255.256.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAConnectionINAPGWSCCPNAConnectionUp
sub _1_3_6_1_4_1_1556_17_0_1306
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP NA connection is connected.\nTrapName = ptSCCPNAConnectionINAPGWSCCPNAConnectionUp,\n";
    
    my $dat_notification_id = 1860;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1304.1.1.2"})) {
        $dat_additional_text .= "\nptinapgwSCCPNAConnectionStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1304.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1304.1.1.1"})) {
        $dat_additional_text .= "\nptinapgwSCCPNAConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1302.1303.1304.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L2LinkAligned
sub _1_3_6_1_4_1_1556_17_0_7122
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been aligned. Cause  - After a signaling link failure is detected, signaling link initial alignment will take place. The Alignment procedure  passes through a number of states and when the procedure  enters the state aligned this trap is sent. Freq   - Once the alignment procedure enters the aligned state then the alignment procedure will not be repeated.  References 1) Q.703 , (07/96) Section 7.3  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L2LinkAligned,\n";
    
    my $dat_notification_id = 1861;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.8"})) {
        $dat_additional_text .= "\nptMTPLSLinkL2State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexProcessExit
sub _1_3_6_1_4_1_1556_17_0_2035
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications process exit.\nTrapName = ptSS7DBAppsConfigurationSigFlexProcessExit,\n";
    
    my $dat_notification_id = 1862;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAAppServerSUAAppServerActive
sub _1_3_6_1_4_1_1556_17_0_7311
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an App Server is now active.   Cause: An ASP has activated the associated routing context (RC). ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm  ptTrapSeverity: 5 cleared  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType: 1 fmic\nTrapName = ptSUAAppServerSUAAppServerActive,\n";
    
    my $dat_notification_id = 1863;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.9"})) {
        $dat_additional_text .= "\nptSGSUAAppServerApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUAAppServerSSN = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUAAppServerRoutingContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAAppServerNetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUAAppServerDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UASCTPServerM3UASCTPServerDown
sub _1_3_6_1_4_1_1556_17_0_7350
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An M3UA SCTP server is down and not accepting connections. Cause - The SG is unable to establish a server socket with  the current configuration.  Possible Actions -  If unresolved hostname alarms exist for this server,  troubleshoot those first.  Once the hostnames resolve the  condition may clear. If using hostnames, ensure they are resolving properly to  IP addresses that are valid for the configured Slot. Use IP Networking > Hostname Resolution to verify hostname configuration. Use IP Networking > Network Interfaces > Routing IP Network to verify Slot IP addresses. If using IP addresses, ensure the IP addresses are valid for the configured Slot.   Use IP Networking > Network Interfaces > Routing IP Network to verify Slot IP addresses. If IP addressing appears to be correct, it is possible that the port is in use by another application.   Examine the current sockets on the system by using  IP Networking > IP Utilities > Open Sockets.\nTrapName = ptM3UASCTPServerM3UASCTPServerDown,\n";
    
    my $dat_notification_id = 1864;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAASPSuaAssocHighTransmitUsageOnset
sub _1_3_6_1_4_1_1556_17_0_7324
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The amount of traffic being transmitted to an SUA ASP has reached excessive levels. The conditions of this clear event are controlled by the user using the SUA High Usage Onset setting.\nTrapName = ptSUAASPSuaAssocHighTransmitUsageOnset,\n";
    
    my $dat_notification_id = 1865;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"})) {
        $dat_additional_text .= "\nptSGSUAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotInserted
sub _1_3_6_1_4_1_1556_17_0_6311
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Slot inserted/activated. Cause  - Slot inserted Action - None Freq   - Infrequent References - ptOriginatingOID:    DYNAMIC ptHwMon - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptSlotSlotInserted,\n";
    
    my $dat_notification_id = 1866;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1.1.1"})) {
        $dat_additional_text .= "\npthwmonSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paLinkUnaligned
sub _1_3_6_1_4_1_1556_17_0_8121
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA signaling link has lost alignment. Cause  - After a signaling link failure is detected, signaling link initial alignment will take place. The Alignment procedure  passes through a number of states and when the procedure  enters the state not aligned this trap is sent. Action - If the initial alignment procedure does not work, then the  operator will have to intervene in order that the link  alignment succeeds. Freq   - This trap will continue to appear each time the initial  alignment procedure enters the state not aligned. This may happen a number of times as the initial alignment  procedure is repeated until alignment has been completed successfully.  References 1) Q.703 , (07/96) Section 7.3  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paLinkUnaligned,\n";
    
    my $dat_notification_id = 1867;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.11"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL2State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.11"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UASCTPServersM3uaLicMajor
sub _1_3_6_1_4_1_1556_17_0_7236
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Major M3UA License Event has occurred\nTrapName = ptM3UASCTPServersM3uaLicMajor,\n";
    
    my $dat_notification_id = 1868;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDiscreteSensorCpuErrorDeassert
sub _1_3_6_1_4_1_1556_17_0_6323
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A discrete sensor CPU error alarm was deasserted Cause  - A discrete sensor no longer detects a CPU error condition Action - None Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptDiscreteSensorCpuErrorDeassert,\n";
    
    my $dat_notification_id = 1869;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCPUMemUsageCriticalAbated
sub _1_3_6_1_4_1_1556_17_0_6261
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Memory availability has returned to reasonable levels. Cause  - Applications have freed memory. Action - None. Freq   - Irregular. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     0 oic\nTrapName = ptSlotSlotCPUMemUsageCriticalAbated,\n";
    
    my $dat_notification_id = 1870;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"})) {
        $dat_additional_text .= "\nptSlotCPUMemoryUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotAvailableMemThresh10Exceeded
sub _1_3_6_1_4_1_1556_17_0_3182
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Memory availability has dropped below 10% of total memory.  The slot number shown in this trap indicates the origin of the alarm.   Cause  - Memory usage reached a certain threshold Action - Identify applications consuming memory Freq   - Irregular References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     1 fmic\nTrapName = ptSlotAvailableMemThresh10Exceeded,\n";
    
    my $dat_notification_id = 1871;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"})) {
        $dat_additional_text .= "\nptSlotCPUMemoryUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaMultiAssocConnLoss
sub _1_3_6_1_4_1_1556_17_0_7404
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An ASP multi association loss notification is sent when the connection between an ASP and SG is lost.\nTrapName = ptM3UAASPAssociationM3uaMultiAssocConnLoss,\n";
    
    my $dat_notification_id = 1872;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2UALinkM2uaL3LinkOscillationFilterSet
sub _1_3_6_1_4_1_1556_17_0_8172
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that Link Oscillation Filter Timer T32 has started\nTrapName = ptM2UALinkM2uaL3LinkOscillationFilterSet,\n";
    
    my $dat_notification_id = 1873;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2UALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2UALinkIID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2UALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2UALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"})) {
        $dat_additional_text .= "\nptMTPM2UALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2UALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotAvailableMemThresh40Cleared
sub _1_3_6_1_4_1_1556_17_0_3177
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Memory availability is restored to more than 40% of total memory. Cause  - Applications have freed memory. Action - None. Freq   - Irregular. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     0 oic\nTrapName = ptSlotAvailableMemThresh40Cleared,\n";
    
    my $dat_notification_id = 1874;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"})) {
        $dat_additional_text .= "\nptSlotCPUMemoryUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericL3LinkUsageHighSet
sub _1_3_6_1_4_1_1556_17_0_8437
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the average traffic over this link exceeds predefined threshold. There is potential for traffic loss if this condition persists. References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 51 Threshold crossed ptTrapClearType:     1 fmic\nTrapName = ptGenericLinkGenericL3LinkUsageHighSet,\n";
    
    my $dat_notification_id = 1875;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetLinksetOPCVerificationEnabled
sub _1_3_6_1_4_1_1556_17_0_8003
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The Linkset OPC verification field is set to enabled. Standard OPC verification will be performed for incoming message on this linkset\nTrapName = ptLinksetLinksetOPCVerificationEnabled,\n";
    
    my $dat_notification_id = 1876;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLinksetState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesDSCCongestionDiscardCleared
sub _1_3_6_1_4_1_1556_17_0_1850
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC Node has not discarded messages due to configured congestion handling for 5 minutes\nTrapName = ptDSCNodesDSCCongestionDiscardCleared,\n";
    
    my $dat_notification_id = 1877;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NADiscardMsuFromPeerClear
sub _1_3_6_1_4_1_1556_17_0_9959
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for MSU discarded from an MTP3 peer\nTrapName = ptMTP3NADiscardMsuFromPeerClear,\n";
    
    my $dat_notification_id = 1878;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPM3UAMsuDiscardClear
sub _1_3_6_1_4_1_1556_17_0_7375
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The discarded M3UA message alarm has been cleared as no further M3UA messages have been unexpectedly discarded.\nTrapName = ptM3UAASPM3UAMsuDiscardClear,\n";
    
    my $dat_notification_id = 1879;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.25"})) {
        $dat_additional_text .= "\nptSGM3UAASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.25"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptModificationRecordModRecInvalid
sub _1_3_6_1_4_1_1556_17_0_1833
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Modification Record entry is invalid. Check warnings  in the debuglog log for more information.\nTrapName = ptModificationRecordModRecInvalid,\n";
    
    my $dat_notification_id = 1880;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1830.1831.1.1.1"})) {
        $dat_additional_text .= "\nptDSCModificationRecordOrder = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1830.1831.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1830.1831.1.1.2"})) {
        $dat_additional_text .= "\nptDSCModificationRecordCommand = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1830.1831.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPSXHostNPGWPSXHostUp
sub _1_3_6_1_4_1_1556_17_0_1620
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW PSX Host is connected.\nTrapName = ptPSXHostNPGWPSXHostUp,\n";
    
    my $dat_notification_id = 1881;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwPSXHostPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.4"})) {
        $dat_additional_text .= "\nptnpgwPSXHostStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwPSXHostHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPM3uaAssocHighTransmitUsageOnset
sub _1_3_6_1_4_1_1556_17_0_7328
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The amount of traffic being transmitted to an M3UA ASP has reached excessive levels. The conditions of this clear event are controlled by the user using the M3UA High Usage Onset setting.\nTrapName = ptM3UAASPM3uaAssocHighTransmitUsageOnset,\n";
    
    my $dat_notification_id = 1882;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3SLSLinkAuditFailure
sub _1_3_6_1_4_1_1556_17_0_9985
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "MTP3 detected an unavailable link in an SLS Table. MSU loss is possible. \nThis alarm should resolve itself in less than four minutes. If this alarm does not clear itself you should consult ptidbglog to determine the routeset and/or link that is having an issue and prompt a regeneration of the SLS tables by changing routing in some way, such as resetting an unavailable link, changing the cost of a route, or resetting route state.\nTrapName = ptMTP3NAMtp3SLSLinkAuditFailure,\n";
    
    my $dat_notification_id = 1883;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSwitchNewRoot
sub _1_3_6_1_4_1_1556_17_0_6286
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A rapid spanning tree selected a new root in the network.  Cause  - Change in the IP network. Action - None. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Application - ptTrapType:          4  equipment alarm - ptTrapSeverity:      4  warning - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     2  oic\nTrapName = ptSwitchNewRoot,\n";
    
    my $dat_notification_id = 1884;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkOscillationFilterClear
sub _1_3_6_1_4_1_1556_17_0_8175
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that Link Oscillation Filter Timer T32 has expired\nTrapName = ptM2PALinkM2paL3LinkOscillationFilterClear,\n";
    
    my $dat_notification_id = 1885;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotAvailableMemThresh30Exceeded
sub _1_3_6_1_4_1_1556_17_0_3178
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Memory availability has dropped below 30% of total memory.  The slot number shown in this trap indicates the origin of the alarm.   Cause  - Memory usage reached a certain threshold Action - Identify applications consuming memory Freq   - Irregular References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     1 fmic\nTrapName = ptSlotAvailableMemThresh30Exceeded,\n";
    
    my $dat_notification_id = 1886;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"})) {
        $dat_additional_text .= "\nptSlotCPUMemoryUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIMFTrafficProcessImfTrafficLossClear
sub _1_3_6_1_4_1_1556_17_0_8401
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "IMF process has no traffic loss for last 5 minutes.\nTrapName = ptIMFTrafficProcessImfTrafficLossClear,\n";
    
    my $dat_notification_id = 1887;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1154.1155.1.1.1"})) {
        $dat_additional_text .= "\nptimfIMFTrafficProcessName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1154.1155.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1154.1155.1.1.2"})) {
        $dat_additional_text .= "\nptimfIMFTrafficProcessSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1154.1155.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotBackupSftpUploadFailure
sub _1_3_6_1_4_1_1556_17_0_6278
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A backup to an SFTP destination could not be completed. Cause  - Backup could not be transferred to remote SFTP destination Action - Check that SFTP keys have been exchanged, remote SFTP node state Freq   - Irregular\nTrapName = ptSlotSlotBackupSftpUploadFailure,\n";
    
    my $dat_notification_id = 1888;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.22"})) {
        $dat_additional_text .= "\nptSlotLastFailedSFTPBackupDestUserID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.22"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.23"})) {
        $dat_additional_text .= "\nptSlotLastFailedSFTPBackupDestDir = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.23"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.21"})) {
        $dat_additional_text .= "\nptSlotLastFailedSFTPBackupDestIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.21"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodeDSCNodeDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_1870
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one node debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptDSCNodeDSCNodeDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1889;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1.1.1"})) {
        $dat_additional_text .= "\nptDSCDSCNodeNodeDiameterID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1.1.31"})) {
        $dat_additional_text .= "\nptDSCDSCNodeName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1.1.31"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRouteRouteAccessible
sub _1_3_6_1_4_1_1556_17_0_7152
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a route is now accessible. Cause  - The route may become inaccessible for a number of reasons including - SS7 Node can no longer receive SS7 traffic - All links to this route have been removed  Action - Depends on the cause  Freq   - This trap will appear when the status of a route changes to inaccessible.   References  1) Q.703 , (07/96) Section 7.3  ptOriginatingOID:    DYNAMIC ptRoute ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType:     1 fmic\nTrapName = ptRouteRouteAccessible,\n";
    
    my $dat_notification_id = 1890;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.2"})) {
        $dat_additional_text .= "\nptMTPRouteAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.5"})) {
        $dat_additional_text .= "\nptMTPRouteState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.6"})) {
        $dat_additional_text .= "\nptMTPRouteLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRouteCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3NASGSyncSucc
sub _1_3_6_1_4_1_1556_17_0_7345
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MTP3 NA Sync Success notification is sent when Dinamo synchronizes with the newly added MTP3 NA configuration after a previous failure is corrected.\nTrapName = ptMTP3NAMtp3NASGSyncSucc,\n";
    
    my $dat_notification_id = 1891;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"})) {
        $dat_additional_text .= "\nptSGMTP3NANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.250.251.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3UAASPAssocUnresolvedRemoteHost2
sub _1_3_6_1_4_1_1556_17_0_7706
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that M3UA ASP Association Remote IP Address 2 hostname is not resolvable. Cause - The SG is unable to resolve the hostname. Possible Actions - If the DSC has been set up to use a DNS server,  ensure the DNS server is reachable and confirm that the hostname has been configured. If the hostname is intended to resolve locally, ensure the proper hostname entry  has been added using IP Networking > Hostname Resolution. Freq - This trap occurs when the configured hostname becomes unresolvable.\nTrapName = ptM3UAASPAssociationM3UAASPAssocUnresolvedRemoteHost2,\n";
    
    my $dat_notification_id = 1892;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIncomingADNRoutingTableDSCIncAdnDiscardConfigured
sub _1_3_6_1_4_1_1556_17_0_1835
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC routing table contains at least one table entry that is configured to discard messages.  This is highly discouraged.\nTrapName = ptIncomingADNRoutingTableDSCIncAdnDiscardConfigured,\n";
    
    my $dat_notification_id = 1893;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1810.1.1.1"})) {
        $dat_additional_text .= "\nptDSCIncomingADNRoutingTableTableName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1810.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAASPSuaAssocMinStreamsClear
sub _1_3_6_1_4_1_1556_17_0_7349
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SUA ASP association causing the minimum stream alarm has been aborted or removed\nTrapName = ptSUAASPSuaAssocMinStreamsClear,\n";
    
    my $dat_notification_id = 1894;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"})) {
        $dat_additional_text .= "\nptSGSUAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkLocalUninhibited
sub _1_3_6_1_4_1_1556_17_0_7136
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been uninhibited at the  local node by operator. References 1) Table 2 Q.752, End of local inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 43 Resource at or near capacity ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL3LinkLocalUninhibited,\n";
    
    my $dat_notification_id = 1895;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIsmOptPartitionThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_5526
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the ISM /opt partition usage has returned below its alarm threshold\nTrapName = ptIsmOptPartitionThresholdCleared,\n";
    
    my $dat_notification_id = 1896;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTGttProcessShutdown
sub _1_3_6_1_4_1_1556_17_0_4401
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates the GTT process is shutting down (gracefully). Cause: This may not be a failure, shutdown could be intentional.  If it is a failure, it may be caused by a number of reasons, including: - invalid config files - process received a terminating signal (SIGINT, SIGTERM) - system resources are at capacity Action: - make sure GTT was started with a valid base directory (-b switch) - restart GTT (system watchdog has this responsibility) - contact Sonus Networks Support for system resource issues Freq: This trap will appear every time GTT gracefully shuts down. References: ptOriginatingOID    : ptGTT ptTrapType          : 11 quality of service alarm ptTrapSeverity      : 2 major ptTrapProbableCause : 6 Communications subsystem error ptTrapClearType     : 1 fmic\nTrapName = ptGTTGttProcessShutdown,\n";
    
    my $dat_notification_id = 1897;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UASCTPServersM3uaLicClrMajor
sub _1_3_6_1_4_1_1556_17_0_7237
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Major M3UA License Event has been cleared\nTrapName = ptM3UASCTPServersM3uaLicClrMajor,\n";
    
    my $dat_notification_id = 1898;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotIPSubnet1Down
sub _1_3_6_1_4_1_1556_17_0_6252
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Communication loss on IP subnet 1 with this card. Cause  - IP path non-responsive. Action - Verify application communications. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      2 major - ptTrapProbableCause: 7 communication subsystem - ptTrapClearType:     1 fmic\nTrapName = ptSlotSlotIPSubnet1Down,\n";
    
    my $dat_notification_id = 1899;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"})) {
        $dat_additional_text .= "\nptSlotSecondaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"})) {
        $dat_additional_text .= "\nptSlotPrimaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIsmEtcPartitionThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_5530
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the ISM /var partition usage has returned below its alarm threshold\nTrapName = ptIsmEtcPartitionThresholdCleared,\n";
    
    my $dat_notification_id = 1900;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotStatusAvailable
sub _1_3_6_1_4_1_1556_17_0_6251
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A card has recovered and is responding. Cause  - Card is responsive. Action - None. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4  equipment alarm - ptTrapSeverity:      5  clear - ptTrapProbableCause: 11 quality of service  - ptTrapClearType:     1  fmic\nTrapName = ptSlotSlotStatusAvailable,\n";
    
    my $dat_notification_id = 1901;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"})) {
        $dat_additional_text .= "\nptSlotSecondaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"})) {
        $dat_additional_text .= "\nptSlotPrimaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkUsageHighClear
sub _1_3_6_1_4_1_1556_17_0_8139
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the average traffic over this link no longer exceeds predefined threshold. There is no longer potential for traffic loss due to extensive traffic. References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 51 Threshold crossed ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkUsageHighClear,\n";
    
    my $dat_notification_id = 1902;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAASPSuaAssocHighReceiveUsageOnset
sub _1_3_6_1_4_1_1556_17_0_7326
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The amount of traffic being transmitted to an SUA ASP on an association has received normal levels. The conditions of this clear event are controlled by the user using the SUA High Usage Onset setting.\nTrapName = ptSUAASPSuaAssocHighReceiveUsageOnset,\n";
    
    my $dat_notification_id = 1903;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"})) {
        $dat_additional_text .= "\nptSGSUAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkLocalBlocked
sub _1_3_6_1_4_1_1556_17_0_8115
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA signaling link has been blocked at the local node by  the operator. Cause  - Operator blocks a link. Action - Operator can unblock the link.  Freq   - Operator dependant. References 1) Q.704 Section 3.2       ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 56 Underlying resource unavailable ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paL3LinkLocalBlocked,\n";
    
    my $dat_notification_id = 1904;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptApplicationIDRoutingTableDSCAppIdDiscardConfiguredCleared
sub _1_3_6_1_4_1_1556_17_0_1840
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC routing table is no longer configured to discard messages.\nTrapName = ptApplicationIDRoutingTableDSCAppIdDiscardConfiguredCleared,\n";
    
    my $dat_notification_id = 1905;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1812.1.1.1"})) {
        $dat_additional_text .= "\nptDSCApplicationIDRoutingTableTableName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1812.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkLocalUnblocked
sub _1_3_6_1_4_1_1556_17_0_7186
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been unblocked at the local node  by the operator. References 1) Q.704 Section 3.2       ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 56 Underlying resource unavailable ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkLocalUnblocked,\n";
    
    my $dat_notification_id = 1906;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotUSBDeviceExtracted
sub _1_3_6_1_4_1_1556_17_0_3155
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All USB devices have been disconnected. Cause  - All USB devices removed from faceplate connector. Action - None. Freq   - Irregular.\nTrapName = ptSlotSlotUSBDeviceExtracted,\n";
    
    my $dat_notification_id = 1907;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANodeMTPRestartEnd
sub _1_3_6_1_4_1_1556_17_0_8190
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Local MTP Restart procedure has completed.\nTrapName = ptMTP3NANodeMTPRestartEnd,\n";
    
    my $dat_notification_id = 1908;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"})) {
        $dat_additional_text .= "\nptMTPMTP3NALocalPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkOscillationFilterClear
sub _1_3_6_1_4_1_1556_17_0_7196
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that Link Oscillation Filter Timer T32 has expired\nTrapName = ptAnnexALinkAnnexaL3LinkOscillationFilterClear,\n";
    
    my $dat_notification_id = 1909;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAConfiguredASPSUAConfASPResolvedHost1
sub _1_3_6_1_4_1_1556_17_0_7601
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SUA Configured ASP IP Address 1 hostname is resolved\nTrapName = ptSUAConfiguredASPSUAConfASPResolvedHost1,\n";
    
    my $dat_notification_id = 1910;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAManagerSccpWriteFailure
sub _1_3_6_1_4_1_1556_17_0_4205
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates a SCCP write to file failed.   Sent when a SCCP configuration or database write fails. Write failures include: - Invalid file permissions - Out of memory in file system\nTrapName = ptSCCPNAManagerSccpWriteFailure,\n";
    
    my $dat_notification_id = 1911;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3UAASPAssocResolvedRemoteHost1
sub _1_3_6_1_4_1_1556_17_0_7705
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "M3UA ASP Association Remote IP Address 1 hostname is resolved\nTrapName = ptM3UAASPAssociationM3UAASPAssocResolvedRemoteHost1,\n";
    
    my $dat_notification_id = 1912;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotIPSubnet2Down
sub _1_3_6_1_4_1_1556_17_0_6254
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Communication loss on IP subnet 2 with this card. Cause  - IP path non-responsive. Action - Verify application communications. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      2 major - ptTrapProbableCause: 7 communication subsystem - ptTrapClearType:     1 fmic\nTrapName = ptSlotSlotIPSubnet2Down,\n";
    
    my $dat_notification_id = 1913;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"})) {
        $dat_additional_text .= "\nptSlotSecondaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"})) {
        $dat_additional_text .= "\nptSlotPrimaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NADiscardMsuToL4Clear
sub _1_3_6_1_4_1_1556_17_0_9951
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for MSU destined to an L4 user has been discarded\nTrapName = ptMTP3NADiscardMsuToL4Clear,\n";
    
    my $dat_notification_id = 1914;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UASCTPServerM3UASCTPServerAddrListEqual
sub _1_3_6_1_4_1_1556_17_0_7363
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "M3UA SCTP Server is now listening on all expected addresses.\nTrapName = ptM3UASCTPServerM3UASCTPServerAddrListEqual,\n";
    
    my $dat_notification_id = 1915;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptTargetTargetLoadUnbalanced
sub _1_3_6_1_4_1_1556_17_0_5005
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Choose whether to force or ignore re-balancing in the target. Manually force re-balancing or ignore re-balancing in the target.\nTrapName = ptTargetTargetLoadUnbalanced,\n";
    
    my $dat_notification_id = 1916;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.5001.5002.5003.1.1.1"})) {
        $dat_additional_text .= "\nptLBTargetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.5001.5002.5003.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotMonitorSlotDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_3169
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All debug attributes are set to their recommended values.\nTrapName = ptSlotMonitorSlotDebugLevelRecommended,\n";
    
    my $dat_notification_id = 1917;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPSXHostNPGWPSXHostCongestedClear
sub _1_3_6_1_4_1_1556_17_0_1628
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW PSX Host is no longer congested.\nTrapName = ptPSXHostNPGWPSXHostCongestedClear,\n";
    
    my $dat_notification_id = 1918;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwPSXHostHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwPSXHostPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.3"})) {
        $dat_additional_text .= "\nptnpgwPSXHostCongestion = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotTmpDiskPartitionThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_6275
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "CPU /tmp partition usage has returned to acceptable levels. Cause  - /tmp partition usage below threshold. Action - None. Freq   - Irregular.\nTrapName = ptSlotSlotTmpDiskPartitionThresholdCleared,\n";
    
    my $dat_notification_id = 1919;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkAvailable
sub _1_3_6_1_4_1_1556_17_0_8184
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is available for user traffic. Clears atmL3LinkUnavailable. References 1) GR310CORE Issue 3 Section 8.1 2) GR246CORE Issue 10 3) GR82CORE  Issue 10 4) Q.704 ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptATMLinkAtmL3LinkAvailable,\n";
    
    my $dat_notification_id = 1920;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIsmOptPartitionThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_5525
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the ISM /opt partition usage has reached its alarm threshold\nTrapName = ptIsmOptPartitionThresholdExceeded,\n";
    
    my $dat_notification_id = 1921;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCpuUsageMinor
sub _1_3_6_1_4_1_1556_17_0_6240
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "CPU usage is high.  The slot number indicated in this trap indicates the origin of the alarm.  This condition can lead the kernel to indiscriminately terminate processes causing outage.  A process listing and top output can identify the offending process. Cause  - CPU usage above threshold Action - Identify applications running high on CPU Freq   - Irregular\nTrapName = ptSlotSlotCpuUsageMinor,\n";
    
    my $dat_notification_id = 1922;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptProcessEventLowerLayerNotConnectedCleared
sub _1_3_6_1_4_1_1556_17_0_8311
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the peer lower layer is no longer not connected.\nTrapName = ptProcessEventLowerLayerNotConnectedCleared,\n";
    
    my $dat_notification_id = 1923;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"})) {
        $dat_additional_text .= "\nptpeereventProcessEventSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"})) {
        $dat_additional_text .= "\nptpeereventProcessEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGWSTConfigurationGR310MesageLoss
sub _1_3_6_1_4_1_1556_17_0_1003
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Message loss was detected from at least one routing CPU to the active GR-310 server.\nTrapName = ptGWSTConfigurationGR310MesageLoss,\n";
    
    my $dat_notification_id = 1924;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL2LinkUnaligned
sub _1_3_6_1_4_1_1556_17_0_7191
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has lost alignment. Cause  - After a signaling link failure is detected , signaling link initial alignment will take place. The Alignment procedure  passes through a number of states and when the procedure  enters the state not aligned this trap is sent. Action - If the initial alignment procedure does not work then the  operator will have to intervene in order that the link  alignment succeeds. Freq   - This trap will continue to appear each time the initial  alignment procedure enters the state not aligned. This may happen a number of times as the initial alignment  procedure is repeated until alignment has been completed successfully.  References 1) Q.703 , (07/96) Section 7.3  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL2LinkUnaligned,\n";
    
    my $dat_notification_id = 1925;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.8"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL2State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAManagerSccpPeerUp
sub _1_3_6_1_4_1_1556_17_0_4203
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates a SCCP peer is reachable.   Sent when a SCCP peer communication is established via LDL.\nTrapName = ptSCCPNAManagerSccpPeerUp,\n";
    
    my $dat_notification_id = 1926;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NADiscardMsuToL2Clear
sub _1_3_6_1_4_1_1556_17_0_9953
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for MSU destined to SS7/IP network has been discarded\nTrapName = ptMTP3NADiscardMsuToL2Clear,\n";
    
    my $dat_notification_id = 1927;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkRemoteUnblocked
sub _1_3_6_1_4_1_1556_17_0_8114
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA signaling link has been unblocked at a remote node. Causes ,Corrective actions and Frequency   1) ptSpecificTrapCause = linkDeactivated  Cause  -  Unknown Cause 2) ptSpecificTrapCause = unknownCause References 1) Table 2 Q.752 Stop of Remote Processor Outage 2) Q.704 Section 3.3.5       ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 42 Remote node transmission error   ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paL3LinkRemoteUnblocked,\n";
    
    my $dat_notification_id = 1928;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexManualNetworkElementStarted
sub _1_3_6_1_4_1_1556_17_0_2037
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications manual network element monitoring started.\nTrapName = ptSS7DBAppsConfigurationSigFlexManualNetworkElementStarted,\n";
    
    my $dat_notification_id = 1929;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotAvailableMemThresh10Cleared
sub _1_3_6_1_4_1_1556_17_0_3183
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Memory availability is restored to more than 10% of total memory. Cause  - Applications have freed memory. Action - None. Freq   - Irregular. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     0 oic\nTrapName = ptSlotAvailableMemThresh10Cleared,\n";
    
    my $dat_notification_id = 1930;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"})) {
        $dat_additional_text .= "\nptSlotCPUMemoryUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaMultiAssocPathLoss
sub _1_3_6_1_4_1_1556_17_0_7340
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An path is down on a multi-homed user connection\nTrapName = ptM3UAASPAssociationM3uaMultiAssocPathLoss,\n";
    
    my $dat_notification_id = 1931;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIWFSS7IWFSS7Up
sub _1_3_6_1_4_1_1556_17_0_1908
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one SCCP Connection is connected.\nTrapName = ptIWFSS7IWFSS7Up,\n";
    
    my $dat_notification_id = 1932;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.7"})) {
        $dat_additional_text .= "\nptiwfIWFSS7ConnectivityStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.1"})) {
        $dat_additional_text .= "\nptiwfIWFSS7SCCPNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAConfiguredASPSUAConfASPResolvedHost2
sub _1_3_6_1_4_1_1556_17_0_7603
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SUA Configured ASP IP Address 2 hostname is resolved\nTrapName = ptSUAConfiguredASPSUAConfASPResolvedHost2,\n";
    
    my $dat_notification_id = 1933;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.211.212.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetLinksetPCMappingEmpty
sub _1_3_6_1_4_1_1556_17_0_8001
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The Linkset PC Mapping field is empty and PC Mapping will NOT be performed on this linkset.\nTrapName = ptLinksetLinksetPCMappingEmpty,\n";
    
    my $dat_notification_id = 1934;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLinksetState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptApplicationIDRoutingTableDSCAppIdDiscardConfigured
sub _1_3_6_1_4_1_1556_17_0_1839
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC routing table contains at least one table entry that is configured to discard messages.  This is highly discouraged.\nTrapName = ptApplicationIDRoutingTableDSCAppIdDiscardConfigured,\n";
    
    my $dat_notification_id = 1935;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1812.1.1.1"})) {
        $dat_additional_text .= "\nptDSCApplicationIDRoutingTableTableName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1812.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAAppServerM3UAAppServerNotActive
sub _1_3_6_1_4_1_1556_17_0_7300
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an App Server is not active.   Cause: No ASP has activated the associated routing context (RC). ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm  ptTrapSeverity: 1 critical  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType: 1 fmic\nTrapName = ptM3UAAppServerM3UAAppServerNotActive,\n";
    
    my $dat_notification_id = 1936;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerNetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerSI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerRoutingContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.9"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAAppServerDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.176.177.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7SLSLinkAuditFailureClear
sub _1_3_6_1_4_1_1556_17_0_9988
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an SLS Table Link Audit has concluded and this link is no longer included incorrectly in SLS Tables. The link may have been removed from SLS Tables, or its state may have changed so it is now appropriate for use in SLS Tables. Clears ss7SLSLinkAuditFailure. References None. This is an implementation specific audit. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptLSLinkSs7SLSLinkAuditFailureClear,\n";
    
    my $dat_notification_id = 1937;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptThresholdSensorLowerMinorDeassert
sub _1_3_6_1_4_1_1556_17_0_6347
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A threshold sensor lower minor alarm was deasserted Cause  - A threshold sensor no longer detects a lower minor condition Action - None Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptThresholdSensorLowerMinorDeassert,\n";
    
    my $dat_notification_id = 1938;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTDBDefGttOpcLoopDetect
sub _1_3_6_1_4_1_1556_17_0_4415
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "GTT OPC Loop Detection discarded messages. This alarm will clear automatically if no more message is discarded by OPC Loop Detection for 5 minutes.\nTrapName = ptGTTDBDefGttOpcLoopDetect,\n";
    
    my $dat_notification_id = 1939;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.683.684.1.1.1"})) {
        $dat_additional_text .= "\nptGTTGTTDBDefName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.683.684.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptProcessEventLowerLayerConnected
sub _1_3_6_1_4_1_1556_17_0_8313
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the peer lower layer is now connected.\nTrapName = ptProcessEventLowerLayerConnected,\n";
    
    my $dat_notification_id = 1940;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"})) {
        $dat_additional_text .= "\nptpeereventProcessEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"})) {
        $dat_additional_text .= "\nptpeereventProcessEventSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAASPSuaAssocPathLoss
sub _1_3_6_1_4_1_1556_17_0_7272
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A path is down on a multi-homed user connection\nTrapName = ptSUAASPSuaAssocPathLoss,\n";
    
    my $dat_notification_id = 1941;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"})) {
        $dat_additional_text .= "\nptSGSUAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAASPSUAMsuDiscardClear
sub _1_3_6_1_4_1_1556_17_0_7379
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The discarded SUA message alarm has been cleared as no further SUA messages have been unexpectedly discarded.\nTrapName = ptSUAASPSUAMsuDiscardClear,\n";
    
    my $dat_notification_id = 1942;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUAASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.25"})) {
        $dat_additional_text .= "\nptSGSUAASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.25"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"})) {
        $dat_additional_text .= "\nptSGSUAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptThresholdSensorLowerCriticalAssert
sub _1_3_6_1_4_1_1556_17_0_6350
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A threshold sensor lower critical alarm was asserted Cause  - A threshold sensor detects a lower critical condition Action - Verify sensor Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptThresholdSensorLowerCriticalAssert,\n";
    
    my $dat_notification_id = 1943;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPM3uaAssocHighReceiveUsageAbatement
sub _1_3_6_1_4_1_1556_17_0_7331
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The amount of traffic being received from an M3UA ASP has received normal levels. The conditions of this clear event are controlled by the user using the M3UA High Usage Abatement setting.\nTrapName = ptM3UAASPM3uaAssocHighReceiveUsageAbatement,\n";
    
    my $dat_notification_id = 1944;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANPGWMTP3NAUp
sub _1_3_6_1_4_1_1556_17_0_1612
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Atleast one NPGW MTP3 NA connection is connected.\nTrapName = ptMTP3NANPGWMTP3NAUp,\n";
    
    my $dat_notification_id = 1945;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwMTP3NANA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwMTP3NAStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1602.1603.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesTpsMissingUpdateClear
sub _1_3_6_1_4_1_1556_17_0_1861
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The number of missing TPS update does not exceed the threshold.\nTrapName = ptDSCNodesTpsMissingUpdateClear,\n";
    
    my $dat_notification_id = 1946;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCPULoadUsageCriticalAbated
sub _1_3_6_1_4_1_1556_17_0_6264
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "CPU load average has returned to reasonable levels. Cause  - Load Average below threshold. Action - None. Freq   - Irregular.\nTrapName = ptSlotSlotCPULoadUsageCriticalAbated,\n";
    
    my $dat_notification_id = 1947;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.19"})) {
        $dat_additional_text .= "\nptSlotCPULoadUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.19"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkUninhibitDenied
sub _1_3_6_1_4_1_1556_17_0_7141
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an attempt to uninhibit a signaling link has failed. This is a stateless trap (no alarm). Cause  - A request to uninhibit a link from the local node to a  destination will fail if all the routes to the destination are unavailable. Action - Operator will have to wait until a route to the destination becomes available in order that it can send an uninhibit link  message.  Freq   - Operator dependant. References 1) Q.704 , (07/96) Section 10.2        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 56 Underlying resource unavailable ptTrapClearType:     2 oic\nTrapName = ptATMLinkAtmL3LinkUninhibitDenied,\n";
    
    my $dat_notification_id = 1948;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationDuplicateDbRecordsCleared
sub _1_3_6_1_4_1_1556_17_0_2018
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SDA DB duplicate records alarm cleared.\nTrapName = ptSS7DBAppsConfigurationDuplicateDbRecordsCleared,\n";
    
    my $dat_notification_id = 1949;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexScrServerStart
sub _1_3_6_1_4_1_1556_17_0_2022
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications Scripting Server has started.\nTrapName = ptSS7DBAppsConfigurationSigFlexScrServerStart,\n";
    
    my $dat_notification_id = 1950;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASCCPNAsMsuDiscardClear
sub _1_3_6_1_4_1_1556_17_0_7373
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for MSU has been unexpectedly discarded on SCCP NA Connection.\nTrapName = ptSCCPNASCCPNAsMsuDiscardClear,\n";
    
    my $dat_notification_id = 1951;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.255.256.1.1.1"})) {
        $dat_additional_text .= "\nptSGSCCPNANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.255.256.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANodeStatusPendingLic
sub _1_3_6_1_4_1_1556_17_0_9979
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An attempt by the MTP3 NA to obtain a software license has failed\nTrapName = ptMTP3NANodeStatusPendingLic,\n";
    
    my $dat_notification_id = 1952;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.6"})) {
        $dat_additional_text .= "\nptMTPMTP3NAStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSigflexDiskPartitionThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_5516
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the directory referenced by the ptTrapDirectoryName variable has returned below its alarm threshold\nTrapName = ptSigflexDiskPartitionThresholdCleared,\n";
    
    my $dat_notification_id = 1953;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1019"})) {
        $dat_additional_text .= "\nptTrapDirectoryName = " . $entrada->{"1.3.6.1.4.1.1556.17.1019"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPortMpmtp2PortPrbsCleared
sub _1_3_6_1_4_1_1556_17_0_5816
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that PRBS test has been deactivated. Cause  - A user has deactivated PRBS testing. Action - None required Freq   - This trap will appear when the user instructs the port to stop performing PRBS testing, such as for BERT. References - ptOriginatingOID:    DYNAMIC ptPort - ptTrapType:          2 communication alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptPortMpmtp2PortPrbsCleared,\n";
    
    my $dat_notification_id = 1954;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWPortPortNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIOManagerMpmtp2UpperLayerConnectionLost
sub _1_3_6_1_4_1_1556_17_0_5800
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates all L3 connections are lost. Cause  - MTP2 has lost all Level 3 connections. Action - Check Level 3 Applications Freq   - Infrequent References - ptOriginatingOID:    DYNAMIC ptTDMCard - ptTrapType:          2 Communications - ptTrapSeverity:      4 Warning - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptIOManagerMpmtp2UpperLayerConnectionLost,\n";
    
    my $dat_notification_id = 1955;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1.1.13"})) {
        $dat_additional_text .= "\nptIOHWIOManagerCardType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1.1.13"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWIOManagerSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paLinkCongested
sub _1_3_6_1_4_1_1556_17_0_8119
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA signaling link is congested. Causes and Corrective Action   1) ptSpecificTrapCause = managementInitiated  Cause  - Protocol manager detects the condition.   2) ptSpecificTrapCause = linkCongestion  Cause  - Trap occurs when the thresholds for the number of MSUs in the transmission or re-transmission buffer are exceeded.   Action - Wait until the MSUs are sent . References 1) Q.704 , Section 3.8.2  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 49 Storage capacity problem ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paLinkCongested,\n";
    
    my $dat_notification_id = 1956;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAConfiguredASPM3UAConfASPEndPtConflictResolved
sub _1_3_6_1_4_1_1556_17_0_7505
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "IP Conflicts with existing M3UA Configured ASPs resolved\nTrapName = ptM3UAConfiguredASPM3UAConfASPEndPtConflictResolved,\n";
    
    my $dat_notification_id = 1957;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAConfiguredASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.186.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionADNConnAssocPathLoss
sub _1_3_6_1_4_1_1556_17_0_1814
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "ADN Connection path is down on a multi-homed user connection.\nTrapName = ptADNConnectionADNConnAssocPathLoss,\n";
    
    my $dat_notification_id = 1958;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotIPSubnet1Up
sub _1_3_6_1_4_1_1556_17_0_6253
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Communication with this card on IP subnet 1 is established. Cause  - IP path established. Action - None. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     1 fmic\nTrapName = ptSlotSlotIPSubnet1Up,\n";
    
    my $dat_notification_id = 1959;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"})) {
        $dat_additional_text .= "\nptSlotSecondaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"})) {
        $dat_additional_text .= "\nptSlotPrimaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptConnectionLocalHostResFailCleared
sub _1_3_6_1_4_1_1556_17_0_5002
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An IP address resolution can be made for the Local Host.  Connections from that address will pass.\nTrapName = ptConnectionLocalHostResFailCleared,\n";
    
    my $dat_notification_id = 1960;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.5001.5005.5006.1.1.1"})) {
        $dat_additional_text .= "\nptLBConnectionName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.5001.5005.5006.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptThresholdSensorUpperCriticalDeassert
sub _1_3_6_1_4_1_1556_17_0_6341
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A threshold sensor upper critical alarm was deasserted Cause  - A threshold sensor no longer detects an upper critical condition Action - None Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptThresholdSensorUpperCriticalDeassert,\n";
    
    my $dat_notification_id = 1961;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDBConnectionDBConnectionDown
sub _1_3_6_1_4_1_1556_17_0_1191
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DB Agent is not connected to its local database.\nTrapName = ptDBConnectionDBConnectionDown,\n";
    
    my $dat_notification_id = 1962;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1193.1.1.2"})) {
        $dat_additional_text .= "\nptdscdbDBConnectionConnectivityStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1193.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1193.1.1.1"})) {
        $dat_additional_text .= "\nptdscdbDBConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1193.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotIPSubnet2Up
sub _1_3_6_1_4_1_1556_17_0_6255
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Communication with this card on IP subnet 2 is established. Cause  - IP path established. Action - None. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     1 fmic\nTrapName = ptSlotSlotIPSubnet2Up,\n";
    
    my $dat_notification_id = 1963;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"})) {
        $dat_additional_text .= "\nptSlotSecondaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"})) {
        $dat_additional_text .= "\nptSlotPrimaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCPUMemUsageCritical
sub _1_3_6_1_4_1_1556_17_0_6260
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Memory availability has dropped below the Free Memory Threshold configured in the Web UI.  The slot number shown in this trap indicates the origin of the alarm.  This condition can lead the kernel to indiscriminately terminate processes causing outage.  A process listing and top output can identify the offending process. Cause  - Memory usage it too high Action - Identify applications consuming memory Freq   - Irregular References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     1 fmic\nTrapName = ptSlotSlotCPUMemUsageCritical,\n";
    
    my $dat_notification_id = 1964;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"})) {
        $dat_additional_text .= "\nptSlotCPUMemoryUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesLoadConfigError
sub _1_3_6_1_4_1_1556_17_0_1813
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A configuration file has one or more errors. Check warnings  in the debuglog log for more information.\nTrapName = ptDSCNodesLoadConfigError,\n";
    
    my $dat_notification_id = 1965;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCRoutingTablesDSCRoutingLoop
sub _1_3_6_1_4_1_1556_17_0_1809
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC detects routing lookup runs too deep.\nTrapName = ptDSCRoutingTablesDSCRoutingLoop,\n";
    
    my $dat_notification_id = 1966;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPM3uaAssocHighReceiveUsageOnset
sub _1_3_6_1_4_1_1556_17_0_7330
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The amount of traffic being transmitted to an M3UA ASP on an association has received normal levels. The conditions of this clear event are controlled by the user using the M3UA High Usage Onset setting.\nTrapName = ptM3UAASPM3uaAssocHighReceiveUsageOnset,\n";
    
    my $dat_notification_id = 1967;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPConnectionIWFSCCPConnectionUp
sub _1_3_6_1_4_1_1556_17_0_1910
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP Connection is connected.\nTrapName = ptSCCPConnectionIWFSCCPConnectionUp,\n";
    
    my $dat_notification_id = 1968;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1906.1907.1.1.1"})) {
        $dat_additional_text .= "\nptiwfSCCPConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1906.1907.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1906.1907.1.1.2"})) {
        $dat_additional_text .= "\nptiwfSCCPConnectionConnectivityStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1906.1907.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUASCTPServerSUASCTPServerUp
sub _1_3_6_1_4_1_1556_17_0_7357
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An SUA SCTP server is up\nTrapName = ptSUASCTPServerSUASCTPServerUp,\n";
    
    my $dat_notification_id = 1969;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericLinkSCTPAvailable
sub _1_3_6_1_4_1_1556_17_0_8427
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a Generic Link SCTP Association has been established. Clears GenericLinkSCTPUnavailable. References 1) GR310CORE Issue 3 Section 8.6 (REPT-SCTP-ASOCESTB) ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:  29 Loss of signal    ptTrapClearType:       1 fmic\nTrapName = ptGenericLinkGenericLinkSCTPAvailable,\n";
    
    my $dat_notification_id = 1970;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paLinkSCTPAvailable
sub _1_3_6_1_4_1_1556_17_0_8127
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA SCTP Association has been established. Clears m2paLinkSCTPUnavailable. References 1) GR310CORE Issue 3 Section 8.6 (REPT-SCTP-ASOCESTB) ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:  29 Loss of signal    ptTrapClearType:       1 fmic\nTrapName = ptM2PALinkM2paLinkSCTPAvailable,\n";
    
    my $dat_notification_id = 1971;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.6"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2UALinkM2uaL3LinkAlarmsEnabled
sub _1_3_6_1_4_1_1556_17_0_8145
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "M2UA Link alarms are enabled.\nTrapName = ptM2UALinkM2uaL3LinkAlarmsEnabled,\n";
    
    my $dat_notification_id = 1972;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2UALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2UALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2UALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2UALinkIID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"})) {
        $dat_additional_text .= "\nptMTPM2UALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2UALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotAvailableMemThresh30Cleared
sub _1_3_6_1_4_1_1556_17_0_3179
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Memory availability is restored to more than 30% of total memory. Cause  - Applications have freed memory. Action - None. Freq   - Irregular. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     0 oic\nTrapName = ptSlotAvailableMemThresh30Cleared,\n";
    
    my $dat_notification_id = 1973;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"})) {
        $dat_additional_text .= "\nptSlotCPUMemoryUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkOscillationFilterClear
sub _1_3_6_1_4_1_1556_17_0_8169
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that Link Oscillation Filter Timer T32 has expired\nTrapName = ptLSLinkSs7L3LinkOscillationFilterClear,\n";
    
    my $dat_notification_id = 1974;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAMultiAssociationASPM3UAMultiAssocDiscardClear
sub _1_3_6_1_4_1_1556_17_0_7377
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The discarded M3UA Multi ASP message alarm has been cleared as no further message have been discarded.\nTrapName = ptM3UAMultiAssociationASPM3UAMultiAssocDiscardClear,\n";
    
    my $dat_notification_id = 1975;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAMultiAssociationASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAMultiAssociationASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTConfigurationGttLicenseWarning
sub _1_3_6_1_4_1_1556_17_0_4408
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that GTT process cannot connect to the license process.\nTrapName = ptGTTConfigurationGttLicenseWarning,\n";
    
    my $dat_notification_id = 1976;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotTmpDiskPartitionThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_6274
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "CPU /tmp partition usage is above the alarm threshold defined in  disk_space_quota.  The slot number indicated in this trap indicates the origin of the alarm.   Cause  - /tmp partition usage above threshold Action - Identify applications running high on disk space Freq   - Irregular\nTrapName = ptSlotSlotTmpDiskPartitionThresholdExceeded,\n";
    
    my $dat_notification_id = 1977;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSNAMIConfigurationGR310TL1ConnDown
sub _1_3_6_1_4_1_1556_17_0_1501
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "On session request, the TL1 connection cannot be established by GR310 server.  The event will be cleared if no other occurrences is raised in the next  5 minutes.\nTrapName = ptSNAMIConfigurationGR310TL1ConnDown,\n";
    
    my $dat_notification_id = 1978;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L2LinkUncongested
sub _1_3_6_1_4_1_1556_17_0_7120
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is no longer congested. Causes and Frequency   1) ptSpecificTrapCause = managementInitiated  Cause  - Protocol Manager detects the condition 2) ptSpecificTrapCause = linkUncongested  Cause  - Trap occurs when the number of MSUs in the transmission or re-transmission buffer goes from a value in excess of the thresholds for congestion to a value which is less  than the thresholds.    Freq   - Dependant on throughput of MSUs . References 1) Q.704 , Section 3.8.2  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 49 Storage capacity problem ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L2LinkUncongested,\n";
    
    my $dat_notification_id = 1979;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL2LinkCongested
sub _1_3_6_1_4_1_1556_17_0_7189
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is congested. Causes and Corrective Action   1) ptSpecificTrapCause = managementInitiated  Cause  - Protocol manager detects the condition.   2) ptSpecificTrapCause = linkCongestion  Cause  - Trap occurs when the thresholds for the number of MSUs in the transmission or re-transmission buffer are exceeded.   Action - Wait until the MSUs are sent . References 1) Q.704 , Section 3.8.2  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 49 Storage capacity problem ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL2LinkCongested,\n";
    
    my $dat_notification_id = 1980;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASccpNADiscardMSUUserClear
sub _1_3_6_1_4_1_1556_17_0_4217
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for MSU has been discarded by a SCCP User Connection.\nTrapName = ptSCCPNASccpNADiscardMSUUserClear,\n";
    
    my $dat_notification_id = 1981;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"})) {
        $dat_additional_text .= "\nptSCCPSCCPNAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.85.87.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIWFSS7IWFSCCPResponseNoMatch
sub _1_3_6_1_4_1_1556_17_0_1917
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The IWF received an SCCP response with no match in the last 5 minutes.\nTrapName = ptIWFSS7IWFSCCPResponseNoMatch,\n";
    
    my $dat_notification_id = 1982;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.1"})) {
        $dat_additional_text .= "\nptiwfIWFSS7SCCPNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.7"})) {
        $dat_additional_text .= "\nptiwfIWFSS7ConnectivityStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPM3uaAssocMinStreamsFail
sub _1_3_6_1_4_1_1556_17_0_7346
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An M3UA ASP association has been established with less than the minimum 2 steam requirement\nTrapName = ptM3UAASPM3uaAssocMinStreamsFail,\n";
    
    my $dat_notification_id = 1983;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexDBAuditFailure
sub _1_3_6_1_4_1_1556_17_0_2032
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications database audit failed.\nTrapName = ptSS7DBAppsConfigurationSigFlexDBAuditFailure,\n";
    
    my $dat_notification_id = 1984;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3NADebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_8210
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: At least one debug attribute is not set to the recommended value. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their recommended values.\nTrapName = ptMTP3NAMtp3NADebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 1985;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UASCTPServerM3UASCTPServerResolvedHost1
sub _1_3_6_1_4_1_1556_17_0_7353
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "M3UA SCTP Server Hostname 1 is resolved\nTrapName = ptM3UASCTPServerM3UASCTPServerResolvedHost1,\n";
    
    my $dat_notification_id = 1986;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUASCTPServersSuaLicMajor
sub _1_3_6_1_4_1_1556_17_0_7240
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Major SUA License Event has occurred\nTrapName = ptSUASCTPServersSuaLicMajor,\n";
    
    my $dat_notification_id = 1987;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericLinkSCTPPathUnavailable
sub _1_3_6_1_4_1_1556_17_0_8428
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the SCTP Association that carries traffic is operating in a vulnerable state, an additional path failure could cause a link failure. Cleared by GenericLinkSCTPPathAvailable. Cause  - Most likely an IP Network issue. Action - Troubleshoot IP connectivity. Freq   - Operator dependant. References This trap is implementation specific. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        3 minor ptTrapProbableCause:  29 Loss of signal    ptTrapClearType:       1 fmic\nTrapName = ptGenericLinkGenericLinkSCTPPathUnavailable,\n";
    
    my $dat_notification_id = 1988;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptProcessEventLowerLayerNotConnected
sub _1_3_6_1_4_1_1556_17_0_8310
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the peer lower layer is not connected. Not raised during initialization.\nTrapName = ptProcessEventLowerLayerNotConnected,\n";
    
    my $dat_notification_id = 1989;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"})) {
        $dat_additional_text .= "\nptpeereventProcessEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"})) {
        $dat_additional_text .= "\nptpeereventProcessEventSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationDuplicateDbRecordsFound
sub _1_3_6_1_4_1_1556_17_0_2017
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SDA DB Audit detected duplicate records.\nTrapName = ptSS7DBAppsConfigurationDuplicateDbRecordsFound,\n";
    
    my $dat_notification_id = 1990;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPAppIDRegistrationINAPGWSCCPAppIDFailure
sub _1_3_6_1_4_1_1556_17_0_1309
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP AppID registration was not successful on all the defined SCCP connections.\nTrapName = ptSCCPAppIDRegistrationINAPGWSCCPAppIDFailure,\n";
    
    my $dat_notification_id = 1991;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1305.1307.1.1.1"})) {
        $dat_additional_text .= "\nptinapgwSCCPAppIDRegistrationNA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1305.1307.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1305.1307.1.1.2"})) {
        $dat_additional_text .= "\nptinapgwSCCPAppIDRegistrationApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1305.1307.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1305.1307.1.1.3"})) {
        $dat_additional_text .= "\nptinapgwSCCPAppIDRegistrationStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1305.1307.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkOscillationFilterSet
sub _1_3_6_1_4_1_1556_17_0_7195
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that Link Oscillation Filter Timer T32 has started\nTrapName = ptAnnexALinkAnnexaL3LinkOscillationFilterSet,\n";
    
    my $dat_notification_id = 1992;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptTopologyOneToOnePublicMappingTopoMapRowMisconfig
sub _1_3_6_1_4_1_1556_17_0_1830
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Topology Mapping misconfiguration: Private DID Host probably mis-configured as Public DID Host.\nTrapName = ptTopologyOneToOnePublicMappingTopoMapRowMisconfig,\n";
    
    my $dat_notification_id = 1993;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1850.1851.1.1.2"})) {
        $dat_additional_text .= "\nptDSCTopologyOneToOnePublicMappingPrivateDIDHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1850.1851.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1850.1851.1.1.1"})) {
        $dat_additional_text .= "\nptDSCTopologyOneToOnePublicMappingRealm = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1850.1851.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1850.1851.1.1.3"})) {
        $dat_additional_text .= "\nptDSCTopologyOneToOnePublicMappingPublicDIDHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1803.1850.1851.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPortMpmtp2PortStatusMajorClear
sub _1_3_6_1_4_1_1556_17_0_5819
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the major port status events have cleared Cause  - All phyical port or link problems contributing to the major port status events have been rectified. Action - None required Freq   - This trap will appear when the user sets the Loopback attribute to DISABLED.  or the system has started with this configured value for Loopback Mode. References - ptOriginatingOID:    DYNAMIC ptPort - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 6 Communications subsystem error - ptTrapClearType:     1 fmic\nTrapName = ptPortMpmtp2PortStatusMajorClear,\n";
    
    my $dat_notification_id = 1994;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWPortPortNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCpuUsageCriticalThresholdCrossed
sub _1_3_6_1_4_1_1556_17_0_5521
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that CPU Usage has crossed its critical alarm threshold on a CPU Core\nTrapName = ptCpuUsageCriticalThresholdCrossed,\n";
    
    my $dat_notification_id = 1995;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1021"})) {
        $dat_additional_text .= "\nptTrapCpuUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.1021"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1020"})) {
        $dat_additional_text .= "\nptTrapCpuCore = " . $entrada->{"1.3.6.1.4.1.1556.17.1020"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkLocalUnblocked
sub _1_3_6_1_4_1_1556_17_0_7116
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been unblocked at the local node  by the operator. References 1) Q.704 Section 3.2       ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 56 Underlying resource unavailable ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L3LinkLocalUnblocked,\n";
    
    my $dat_notification_id = 1996;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPPCSSNRegistrationIWFSCCPPCSSNFailure
sub _1_3_6_1_4_1_1556_17_0_1911
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP PC-SSN Registration was unsuccessful on all the defined SCCP Connections.\nTrapName = ptSCCPPCSSNRegistrationIWFSCCPPCSSNFailure,\n";
    
    my $dat_notification_id = 1997;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1909.1.1.1"})) {
        $dat_additional_text .= "\nptiwfSCCPPCSSNRegistrationPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1909.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1909.1.1.3"})) {
        $dat_additional_text .= "\nptiwfSCCPPCSSNRegistrationStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1909.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1909.1.1.2"})) {
        $dat_additional_text .= "\nptiwfSCCPPCSSNRegistrationSSN = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1905.1908.1909.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkAlarmsDisabled
sub _1_3_6_1_4_1_1556_17_0_8100
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "LS Link alarms are disabled.\nTrapName = ptLSLinkSs7L3LinkAlarmsDisabled,\n";
    
    my $dat_notification_id = 1998;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptThresholdSensorUpperMajorDeassert
sub _1_3_6_1_4_1_1556_17_0_6343
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A threshold sensor upper major alarm was deasserted Cause  - A threshold sensor no longer detects an upper major condition Action - None Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptThresholdSensorUpperMajorDeassert,\n";
    
    my $dat_notification_id = 1999;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptProcessEventIMFMgrConnected
sub _1_3_6_1_4_1_1556_17_0_8309
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the peer IMF manager is connected.\nTrapName = ptProcessEventIMFMgrConnected,\n";
    
    my $dat_notification_id = 2000;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"})) {
        $dat_additional_text .= "\nptpeereventProcessEventSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"})) {
        $dat_additional_text .= "\nptpeereventProcessEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkActivated
sub _1_3_6_1_4_1_1556_17_0_7174
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been activated either by the operator or as a result of a successful restoration  which was initiated upon detection of an inactive link. This trap could also be generated at restart without a previous corresponding trap 201. References 1)  Q.752, SL Restoration 2)  Q.704, (07/96) Section 12.2 ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 29 Loss of signal  ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkActivated,\n";
    
    my $dat_notification_id = 2001;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAManagerMtp3NAManagerConfigWriteError
sub _1_3_6_1_4_1_1556_17_0_9983
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that there was an error writing the MTP3 NA Manager configuration file to disk.  Recent changes may not have been committed to persistent storage. This is a stateless trap (no alarm). Cause  - A configuration file write could fail for a number of reasons, including but not limited to - disk full - file permissions - temporary file and real file are on different mount points If the cause is not evident, the corresponding syslog entry may have more details. Action - Resolve the issue with the disk, then prompt a rewrite of the configuration file by modifying a value in the UI. Freq   - This trap occurs if there is an error committing the configuration to persistent storage. References  None.  This is implementation specific.\nTrapName = ptMTP3NAManagerMtp3NAManagerConfigWriteError,\n";
    
    my $dat_notification_id = 2002;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAConnectionNPGWSCCPNAConnectionUp
sub _1_3_6_1_4_1_1556_17_0_1606
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP NA connection is connected.\nTrapName = ptSCCPNAConnectionNPGWSCCPNAConnectionUp,\n";
    
    my $dat_notification_id = 2003;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1609.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwSCCPNAConnectionStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1609.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1609.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwSCCPNAConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1609.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAASPSuaAssocHighTransmitUsageAbatement
sub _1_3_6_1_4_1_1556_17_0_7325
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The amount of traffic being transmitted to an SUA ASP has received normal levels. The conditions of this clear event are controlled by the user using the SUA High Usage Abatement setting.\nTrapName = ptSUAASPSuaAssocHighTransmitUsageAbatement,\n";
    
    my $dat_notification_id = 2004;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"})) {
        $dat_additional_text .= "\nptSGSUAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.207.208.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPSXHostNPGWPSXHostDown
sub _1_3_6_1_4_1_1556_17_0_1619
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW PSX Host is not connected.\nTrapName = ptPSXHostNPGWPSXHostDown,\n";
    
    my $dat_notification_id = 2005;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwPSXHostHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.4"})) {
        $dat_additional_text .= "\nptnpgwPSXHostStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwPSXHostPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptTransportServerServerLocalEndPointConflictCleared
sub _1_3_6_1_4_1_1556_17_0_1827
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC server SCTP local end point conflict has been resolved. Note that deactivating the server clears the conflict.\nTrapName = ptTransportServerServerLocalEndPointConflictCleared,\n";
    
    my $dat_notification_id = 2006;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.5"})) {
        $dat_additional_text .= "\nptDSCTransportServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.6"})) {
        $dat_additional_text .= "\nptDSCTransportServerHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.1"})) {
        $dat_additional_text .= "\nptDSCTransportServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkFailCraftRefTimerExpiry
sub _1_3_6_1_4_1_1556_17_0_7163
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the fail link craft referral timer expired without having signaling link activated. The fail link craft referral timer is the duration allowed for a signaling link to come into service. After expiry of this timer, this alarm is generated as per the system configuration. This is a stateless trap (no alarm). References 1) GR246 Core, section 12.2.1, 12.3.1, 12.3.2 2) GR-82-CORE,  CR6-43 [673] ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 29 Loss of signal  ptTrapClearType:     2 oic\nTrapName = ptATMLinkAtmL3LinkFailCraftRefTimerExpiry,\n";
    
    my $dat_notification_id = 2007;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCICUAASPCicUserConnEstablished
sub _1_3_6_1_4_1_1556_17_0_7219
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A CIC UA connection established notification is sent when the connection between an ASP and Dinamo is established.\nTrapName = ptCICUAASPCicUserConnEstablished,\n";
    
    my $dat_notification_id = 2008;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.217.222.223.1.1.1"})) {
        $dat_additional_text .= "\nptSGCICUAASPHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.217.222.223.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.217.222.223.1.1.2"})) {
        $dat_additional_text .= "\nptSGCICUAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.217.222.223.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.217.222.223.1.1.3"})) {
        $dat_additional_text .= "\nptSGCICUAASPASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.217.222.223.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotMonitorSlotDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_3168
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptSlotMonitorSlotDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 2009;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPortMpmtp2PortLoopbackSet
sub _1_3_6_1_4_1_1556_17_0_5810
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the loopback mode setting has been changed from the default DISABLED mode Cause  - A user has modified the attribute Action - Reset to DISABLED for normal operation Freq   - This trap will appear when the user sets the Loopback mode attribute to anything other than DISABLED References - ptOriginatingOID:    DYNAMIC ptPort - ptTrapType:          2 communication alarm - ptTrapSeverity:      3 minor - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptPortMpmtp2PortLoopbackSet,\n";
    
    my $dat_notification_id = 2010;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.10"})) {
        $dat_additional_text .= "\nptIOHWPortLoopbackMode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWPortPortNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptL4ConverterL4cvtrPeerDown
sub _1_3_6_1_4_1_1556_17_0_4104
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates a L4Cvtr peer is no longer reachable.   Sent when a L4Cvtr peer communication is lost via LDL. Peer connectivity interruptions include: - L4Cvtr peer is terminated - IP connectivity heartbeat/keep alive fails - IP connectivity is lost between L4Cvtr processes.\nTrapName = ptL4ConverterL4cvtrPeerDown,\n";
    
    my $dat_notification_id = 2011;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkUsageHighClear
sub _1_3_6_1_4_1_1556_17_0_8131
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the average traffic over this link no longer exceeds predefined threshold. There is no longer potential for traffic loss due to extensive traffic. References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 51 Threshold crossed ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paL3LinkUsageHighClear,\n";
    
    my $dat_notification_id = 2012;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexAppProcessingError
sub _1_3_6_1_4_1_1556_17_0_2042
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications application processing error.\nTrapName = ptSS7DBAppsConfigurationSigFlexAppProcessingError,\n";
    
    my $dat_notification_id = 2013;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAM3UAASMasterActive
sub _1_3_6_1_4_1_1556_17_0_7317
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the AS Master is now active for an NA. Cause: All AS of type AS Master for that NA are now active. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm ptTrapSeverity: 5 cleared ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType: 1 fmic\nTrapName = ptMTP3NAM3UAASMasterActive,\n";
    
    my $dat_notification_id = 2014;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPSXNPGWPSXUp
sub _1_3_6_1_4_1_1556_17_0_1624
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW PSX is connected.\nTrapName = ptPSXNPGWPSXUp,\n";
    
    my $dat_notification_id = 2015;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwPSXName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.3"})) {
        $dat_additional_text .= "\nptnpgwPSXStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaSP2KMultiAssocDeactivated
sub _1_3_6_1_4_1_1556_17_0_7368
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An M3UA multi association has been deactivated by the user.  Possible uses are to block an ASP from connecting whilst performing  configuration maintenance.\nTrapName = ptM3UAASPAssociationM3uaSP2KMultiAssocDeactivated,\n";
    
    my $dat_notification_id = 2016;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkOscillationFilterSet
sub _1_3_6_1_4_1_1556_17_0_8174
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that Link Oscillation Filter Timer T32 has started\nTrapName = ptM2PALinkM2paL3LinkOscillationFilterSet,\n";
    
    my $dat_notification_id = 2017;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTConfigurationGttDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_4420
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptGTTConfigurationGttDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 2018;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRoutesetRoutesetAccessible
sub _1_3_6_1_4_1_1556_17_0_7154
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a routeset is now accessible. Cause  - The routeset may become accessible for a number of reasons including - SS7 Node can now receive SS7 traffic - Routes in the routeset have become accessible  Action - Depends on the cause  Freq - This trap will appear when the status of a routeset changes to accessible.   References  1) Q.703 , (07/96) Section 7.3  ptOriginatingOID:    DYNAMIC ptRouteset  ptTrapType:          2 communicationAlarm  ptTrapSeverity:      5 cleared  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptRoutesetRoutesetAccessible,\n";
    
    my $dat_notification_id = 2019;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRoutesetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"})) {
        $dat_additional_text .= "\nptMTPRoutesetDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"})) {
        $dat_additional_text .= "\nptMTPRoutesetContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"})) {
        $dat_additional_text .= "\nptMTPRoutesetDestinationState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NADiscardMsuToL4Set
sub _1_3_6_1_4_1_1556_17_0_9950
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MSU destined to an L4 user has been discarded within the last 30 seconds\nTrapName = ptMTP3NADiscardMsuToL4Set,\n";
    
    my $dat_notification_id = 2020;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIOManagerMpmtp2UpperLayerConnectionGained
sub _1_3_6_1_4_1_1556_17_0_5801
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates at least one L3 connection has been made. Cause  - MTP2 has made at least one connection to a Level 3 application. Action - None Freq   - Infrequent References - ptOriginatingOID:    DYNAMIC ptTDMCard - ptTrapType:          2 Communications - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptIOManagerMpmtp2UpperLayerConnectionGained,\n";
    
    my $dat_notification_id = 2021;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1.1.13"})) {
        $dat_additional_text .= "\nptIOHWIOManagerCardType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1.1.13"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWIOManagerSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCICUAAppServerFailedCloseCicServer
sub _1_3_6_1_4_1_1556_17_0_7200
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Failed to close CIC UA TCP Server.\nTrapName = ptCICUAAppServerFailedCloseCicServer,\n";
    
    my $dat_notification_id = 2022;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.2"})) {
        $dat_additional_text .= "\nptSGCICUAAppServerDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.5"})) {
        $dat_additional_text .= "\nptSGCICUAAppServerStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.5"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkFailCraftRefTimerExpiry
sub _1_3_6_1_4_1_1556_17_0_7193
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the fail link craft referral timer expired without having signaling link activated. The fail link craft referral timer is the duration allowed for a signaling link to come into service. After expiry of this timer, this alarm is generated as per the system configuration. This is a stateless trap (no alarm). References 1) GR246 Core, section 12.2.1, 12.3.1, 12.3.2 2) GR-82-CORE,  CR6-43 [673] ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 29 Loss of signal  ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkFailCraftRefTimerExpiry,\n";
    
    my $dat_notification_id = 2023;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUASCTPServerSUASCTPServerAddrListEqual
sub _1_3_6_1_4_1_1556_17_0_7365
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "M3UA SCTP Server is now listening on all expected addresses.\nTrapName = ptSUASCTPServerSUASCTPServerAddrListEqual,\n";
    
    my $dat_notification_id = 2024;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericL3LinkActivated
sub _1_3_6_1_4_1_1556_17_0_8425
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a Generic signaling link has been activated either by operator or as a result of a successful restoration  which was initiated upon detection of an inactive link. This trap could also be generated at restart without a previous corresponding trap 201. References 1)  Q.752, SL Restoration 2)  Q.704, (07/96) Section 12.2 ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 29 Loss of signal  ptTrapClearType:     1 fmic\nTrapName = ptGenericLinkGenericL3LinkActivated,\n";
    
    my $dat_notification_id = 2025;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMSAMsaThreshold1Crossed
sub _1_3_6_1_4_1_1556_17_0_8200
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the MSA threshold 1 is crossed.\nTrapName = ptMSAMsaThreshold1Crossed,\n";
    
    my $dat_notification_id = 2026;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.961.962.1.1.1"})) {
        $dat_additional_text .= "\nptmsaMSAName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.961.962.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptL2ConnectionL2ModuleAccessible
sub _1_3_6_1_4_1_1556_17_0_7158
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an MTP2 is now accessible. Cause  - An MTP2 may become inaccessible for a number of reasons including - MTP2 failure - Communication failure in the IP network leading to MTP2 The cause of the clear depends on the failure cause. Action - None. Freq   - This trap will appear when the status of an MTP2 changes to accessible.   References  None.  This is implementation specific.\nTrapName = ptL2ConnectionL2ModuleAccessible,\n";
    
    my $dat_notification_id = 2027;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.61.48.1.1.3"})) {
        $dat_additional_text .= "\nptMTPL2ConnectionCageID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.61.48.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2UALinkM2uaL3LinkUsageHighClear
sub _1_3_6_1_4_1_1556_17_0_8133
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the average traffic over this link no longer exceeds predefined threshold. There is no longer potential for traffic loss due to extensive traffic. References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 51 Threshold crossed ptTrapClearType:     1 fmic\nTrapName = ptM2UALinkM2uaL3LinkUsageHighClear,\n";
    
    my $dat_notification_id = 2028;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"})) {
        $dat_additional_text .= "\nptMTPM2UALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2UALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2UALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2UALinkIID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2UALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2UALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkAvailable
sub _1_3_6_1_4_1_1556_17_0_8180
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is available for user traffic. Clears ss7L3LinkUnavailable. References 1) GR310CORE Issue 3 Section 8.1 2) GR246CORE Issue 10 3) GR82CORE  Issue 10 4) Q.704 ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptLSLinkSs7L3LinkAvailable,\n";
    
    my $dat_notification_id = 2029;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetSs7LinksetHalfOfLinksAvailable
sub _1_3_6_1_4_1_1556_17_0_8151
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that more than half of the links of an SS7 linkset are available Cause  - The linkset has more than half of the links available Action - Depends on cause  Freq   - This trap will appear when more than half of the links become available  ptOriginatingOID:    DYNAMIC ptLinkset ptTrapType:          2 communicationAlarm  ptTrapSeverity:      2 cleared  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptLinksetSs7LinksetHalfOfLinksAvailable,\n";
    
    my $dat_notification_id = 2030;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLinksetState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAM3UAASMasterNAMatch
sub _1_3_6_1_4_1_1556_17_0_7319
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an AS Master has NA data matched  on both the C20 Core and the SG. It clears the mismatch alarm. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm ptTrapSeverity: 5 cleared ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType: 1 fmic\nTrapName = ptM3UAM3UAASMasterNAMatch,\n";
    
    my $dat_notification_id = 2031;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGR310ServerConfigurationGR310ServerDown
sub _1_3_6_1_4_1_1556_17_0_1507
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The GR310 server is down.\nTrapName = ptGR310ServerConfigurationGR310ServerDown,\n";
    
    my $dat_notification_id = 2032;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1506.1.1.1"})) {
        $dat_additional_text .= "\nptsnamiGR310ServerConfigurationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1506.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCICUAAppServerSuccessCloseCicServer
sub _1_3_6_1_4_1_1556_17_0_7201
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Success closed CIC UA TCP Server.\nTrapName = ptCICUAAppServerSuccessCloseCicServer,\n";
    
    my $dat_notification_id = 2033;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.2"})) {
        $dat_additional_text .= "\nptSGCICUAAppServerDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.5"})) {
        $dat_additional_text .= "\nptSGCICUAAppServerStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.217.218.219.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexScrServerAbort
sub _1_3_6_1_4_1_1556_17_0_2024
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications Scripting Server has aborted.\nTrapName = ptSS7DBAppsConfigurationSigFlexScrServerAbort,\n";
    
    my $dat_notification_id = 2034;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionDSCAdncSevereCongestionDiscard
sub _1_3_6_1_4_1_1556_17_0_1851
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC ADN Connection discarded an answer message due to severe congestion.\nTrapName = ptADNConnectionDSCAdncSevereCongestionDiscard,\n";
    
    my $dat_notification_id = 2035;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.15"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.15"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"})) {
        $dat_additional_text .= "\nptDSCADNConnectionLocalHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"})) {
        $dat_additional_text .= "\nptDSCADNConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1806.1807.1840.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDRELoadingManagerMtp3LinkRebalancingTriggered
sub _1_3_6_1_4_1_1556_17_0_8192
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "As part of the proper distribution of DRE loading, the links on all DREs have been redistributed. This action has been triggered by the DRE loading audit or by user action. This is a stateless trap (no alarm).\nTrapName = ptDRELoadingManagerMtp3LinkRebalancingTriggered,\n";
    
    my $dat_notification_id = 2036;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRateLimiterDSCRlCongestionDiscardCleared
sub _1_3_6_1_4_1_1556_17_0_1855
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC RateLimiter has not discarded messages due to configured congestion handling for 5 minutes\nTrapName = ptRateLimiterDSCRlCongestionDiscardCleared,\n";
    
    my $dat_notification_id = 2037;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.2"})) {
        $dat_additional_text .= "\nptDSCRateLimiterCapacityParameterSet = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.1"})) {
        $dat_additional_text .= "\nptDSCRateLimiterName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotStatusUnavailable
sub _1_3_6_1_4_1_1556_17_0_6250
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A card has stopped responding.  The card may be physically extracted or there has been a software/hardware malfunction.  This alarm will be raised on upgrade do to normal operation. Cause  - Card non-responsive. Action - Check the card is inserted and operational. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4  equipment alarm - ptTrapSeverity:      1  critical - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptSlotSlotStatusUnavailable,\n";
    
    my $dat_notification_id = 2038;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"})) {
        $dat_additional_text .= "\nptSlotPrimaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"})) {
        $dat_additional_text .= "\nptSlotSecondaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTConfigurationGttConfigurationError
sub _1_3_6_1_4_1_1556_17_0_4402
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates that there was an error while processing the configuration file: gtt.conf Cause: A configuration error may be caused by a number of reasons, including: - unable to create configuration file - unable to open configuration file in read or write mode - there was an irrecoverable error in the configuration file Action: - make sure the GTT base directory (-b switch) has write access - make sure the configuration file has the proper permissions - review the configuration file for possible issues (e.g. a SCCP connection is configured on NA 2 but there is no NA 2 specified) Freq: This trap will appear when GTT is unable to recover from configuration problem. References: ptOriginatingOID    : ptGTTConfiguration ptTrapType          : 11 quality of service alarm ptTrapSeverity      : 2 major ptTrapProbableCause : 6 Communications subsystem error ptTrapClearType     : 2 oic\nTrapName = ptGTTConfigurationGttConfigurationError,\n";
    
    my $dat_notification_id = 2039;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotTIPCBearerLossClear
sub _1_3_6_1_4_1_1556_17_0_6297
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All TIPC Bearers are available\nTrapName = ptSlotSlotTIPCBearerLossClear,\n";
    
    my $dat_notification_id = 2040;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDiameterConnectionIWFDiameterConnectionUp
sub _1_3_6_1_4_1_1556_17_0_1904
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The Diameter Connection is connected.\nTrapName = ptDiameterConnectionIWFDiameterConnectionUp,\n";
    
    my $dat_notification_id = 2041;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1903.1904.1.1.2"})) {
        $dat_additional_text .= "\nptiwfDiameterConnectionConnectivityStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1903.1904.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1902.1903.1904.1.1.1"})) {
        $dat_additional_text .= "\nptiwfDiameterConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1902.1903.1904.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIWFConfigurationIWFDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_1920
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All debug attributes are set to their recommended values.\nTrapName = ptIWFConfigurationIWFDebugLevelRecommended,\n";
    
    my $dat_notification_id = 2042;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3UAASPAssocUp
sub _1_3_6_1_4_1_1556_17_0_7307
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a configured association is now up. Cause: An ASP has connected and sent an ASPUP notification. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm ptTrapSeverity: 5 cleared ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType: 1 fmic\nTrapName = ptM3UAASPAssociationM3UAASPAssocUp,\n";
    
    my $dat_notification_id = 2043;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkUninhibitDenied
sub _1_3_6_1_4_1_1556_17_0_7111
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an attempt to uninhibit a signaling link has failed. This is a stateless trap (no alarm). Cause  - A request to uninhibit a link from the local node to a  destination will fail if all the routes to the destination are unavailable. Action - Operator will have to wait until a route to the destination becomes available in order that it can send an uninhibit link  message.  Freq   - Operator dependant. References 1) Q.704 , (07/96) Section 10.2        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 56 Underlying resource unavailable ptTrapClearType:     2 oic\nTrapName = ptLSLinkSs7L3LinkUninhibitDenied,\n";
    
    my $dat_notification_id = 2044;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationLsmsPingSuccess
sub _1_3_6_1_4_1_1556_17_0_2020
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "LSMS ping test passed.\nTrapName = ptSS7DBAppsConfigurationLsmsPingSuccess,\n";
    
    my $dat_notification_id = 2045;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGWSTGwstProcessShutdown
sub _1_3_6_1_4_1_1556_17_0_4002
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates the GWST process is shutting down. Sent every time GWST is terminated (intentionally or not). System based termination include: - LDL Configuration error - Process received a terminating signal (SIGINT, SIGTERM).\nTrapName = ptGWSTGwstProcessShutdown,\n";
    
    my $dat_notification_id = 2046;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSGConfigurationLicConnCritical
sub _1_3_6_1_4_1_1556_17_0_7274
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A critical SG license error has occurred\nTrapName = ptSGConfigurationLicConnCritical,\n";
    
    my $dat_notification_id = 2047;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotIsmOptPartitionThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_6246
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "ISM /opt partition usage is above the alarm threshold defined in  disk_space_quota.  The slot number indicated in this trap indicates the origin of the alarm. Cause  - ISM /opt partition usage above threshold Action - Identify applications running high on disk space Freq   - Irregular\nTrapName = ptSlotSlotIsmOptPartitionThresholdExceeded,\n";
    
    my $dat_notification_id = 2048;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPSXNPGWPSXDown
sub _1_3_6_1_4_1_1556_17_0_1623
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW PSX is not connected.\nTrapName = ptPSXNPGWPSXDown,\n";
    
    my $dat_notification_id = 2049;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwPSXName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.3"})) {
        $dat_additional_text .= "\nptnpgwPSXStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLocalRedirectRecordLocalRedirectDuplicateThrottleOn
sub _1_3_6_1_4_1_1556_17_0_8004
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The Local Redirect Record Duplicate Throttle has hit the maximum limit.\nTrapName = ptLocalRedirectRecordLocalRedirectDuplicateThrottleOn,\n";
    
    my $dat_notification_id = 2050;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.793.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLocalRedirectRecordMessageCategory = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.793.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.793.1.1.1"})) {
        $dat_additional_text .= "\nptMTPLocalRedirectRecordDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.790.791.793.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexDBTableResizeFailure
sub _1_3_6_1_4_1_1556_17_0_2033
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications database table resize failed.\nTrapName = ptSS7DBAppsConfigurationSigFlexDBTableResizeFailure,\n";
    
    my $dat_notification_id = 2051;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTDBSummaryInitialDatabaseLoadSuccess
sub _1_3_6_1_4_1_1556_17_0_4407
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that GTT was  successful in loading its Live/GTT database at startup. Cause: This failure may be caused by number of reasons, including: - database files do not exist - database files are corrupt/not readable - upgrade from older database files failed Action: - make sure GTT was started with a valid base directory (-b switch) - if manually transferred or moved, make sure files have not been truncated - contact Sonus Networks Support for upgrade failures Freq: This trap will appear if GTT was not capable of loading its Live database. References: ptOriginatingOID    : DYNAMIC ptGTTDBSummary ptTrapType          : 11 quality of service alarm ptTrapSeverity      : 2 major ptTrapProbableCause : 6 Communications subsystem error ptTrapClearType     : 1 fmic\nTrapName = ptGTTDBSummaryInitialDatabaseLoadSuccess,\n";
    
    my $dat_notification_id = 2052;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.11"})) {
        $dat_additional_text .= "\nptGTTGTTDBSummaryGTOPCSearches = " . $entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.11"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.8"})) {
        $dat_additional_text .= "\nptGTTGTTDBSummaryCommandLists = " . $entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.7"})) {
        $dat_additional_text .= "\nptGTTGTTDBSummaryPCLists = " . $entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.6"})) {
        $dat_additional_text .= "\nptGTTGTTDBSummaryGTModifications = " . $entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.5"})) {
        $dat_additional_text .= "\nptGTTGTTDBSummaryGTCalledSearches = " . $entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.10"})) {
        $dat_additional_text .= "\nptGTTGTTDBSummaryGTCallingSearches = " . $entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.1"})) {
        $dat_additional_text .= "\nptGTTGTTDBSummaryDatabaseType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.669.670.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexThreadMgmtError
sub _1_3_6_1_4_1_1556_17_0_2029
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications thread management error.\nTrapName = ptSS7DBAppsConfigurationSigFlexThreadMgmtError,\n";
    
    my $dat_notification_id = 2053;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSysMgrDiskFull
sub _1_3_6_1_4_1_1556_17_0_2005
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Disk is full on SS7 DB Applications CPU\nTrapName = ptSS7DBAppsConfigurationSysMgrDiskFull,\n";
    
    my $dat_notification_id = 2054;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkUnavailable
sub _1_3_6_1_4_1_1556_17_0_8179
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is unavailable for user traffic. Cleared by ss7L3LinkAvailable. Cause  - The link is unavailable to user traffic for some reason (e.g. out of service, blocked, inhibited). Action - Depends on link state. Freq   - Operator dependant. References 1) GR310CORE Issue 3 Section 8.1 2) GR246CORE Issue 10 3) GR82CORE  Issue 10 4) Q.704 ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        3 minor ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptLSLinkSs7L3LinkUnavailable,\n";
    
    my $dat_notification_id = 2055;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaMultiASPAssocHighReceiveUsageOnset
sub _1_3_6_1_4_1_1556_17_0_7334
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The amount of traffic being received by the SG on a single M3UA Multi ASP association has received normal levels. The conditions of this clear event are controlled by the user using the M3UA High Usage Onset setting.\nTrapName = ptM3UAASPAssociationM3uaMultiASPAssocHighReceiveUsageOnset,\n";
    
    my $dat_notification_id = 2056;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptTransportServerServerLocalEndPointConflict
sub _1_3_6_1_4_1_1556_17_0_1826
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC server SCTP local end point has a conflict.  The host and port combination is in use by another server, ADNC, or different application. Review SCTP usage on the slot and host resolution for conflict.\nTrapName = ptTransportServerServerLocalEndPointConflict,\n";
    
    my $dat_notification_id = 2057;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.1"})) {
        $dat_additional_text .= "\nptDSCTransportServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.6"})) {
        $dat_additional_text .= "\nptDSCTransportServerHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.5"})) {
        $dat_additional_text .= "\nptDSCTransportServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1802.1805.1808.1809.1.1.5"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL2LinkCongested
sub _1_3_6_1_4_1_1556_17_0_7149
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is congested. Causes and Corrective Action   1) ptSpecificTrapCause = managementInitiated  Cause  - Protocol manager detects the condition.   2) ptSpecificTrapCause = linkCongestion  Cause  - Trap occurs when the thresholds for the number of MSUs in the transmission or re-transmission buffer are exceeded.   Action - Wait until the MSUs are sent . References 1) Q.704 , Section 3.8.2  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 49 Storage capacity problem ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL2LinkCongested,\n";
    
    my $dat_notification_id = 2058;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSysMgr5129ThrottlingOn
sub _1_3_6_1_4_1_1556_17_0_2009
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Throttling has started for 5129 msgs.\nTrapName = ptSS7DBAppsConfigurationSysMgr5129ThrottlingOn,\n";
    
    my $dat_notification_id = 2059;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGTTConfigurationGttConfigurationWarning
sub _1_3_6_1_4_1_1556_17_0_4406
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the there is an expected object/parameter missing  from the configuration file .\nTrapName = ptGTTConfigurationGttConfigurationWarning,\n";
    
    my $dat_notification_id = 2060;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLH110ChannelMpmtp2H110SigChanLoopbackCleared
sub _1_3_6_1_4_1_1556_17_0_5805
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the H110 signaling channel loopback mode setting has been set to the default DISABLED mode Cause  - A user has reset the attribute to the default or the system has restarted with default values Action - None required Freq   - This trap will appear when the user sets the Loopback attribute to DISABLED or when the system has started with this configured value for Loopback Mode. References - ptOriginatingOID:    DYNAMIC ptH110SignalingChannel - ptTrapType:          2 communication alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptLSLH110ChannelMpmtp2H110SigChanLoopbackCleared,\n";
    
    my $dat_notification_id = 2061;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1100.1.1.10"})) {
        $dat_additional_text .= "\nptIOHWLSLH110ChannelLoopbackMode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1100.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1100.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWLSLH110ChannelChannelNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1100.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCpuCertificateAboutToExpire
sub _1_3_6_1_4_1_1556_17_0_3162
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Certificate in this slot is within one month from expiry date.\nTrapName = ptSlotSlotCpuCertificateAboutToExpire,\n";
    
    my $dat_notification_id = 2062;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"})) {
        $dat_additional_text .= "\nptSlotSecondaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"})) {
        $dat_additional_text .= "\nptSlotPrimaryIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCICUATCPServerCicLicMajor
sub _1_3_6_1_4_1_1556_17_0_7252
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Major CIC License Event has occurred\nTrapName = ptCICUATCPServerCicLicMajor,\n";
    
    my $dat_notification_id = 2063;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexThreadSyncError
sub _1_3_6_1_4_1_1556_17_0_2028
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications thread synchronization error.\nTrapName = ptSS7DBAppsConfigurationSigFlexThreadSyncError,\n";
    
    my $dat_notification_id = 2064;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotAvailableMemThresh50Cleared
sub _1_3_6_1_4_1_1556_17_0_3175
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Memory availability is restored to more than 50% of total memory. Cause  - Applications have freed memory. Action - None. Freq   - Irregular. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4 equipment alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 6 communication subsystem - ptTrapClearType:     0 oic\nTrapName = ptSlotAvailableMemThresh50Cleared,\n";
    
    my $dat_notification_id = 2065;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"})) {
        $dat_additional_text .= "\nptSlotCPUMemoryUsage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.17"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDiscreteSensorSysComponentExtracted
sub _1_3_6_1_4_1_1556_17_0_6328
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "System Component extracted/deactivated. Cause  - System component extracted Action - Check hardware configuration Freq   - Infrequent References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      1 critical - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptDiscreteSensorSysComponentExtracted,\n";
    
    my $dat_notification_id = 2066;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"})) {
        $dat_additional_text .= "\npthwmonDiscreteSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1173.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotCpuUsageCritical
sub _1_3_6_1_4_1_1556_17_0_6244
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "CPU usage is critically high.  The slot number indicated in this trap indicates the origin of the alarm.  This condition can lead the kernel to indiscriminately terminate processes causing outage.  A process listing and top output can identify the offending process. Cause  - CPU usage above threshold Action - Identify applications running high on CPU Freq   - Irregular\nTrapName = ptSlotSlotCpuUsageCritical,\n";
    
    my $dat_notification_id = 2067;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptTmpSelmonIpmitoolDown
sub _1_3_6_1_4_1_1556_17_0_5513
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that sel_mon is now operable, and the ipmitool responding properly\nTrapName = ptTmpSelmonIpmitoolDown,\n";
    
    my $dat_notification_id = 2068;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAAppServerSUADiscardMsuFromPeerClear
sub _1_3_6_1_4_1_1556_17_0_7385
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Alarm for discard MSU unexpectedly between peers on SUA AS has been cleared as no further MSU have been unexpectedly discarded.\nTrapName = ptSUAAppServerSUADiscardMsuFromPeerClear,\n";
    
    my $dat_notification_id = 2069;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUAAppServerDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAAppServerNetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUAAppServerRoutingContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.9"})) {
        $dat_additional_text .= "\nptSGSUAAppServerApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUAAppServerSSN = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.4"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDBConnectionDBConnectionUp
sub _1_3_6_1_4_1_1556_17_0_1192
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DB Agent is now connected to its local database.\nTrapName = ptDBConnectionDBConnectionUp,\n";
    
    my $dat_notification_id = 2070;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1193.1.1.2"})) {
        $dat_additional_text .= "\nptdscdbDBConnectionConnectivityStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1193.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1193.1.1.1"})) {
        $dat_additional_text .= "\nptdscdbDBConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1193.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkInhibitDenied
sub _1_3_6_1_4_1_1556_17_0_7109
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an attempt to inhibit a signaling link  has failed. This is a stateless trap (no alarm). Causes ,Corrective actions and Frequency:  1) ptSpecificTrapCause = DPC not available  Cause  - This trap occurs when a request to inhibit a link will result in a destination becoming inaccessible and therefore the request is denied. Action - Operator will have to create another link  to access the destination before attempting to inhibit this  one. Freq   - Depends on how many destinations have single links and how often management wants to inhibit them.  2) ptSpecificTrapCause = Negative ACK from remote end Cause  - This trap occurs when a request to inhibit the link at the  remote end of a link results in a destination becoming  inaccessible.  Action - Operator will have to wait until another link is available to the destination before inhibiting this one.   Freq   - Depends on how many destinations have single links and how often management wants to inhibit them.  3) ptSpecificTrapCause = UnknownCause  References 1) Q.704 , (07/96) Section 10.2        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm  ptTrapSeverity:      4 warning ptTrapProbableCause: 56 Underlying resource unavailable  ptTrapClearType:     2 oic\nTrapName = ptLSLinkSs7L3LinkInhibitDenied,\n";
    
    my $dat_notification_id = 2071;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotRootDiskPartitionThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_6272
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "CPU root partition usage is above the alarm threshold defined in  disk_space_quota.  The slot number indicated in this trap indicates the origin of the alarm. Cause  - root partition usage above threshold Action - Identify applications running high on disk space Freq   - Irregular\nTrapName = ptSlotSlotRootDiskPartitionThresholdExceeded,\n";
    
    my $dat_notification_id = 2072;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkLocalInhibited
sub _1_3_6_1_4_1_1556_17_0_8105
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA signaling link has been inhibited  by operator at the local node. Cause  - Operator inhibits the link. Action - Operator can uninhibit the link. Freq   - Operator dependant.  References 1) Table 2 Q.752, Start of local inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      4  warning ptTrapProbableCause: 43 Resource at or near capacity    ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paL3LinkLocalInhibited,\n";
    
    my $dat_notification_id = 2073;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAManagerSccpResMgrDown
sub _1_3_6_1_4_1_1556_17_0_4207
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates SCCP is no longer connected to the resource manager.\nTrapName = ptSCCPNAManagerSccpResMgrDown,\n";
    
    my $dat_notification_id = 2074;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptThresholdSensorLowerMinorAssert
sub _1_3_6_1_4_1_1556_17_0_6346
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A threshold sensor lower minor alarm was asserted Cause  - A threshold sensor detects a lower minor condition Action - Verify sensor Freq   - Unexpected References - ptOriginatingOID:    DYNAMIC ptSensor - ptTrapType:          4 equipment alarm - ptTrapSeverity:      3 minor - ptTrapProbableCause: 7 configuration error - ptTrapClearType:     1 fmic\nTrapName = ptThresholdSensorLowerMinorAssert,\n";
    
    my $dat_notification_id = 2075;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorIPMINumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"})) {
        $dat_additional_text .= "\npthwmonThresholdSensorPortalID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1171.1172.1174.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkRemoteInhibited
sub _1_3_6_1_4_1_1556_17_0_7107
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been inhibited at a  remote node. Cause  - Operator has inhibited remote end of the link. Action - Link is inhibited until the operator uninhibits the  remote end of the link. Freq   - Operator dependant.  References 1) Table 2 Q.752, Start of remote inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm  ptTrapSeverity:      4 warning ptTrapProbableCause: 43 Resource at or near capacity   ptTrapClearType:     1 fmic\nTrapName = ptLSLinkSs7L3LinkRemoteInhibited,\n";
    
    my $dat_notification_id = 2076;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptL2ConnectionL2ModuleInaccessible
sub _1_3_6_1_4_1_1556_17_0_7157
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an MTP2 is no longer accessible. Cause  - An MTP2 may become inaccessible for a number of reasons including - MTP2 failure - Communication failure in the IP network leading to MTP2 Action - Depends on the cause  Freq   - This trap will appear when the status of an MTP2 changes to inaccessible.   References  None.  This is implementation specific.\nTrapName = ptL2ConnectionL2ModuleInaccessible,\n";
    
    my $dat_notification_id = 2077;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.61.48.1.1.3"})) {
        $dat_additional_text .= "\nptMTPL2ConnectionCageID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.61.48.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkLocalBlocked
sub _1_3_6_1_4_1_1556_17_0_7185
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been blocked at the local node by  the operator. Cause  - Operator blocks a link. Action - Operator can unblock the link.  Freq   - Operator dependant. References 1) Q.704 Section 3.2       ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 56 Underlying resource unavailable ptTrapClearType:     1 fmic\nTrapName = ptAnnexALinkAnnexaL3LinkLocalBlocked,\n";
    
    my $dat_notification_id = 2078;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericL3LinkAvailable
sub _1_3_6_1_4_1_1556_17_0_8433
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is available for user traffic. Clears GenericL3LinkUnavailable. References 1) GR310CORE Issue 3 Section 8.1 2) GR246CORE Issue 10 3) GR82CORE  Issue 10 4) Q.704 ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptGenericLinkGenericL3LinkAvailable,\n";
    
    my $dat_notification_id = 2079;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPM3UAMsuDiscardSet
sub _1_3_6_1_4_1_1556_17_0_7374
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An M3UA message has been unexpectedly discarded in the last 5-minute.\nTrapName = ptM3UAASPM3UAMsuDiscardSet,\n";
    
    my $dat_notification_id = 2080;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.25"})) {
        $dat_additional_text .= "\nptSGM3UAASPName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.25"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.181.182.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMSAMsaThreshold3Cleared
sub _1_3_6_1_4_1_1556_17_0_8203
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the MSA threshold 3 is cleared.\nTrapName = ptMSAMsaThreshold3Cleared,\n";
    
    my $dat_notification_id = 2081;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.961.962.1.1.1"})) {
        $dat_additional_text .= "\nptmsaMSAName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.961.962.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLChannelMpmtp2SigChanLoopbackSet
sub _1_3_6_1_4_1_1556_17_0_5802
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the signaling channel loopback mode setting has been changed from the default DISABLED mode Cause  - A user has modified the attribute Action - Reset to DISABLED for normal operation Freq   - This trap will appear when the user sets the Loopback mode attribute to anything other than DISABLED References - ptOriginatingOID:    DYNAMIC ptSignalingChannel - ptTrapType:          2 communication alarm - ptTrapSeverity:      3 minor - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptLSLChannelMpmtp2SigChanLoopbackSet,\n";
    
    my $dat_notification_id = 2082;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1099.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWLSLChannelChannelNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1099.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1099.1.1.6"})) {
        $dat_additional_text .= "\nptIOHWLSLChannelLoopbackMode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1082.1099.1.1.6"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptProcessEventTrafficStatusReady
sub _1_3_6_1_4_1_1556_17_0_8301
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the peer traffic status is ready.\nTrapName = ptProcessEventTrafficStatusReady,\n";
    
    my $dat_notification_id = 2083;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"})) {
        $dat_additional_text .= "\nptpeereventProcessEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"})) {
        $dat_additional_text .= "\nptpeereventProcessEventSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPortMpmtp2PortLoopbackCleared
sub _1_3_6_1_4_1_1556_17_0_5811
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the loopback mode setting has been set to the default DISABLED mode Cause  - A user has reset the attribute to the default or the system has restarted with default values Action - None required Freq   - This trap will appear when the user sets the Loopback attribute to DISABLED or when the system has started with this configured value for Loopback Mode. References - ptOriginatingOID:    DYNAMIC ptPort - ptTrapType:          2 communication alarm - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptPortMpmtp2PortLoopbackCleared,\n";
    
    my $dat_notification_id = 2084;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.10"})) {
        $dat_additional_text .= "\nptIOHWPortLoopbackMode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWPortPortNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1089.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAM3UAASMasterNotActive
sub _1_3_6_1_4_1_1556_17_0_7316
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an AS Master is not active for an NA. Cause: One or more AS of type AS Master for that NA are not active. ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm ptTrapSeverity: 1 critical ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType: 1 fmic\nTrapName = ptMTP3NAM3UAASMasterNotActive,\n";
    
    my $dat_notification_id = 2085;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptProcessEventLowerLayerPartiallyConnected
sub _1_3_6_1_4_1_1556_17_0_8312
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates the peer lower layer is partially connected. Not raised during initialization.\nTrapName = ptProcessEventLowerLayerPartiallyConnected,\n";
    
    my $dat_notification_id = 2086;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"})) {
        $dat_additional_text .= "\nptpeereventProcessEventName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"})) {
        $dat_additional_text .= "\nptpeereventProcessEventSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1131.1132.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkLocalUnblocked
sub _1_3_6_1_4_1_1556_17_0_8116
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA signaling link has been unblocked at the local node  by the operator. References 1) Q.704 Section 3.2       ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 56 Underlying resource unavailable ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paL3LinkLocalUnblocked,\n";
    
    my $dat_notification_id = 2087;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaL3LinkUsageAlarmSet
sub _1_3_6_1_4_1_1556_17_0_7198
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 8.2.0. This trap indicates that the average traffic over this link exceeds  predefined threshold. There is potential for traffic loss if this  condition persists References This is PTI proprietary trap. ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      4 warning ptTrapProbableCause: 51 Threshold crossed  ptTrapClearType:     2 oic\nTrapName = ptAnnexALinkAnnexaL3LinkUsageAlarmSet,\n";
    
    my $dat_notification_id = 2088;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptATMLinkAtmL3LinkLocalBlocked
sub _1_3_6_1_4_1_1556_17_0_7145
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been blocked at the local node by  the operator. Cause  - Operator blocks a link. Action - Operator can unblock the link.  Freq   - Operator dependant. References 1) Q.704 Section 3.2       ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          10 processingAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 56 Underlying resource unavailable ptTrapClearType:     1 fmic\nTrapName = ptATMLinkAtmL3LinkLocalBlocked,\n";
    
    my $dat_notification_id = 2089;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"})) {
        $dat_additional_text .= "\nptMTPATMLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"})) {
        $dat_additional_text .= "\nptMTPATMLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"})) {
        $dat_additional_text .= "\nptMTPATMLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"})) {
        $dat_additional_text .= "\nptMTPATMLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"})) {
        $dat_additional_text .= "\nptMTPATMLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"})) {
        $dat_additional_text .= "\nptMTPATMLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.72.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRoutesetRouteSetAlarmsEnabled
sub _1_3_6_1_4_1_1556_17_0_8177
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Routeset alarms are enabled.\nTrapName = ptRoutesetRouteSetAlarmsEnabled,\n";
    
    my $dat_notification_id = 2090;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRoutesetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"})) {
        $dat_additional_text .= "\nptMTPRoutesetDestinationState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"})) {
        $dat_additional_text .= "\nptMTPRoutesetContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"})) {
        $dat_additional_text .= "\nptMTPRoutesetDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRoutesetRoutesetInaccessible
sub _1_3_6_1_4_1_1556_17_0_7153
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a routeset is no longer accessible. Cause  - The routeset destination may become inaccessible for a number of reasons including - Routeset deactivation - Destination SS7 Node can no longer receive SS7 traffic  - All routes in the routeset are no longer accessible  Action - Depends on the cause  Freq   - This trap will appear when the status of a routeset destination changes to inaccessible or the routeset is manually deactivated.   References  1) Q.703  ptOriginatingOID: DYNAMIC ptRouteset  ptTrapType: 2 communicationAlarm  ptTrapSeverity: 1 critical  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType: 1 fmic\nTrapName = ptRoutesetRoutesetInaccessible,\n";
    
    my $dat_notification_id = 2091;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"})) {
        $dat_additional_text .= "\nptMTPRoutesetDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"})) {
        $dat_additional_text .= "\nptMTPRoutesetDestinationState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRoutesetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"})) {
        $dat_additional_text .= "\nptMTPRoutesetContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationLsmsConnUp
sub _1_3_6_1_4_1_1556_17_0_2002
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Connectivy to the LSMS has been restored\nTrapName = ptSS7DBAppsConfigurationLsmsConnUp,\n";
    
    my $dat_notification_id = 2092;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paLinkAligned
sub _1_3_6_1_4_1_1556_17_0_8122
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA signaling link has been aligned. Cause  - After a signaling link failure is detected, signaling link initial alignment will take place. The Alignment procedure  passes through a number of states and when the procedure  enters the state aligned this trap is sent. Freq   - Once the alignment procedure enters the aligned state then the alignment procedure will not be repeated.  References 1) Q.703 , (07/96) Section 7.3  ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paLinkAligned,\n";
    
    my $dat_notification_id = 2093;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.11"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL2State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.11"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3UserOpcEqualsDpcDetect
sub _1_3_6_1_4_1_1556_17_0_9956
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "MTP3 discarded user messages with OPC equals DPC. This alarm will clear automatically if no more message with invalid OPC is detected for 5 minutes.\nTrapName = ptMTP3NAMtp3UserOpcEqualsDpcDetect,\n";
    
    my $dat_notification_id = 2094;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSwitchSwitchSyncDown
sub _1_3_6_1_4_1_1556_17_0_6290
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The sync interface to this switch is down. This interface is provided by a cable connected between the RMCs of the two switch cards in each chassis. Check that the state of the switch cards are both AVAILABLE. If so, check the state of the cable between the switches. This alarm will be raised on upgrade due to normal operation. Cause  - Switch Sync interface is non-responsive. Action - Check the card and cable are inserted and operational. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4  equipment alarm - ptTrapSeverity:      2  major - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptSwitchSwitchSyncDown,\n";
    
    my $dat_notification_id = 2095;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRoutesetRoutesetC20ProvClear
sub _1_3_6_1_4_1_1556_17_0_8194
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the routeset provisioning on the C20 Core has been corrected.\nTrapName = ptRoutesetRoutesetC20ProvClear,\n";
    
    my $dat_notification_id = 2096;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRoutesetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"})) {
        $dat_additional_text .= "\nptMTPRoutesetDestinationState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.19"})) {
        $dat_additional_text .= "\nptMTPRoutesetRoutesetID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.19"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"})) {
        $dat_additional_text .= "\nptMTPRoutesetContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"})) {
        $dat_additional_text .= "\nptMTPRoutesetDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paL3LinkLocalUninhibited
sub _1_3_6_1_4_1_1556_17_0_8106
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an M2PA signaling link has been uninhibited at the  local node by operator. References 1) Table 2 Q.752, End of local inhibition 2) Q.704 , (07/96) Section 10        ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          11 qualityofserviceAlarm ptTrapSeverity:      5 cleared ptTrapProbableCause: 43 Resource at or near capacity ptTrapClearType:     1 fmic\nTrapName = ptM2PALinkM2paL3LinkLocalUninhibited,\n";
    
    my $dat_notification_id = 2097;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRouteRouteAlarmsEnabled
sub _1_3_6_1_4_1_1556_17_0_7166
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Route alarms are enabled.\nTrapName = ptRouteRouteAlarmsEnabled,\n";
    
    my $dat_notification_id = 2098;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.5"})) {
        $dat_additional_text .= "\nptMTPRouteState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.6"})) {
        $dat_additional_text .= "\nptMTPRouteLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.2"})) {
        $dat_additional_text .= "\nptMTPRouteAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.4"})) {
        $dat_additional_text .= "\nptMTPRouteCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.63.51.52.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptTopologyOneToOnePublicMappingTopoMapRowMisconfigClear
sub _1_3_6_1_4_1_1556_17_0_1831
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Topology Mapping misconfiguration: no misconfiguration deteceted in the last 5 minutes interval.\nTrapName = ptTopologyOneToOnePublicMappingTopoMapRowMisconfigClear,\n";
    
    my $dat_notification_id = 2099;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3uaMultiAssocMinStreamsFail
sub _1_3_6_1_4_1_1556_17_0_7342
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An M3UA multi association has been established with less than the minimum 2 steam requirement\nTrapName = ptM3UAASPAssociationM3uaMultiAssocMinStreamsFail,\n";
    
    my $dat_notification_id = 2100;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetSs7LinksetDeactivated
sub _1_3_6_1_4_1_1556_17_0_8600
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an SS7 linkset has been deactivated by the user.\nTrapName = ptLinksetSs7LinksetDeactivated,\n";
    
    my $dat_notification_id = 2101;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLinksetState = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptDSCNodesDSCLicenseAvailable
sub _1_3_6_1_4_1_1556_17_0_1804
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "License keys have been received and validated.\nTrapName = ptDSCNodesDSCLicenseAvailable,\n";
    
    my $dat_notification_id = 2102;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAManagerMtp3LostConnectionToLicenceD
sub _1_3_6_1_4_1_1556_17_0_8165
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "NA lost connection to License Daemon\nTrapName = ptMTP3NAManagerMtp3LostConnectionToLicenceD,\n";
    
    my $dat_notification_id = 2103;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIMFPacketCaptureImfPacketCaptureClear
sub _1_3_6_1_4_1_1556_17_0_8403
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The packet capture has been stopped on the processors.\nTrapName = ptIMFPacketCaptureImfPacketCaptureClear,\n";
    
    my $dat_notification_id = 2104;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotBackupSftpUploadFailureCleared
sub _1_3_6_1_4_1_1556_17_0_6279
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A backup to SFTP destination has now been successfully completed. Cause  - Backup successfully transferred to remote SFTP destination Action - None. Freq   - Irregular\nTrapName = ptSlotSlotBackupSftpUploadFailureCleared,\n";
    
    my $dat_notification_id = 2105;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.21"})) {
        $dat_additional_text .= "\nptSlotLastFailedSFTPBackupDestIP = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.21"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.23"})) {
        $dat_additional_text .= "\nptSlotLastFailedSFTPBackupDestDir = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.23"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.22"})) {
        $dat_additional_text .= "\nptSlotLastFailedSFTPBackupDestUserID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.22"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paLinkSCTPUnavailable
sub _1_3_6_1_4_1_1556_17_0_8126
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link is unavailable for user traffic because the underlying SCTP Association is unavailable. Cleared by m2paLinkSCTPAvailable. Cause  - Most likely an IP Network issues, or perhaps communication was lost to a DRE. Action - Check the availability of the corresponding DRE. If available, troubleshoot the IP connectivity. Freq   - Operator dependant. References 1) GR310CORE Issue 3 Section 8.6 (REPT-SCTP-ASOCTRMD) ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        3 minor ptTrapProbableCause:  29 Loss of signal    ptTrapClearType:       1 fmic\nTrapName = ptM2PALinkM2paLinkSCTPUnavailable,\n";
    
    my $dat_notification_id = 2106;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.6"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NAMtp3SLSLinkAuditFailureClear
sub _1_3_6_1_4_1_1556_17_0_9986
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "MTP3 no longer detects an unavailable link in an SLS Table.\nTrapName = ptMTP3NAMtp3SLSLinkAuditFailureClear,\n";
    
    my $dat_notification_id = 2107;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPSXHostNPGWPSXHostCongested
sub _1_3_6_1_4_1_1556_17_0_1627
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW PSX Host is congested on at least one connection.\nTrapName = ptPSXHostNPGWPSXHostCongested,\n";
    
    my $dat_notification_id = 2108;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwPSXHostHost = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwPSXHostPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.3"})) {
        $dat_additional_text .= "\nptnpgwPSXHostCongestion = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1617.1618.1619.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSS7DBAppsConfigurationSigFlexInvalidMsg
sub _1_3_6_1_4_1_1556_17_0_2040
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SS7 DB Applications invalid message.\nTrapName = ptSS7DBAppsConfigurationSigFlexInvalidMsg,\n";
    
    my $dat_notification_id = 2109;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"})) {
        $dat_additional_text .= "\nptFLXSS7DBAppsConfigurationTrapInfo = " . $entrada->{"1.3.6.1.4.1.1556.17.15.2001.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotAIDEErrorNotDetected
sub _1_3_6_1_4_1_1556_17_0_3173
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "No AIDE errors detected.\nTrapName = ptSlotSlotAIDEErrorNotDetected,\n";
    
    my $dat_notification_id = 2110;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIMFConfigurationIMFDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_8405
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptIMFConfigurationIMFDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 2111;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptCICUATCPServerCicLicClrMajor
sub _1_3_6_1_4_1_1556_17_0_7253
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A Major CIC License Event has been cleared\nTrapName = ptCICUATCPServerCicLicClrMajor,\n";
    
    my $dat_notification_id = 2112;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptL4ConnectionL4ConnCongestionClear
sub _1_3_6_1_4_1_1556_17_0_9965
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Clear event for L4 connection congestion.\nTrapName = ptL4ConnectionL4ConnCongestionClear,\n";
    
    my $dat_notification_id = 2113;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGWSTConfigurationGR310ConnectionUp
sub _1_3_6_1_4_1_1556_17_0_1002
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "All routing CPUs are connected to the active GR-310 server\nTrapName = ptGWSTConfigurationGR310ConnectionUp,\n";
    
    my $dat_notification_id = 2114;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NANodeSNMPeerHostUnavailable
sub _1_3_6_1_4_1_1556_17_0_8157
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "SNM Peer Host unavailable.\nTrapName = ptMTP3NANodeSNMPeerHostUnavailable,\n";
    
    my $dat_notification_id = 2115;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"})) {
        $dat_additional_text .= "\nptMTPMTP3NALocalPointCode = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"})) {
        $dat_additional_text .= "\nptMTPMTP3NASS7NodeType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSlotSlotRootDiskPartitionThresholdCleared
sub _1_3_6_1_4_1_1556_17_0_6273
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "CPU root partition usage has returned to acceptable levels. Cause  - root partition usage below threshold. Action - None. Freq   - Irregular.\nTrapName = ptSlotSlotRootDiskPartitionThresholdCleared,\n";
    
    my $dat_notification_id = 2116;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"})) {
        $dat_additional_text .= "\nptSlotSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"})) {
        $dat_additional_text .= "\nptSlotSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.601.602.1.1.1"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSwitchMonitorSwitchmonDebugLevelNotRecommended
sub _1_3_6_1_4_1_1556_17_0_6294
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "At least one debug attribute is not set to the recommended value. Cause: A debug attribute is not set to a recommended level. Possible Actions - The user should perform the 'Restore Debug Defaults' action to reset all debug attributes to their default values.\nTrapName = ptSwitchMonitorSwitchmonDebugLevelNotRecommended,\n";
    
    my $dat_notification_id = 2117;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7SLSLinkAuditFailure
sub _1_3_6_1_4_1_1556_17_0_9987
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "MTP3 detected an unavailable link in an SLS Table. MSU loss is possible. Cleared by ss7SLSLinkAuditFailureClear. Cause  - MTP3 detected an unavailable link in an SLS Table. Action - This alarm should resolve itself in less than four minutes. If this alarm does not clear itself you should reset the link using the 'Reset' action on the link. Freq   - Operator dependant. References None. This is an implementation specific audit. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        1 critical ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptLSLinkSs7SLSLinkAuditFailure,\n";
    
    my $dat_notification_id = 2118;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericL3LinkAlarmsDisabled
sub _1_3_6_1_4_1_1556_17_0_8163
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Generic Link alarms are disabled.\nTrapName = ptGenericLinkGenericL3LinkAlarmsDisabled,\n";
    
    my $dat_notification_id = 2119;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptADNConnectionADNConnSecClear
sub _1_3_6_1_4_1_1556_17_0_1812
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The ADN Connection is either deactivated, or connectivity is established on it with correct TLS security parameter certificate file.\nTrapName = ptADNConnectionADNConnSecClear,\n";
    
    my $dat_notification_id = 2120;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNANPGWSCCPNADown
sub _1_3_6_1_4_1_1556_17_0_1603
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The SCCP NA is deactivated or all SCCP NA connections are not connected.\nTrapName = ptSCCPNANPGWSCCPNADown,\n";
    
    my $dat_notification_id = 2121;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwSCCPNANA = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwSCCPNAStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2UALinkM2uaSLSLinkAuditFailureClear
sub _1_3_6_1_4_1_1556_17_0_9994
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an SLS Table Link Audit has concluded and this link is no longer included incorrectly in SLS Tables. The link may have been removed from SLS Tables, or its state may have changed so it is now appropriate for use in SLS Tables. Clears m2uaSLSLinkAuditFailure. References None. This is an implementation specific audit. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptM2UALinkM2uaSLSLinkAuditFailureClear,\n";
    
    my $dat_notification_id = 2122;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"})) {
        $dat_additional_text .= "\nptMTPM2UALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2UALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2UALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2UALinkIID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2UALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2UALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.70.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSwitchSwitchUnreachable
sub _1_3_6_1_4_1_1556_17_0_6280
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "A switch card has stopped responding.  The card may be physically extracted or there has been a software/hardware malfunction. Other cards in the chassis cannot communicate on the fabric that this card was managing. This alarm will be raised on upgrade due to normal operation. Cause  - Switch card non-responsive. Action - Check the card is inserted and operational. Freq   - Infrequent. References - ptOriginatingOID:    DYNAMIC Slot - ptTrapType:          4  equipment alarm - ptTrapSeverity:      1  critical - ptTrapProbableCause: 11 quality of service - ptTrapClearType:     1  fmic\nTrapName = ptSwitchSwitchUnreachable,\n";
    
    my $dat_notification_id = 2123;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"})) {
        $dat_additional_text .= "\nptSWMSwitchSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1182.1183.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptGenericLinkGenericLinkUnaligned
sub _1_3_6_1_4_1_1556_17_0_8434
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an Generic signaling link has lost alignment. Cause  - After a signaling link failure is detected, signaling link initial alignment will take place. The Alignment procedure passes through a number of states and when the procedure enters the state not aligned this trap is sent. Action - If the initial alignment procedure does not work, then the operator will have to intervene in order that the link alignment succeeds. Freq   - This trap will continue to appear each time the initial alignment procedure enters the state not aligned. This may happen a number of times as the initial alignment procedure is repeated until alignment has been completed successfully. References 1) Q.703 , (07/96) Section 7.3 ptOriginatingOID:    DYNAMIC ptLink ptTrapType:          2 communicationAlarm ptTrapSeverity:      3 minor ptTrapProbableCause: 6 Communications subsystem error ptTrapClearType:     1 fmic\nTrapName = ptGenericLinkGenericLinkUnaligned,\n";
    
    my $dat_notification_id = 2124;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.11"})) {
        $dat_additional_text .= "\nptMTPGenericLinkL2State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.11"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"})) {
        $dat_additional_text .= "\nptMTPGenericLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLinkType = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.51"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"})) {
        $dat_additional_text .= "\nptMTPGenericLinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"})) {
        $dat_additional_text .= "\nptMTPGenericLinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.80.1.1.8"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLinksetMtp3LinksetDebugLevelRecommended
sub _1_3_6_1_4_1_1556_17_0_8209
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The MTP3 link debugging attributes are set to their recommended values.\nTrapName = ptLinksetMtp3LinksetDebugLevelRecommended,\n";
    
    my $dat_notification_id = 2125;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"})) {
        $dat_additional_text .= "\nptMTPLinksetLinksetName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.120"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLinksetCLLI = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLinksetAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIOManagerMpmtp2SoftwareRestartRequired
sub _1_3_6_1_4_1_1556_17_0_5812
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Trap is raised when the configuration selection has changed.  A software restart is required on this slot number in order for the change to take effect. Cause   - Configuration change partly complete. Action  - Restart software on the alarmed slot. Freq    - User change request. References - ptOriginatingOID:    DYNAMIC ptTDMCard - ptTrapType:          2 Communications - ptTrapSeverity:      5 clear - ptTrapProbableCause: 7 Configuration error - ptTrapClearType:     1 fmic\nTrapName = ptIOManagerMpmtp2SoftwareRestartRequired,\n";
    
    my $dat_notification_id = 2126;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1.1.1"})) {
        $dat_additional_text .= "\nptIOHWIOManagerSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1.1.60"})) {
        $dat_additional_text .= "\nptIOHWIOManagerSelectConfiguration = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1.1.60"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1081.1.1.61"})) {
        $dat_additional_text .= "\nptIOHWIOManagerRestartRequired = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1081.1.1.61"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptMTP3NADiscardMsuFromPeerSet
sub _1_3_6_1_4_1_1556_17_0_9958
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MSU was discarded for a reason that might not correspond to an existing alarm. This alarm is not generated for MSUs discarded because the destination is unavailable or congested (since destinations unavailable or congested have their own alarms)\nTrapName = ptMTP3NADiscardMsuFromPeerSet,\n";
    
    my $dat_notification_id = 2127;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"})) {
        $dat_additional_text .= "\nptMTPMTP3NAContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptPCEPceWriteFailure
sub _1_3_6_1_4_1_1556_17_0_4305
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Obsolete as of 9.0.0. This trap indicates a PCE write to file failed.   Sent when a PCE configuration or database write fails. Write failures include: - Invalid file permissions - Out of memory in file system\nTrapName = ptPCEPceWriteFailure,\n";
    
    my $dat_notification_id = 2128;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM2PALinkM2paSLSLinkAuditFailureClear
sub _1_3_6_1_4_1_1556_17_0_9996
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an SLS Table Link Audit has concluded and this link is no longer included incorrectly in SLS Tables. The link may have been removed from SLS Tables, or its state may have changed so it is now appropriate for use in SLS Tables. Clears m2paSLSLinkAuditFailure. References None. This is an implementation specific audit. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        5 cleared ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptM2PALinkM2paSLSLinkAuditFailureClear,\n";
    
    my $dat_notification_id = 2129;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"})) {
        $dat_additional_text .= "\nptMTPM2PALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.12"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.9"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.8"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"})) {
        $dat_additional_text .= "\nptMTPM2PALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"})) {
        $dat_additional_text .= "\nptMTPM2PALinkRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.10"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"})) {
        $dat_additional_text .= "\nptMTPM2PALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.44"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.6"})) {
        $dat_additional_text .= "\nptMTPM2PALinkLocalIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.58.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptRateLimiterDSCRlLocalOverloadDiscard
sub _1_3_6_1_4_1_1556_17_0_1864
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The DSC RateLimiter discarded a message due to configured local overload handling.\nTrapName = ptRateLimiterDSCRlLocalOverloadDiscard,\n";
    
    my $dat_notification_id = 2130;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.1"})) {
        $dat_additional_text .= "\nptDSCRateLimiterName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.2"})) {
        $dat_additional_text .= "\nptDSCRateLimiterCapacityParameterSet = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1801.1804.1856.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptAnnexALinkAnnexaSLSLinkAuditFailure
sub _1_3_6_1_4_1_1556_17_0_9991
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "MTP3 detected an unavailable link in an SLS Table. MSU loss is possible. Cleared by annexaSLSLinkAuditFailureClear. Cause  - MTP3 detected an unavailable link in an SLS Table. Action - This alarm should resolve itself in less than four minutes. If this alarm does not clear itself you should reset the link using the 'Reset' action on the link. Freq   - Operator dependant. References None. This is an implementation specific audit. ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        1 critical ptTrapProbableCause:   6 Communication subsystem error ptTrapClearType:       1 fmic\nTrapName = ptAnnexALinkAnnexaSLSLinkAuditFailure,\n";
    
    my $dat_notification_id = 2131;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.6"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"})) {
        $dat_additional_text .= "\nptMTPAnnexALinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.73.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUASCTPServerSUASCTPServerResolvedHost1
sub _1_3_6_1_4_1_1556_17_0_7359
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An SUA SCTP Server Hostname 1 is resolved\nTrapName = ptSUASCTPServerSUASCTPServerResolvedHost1,\n";
    
    my $dat_notification_id = 2132;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.209.210.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptIsmEtcPartitionThresholdExceeded
sub _1_3_6_1_4_1_1556_17_0_5529
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that the ISM /etc partition usage has reached its alarm threshold\nTrapName = ptIsmEtcPartitionThresholdExceeded,\n";
    
    my $dat_notification_id = 2133;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1018"})) {
        $dat_additional_text .= "\nptTrapSlotNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1018"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNAConnectionNPGWSCCPNAConnectionDown
sub _1_3_6_1_4_1_1556_17_0_1605
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "The NPGW NA traffic is deactivated or the SCCP NA connection is not connected.\nTrapName = ptSCCPNAConnectionNPGWSCCPNAConnectionDown,\n";
    
    my $dat_notification_id = 2134;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1609.1.1.1"})) {
        $dat_additional_text .= "\nptnpgwSCCPNAConnectionSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1609.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1609.1.1.2"})) {
        $dat_additional_text .= "\nptnpgwSCCPNAConnectionStatus = " . $entrada->{"1.3.6.1.4.1.1556.17.15.1607.1608.1609.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSUAAppServerSUAAppServerNotActive
sub _1_3_6_1_4_1_1556_17_0_7310
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that an App Server is not active.   Cause: No ASP has activated the associated routing context (RC). ptOriginatingOID: DYNAMIC ptTrapType: 2 communicationAlarm  ptTrapSeverity: 1 critical  ptTrapProbableCause: 6 Communications subsystem error  ptTrapClearType: 1 fmic\nTrapName = ptSUAAppServerSUAAppServerNotActive,\n";
    
    my $dat_notification_id = 2135;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.2"})) {
        $dat_additional_text .= "\nptSGSUAAppServerRoutingContext = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.9"})) {
        $dat_additional_text .= "\nptSGSUAAppServerApplicationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.4"})) {
        $dat_additional_text .= "\nptSGSUAAppServerSSN = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.3"})) {
        $dat_additional_text .= "\nptSGSUAAppServerDPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.5"})) {
        $dat_additional_text .= "\nptSGSUAAppServerNetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.200.201.202.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UAASPAssociationM3UAASPAssocUnresolvedRemoteHost1
sub _1_3_6_1_4_1_1556_17_0_7704
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that M3UA ASP Association Remote IP Address 1 hostname is not resolvable. Cause - The SG is unable to resolve the hostname. Possible Actions - If the DSC has been set up to use a DNS server,  ensure the DNS server is reachable and confirm that the hostname has been configured. If the hostname is intended to resolve locally, ensure the proper hostname entry  has been added using IP Networking > Hostname Resolution. Freq - This trap occurs when the configured hostname becomes unresolvable.\nTrapName = ptM3UAASPAssociationM3UAASPAssocUnresolvedRemoteHost1,\n";
    
    my $dat_notification_id = 2136;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemoteIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationRemotePort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UAASPAssociationAssociationID = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.185.189.190.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptLSLinkSs7L3LinkRemoteBlocked
sub _1_3_6_1_4_1_1556_17_0_7113
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "This trap indicates that a signaling link has been blocked at a remote node. Cause  - Signaling link is blocked at the remote node of the link by operator intervention or due to processor outage. Action - The link will be unblocked when the remote node of the  link becomes unblocked.  Freq   - Operator dependant. References 1) Table 2 Q.752 Start of Remote Processor Outage 2) Q.704 Section 3.3.5       ptOriginatingOID:      DYNAMIC ptLink ptTrapType:            2 communicationAlarm ptTrapSeverity:        3 minor ptTrapProbableCause:   42 Remote node transmission error   ptTrapClearType:       1 fmic\nTrapName = ptLSLinkSs7L3LinkRemoteBlocked,\n";
    
    my $dat_notification_id = 2137;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"})) {
        $dat_additional_text .= "\nptMTPLSLinkSLC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.3"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"})) {
        $dat_additional_text .= "\nptMTPLSLinkL3State = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.9"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"})) {
        $dat_additional_text .= "\nptMTPLSLinkCage = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.5"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"})) {
        $dat_additional_text .= "\nptMTPLSLinkLinkName = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.14"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"})) {
        $dat_additional_text .= "\nptMTPLSLinkChannel = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.7"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"})) {
        $dat_additional_text .= "\nptMTPLSLinkAPC = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"})) {
        $dat_additional_text .= "\nptMTPLSLinkChassisSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.46.65.64.53.55.1.1.6"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptSCCPNASCCPNAsMsuDiscardSet
sub _1_3_6_1_4_1_1556_17_0_7372
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "An MSU has been unexpectedly discarded on SCCP NA Connection in the last 5-minute interval.\nTrapName = ptSCCPNASCCPNAsMsuDiscardSet,\n";
    
    my $dat_notification_id = 2138;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.255.256.1.1.1"})) {
        $dat_additional_text .= "\nptSGSCCPNANetworkAppearance = " . $entrada->{"1.3.6.1.4.1.1556.17.15.255.256.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

# ptM3UASCTPServerM3UASCTPServerUnresolvedHost1
sub _1_3_6_1_4_1_1556_17_0_7352
{
    my $entrada = shift;
    my $trap_name = shift;
    my $config_ref = shift;
    my %config = %$config_ref;

    my $alarm_txt;

    my $agent_address = $entrada->{"IPADDR"};
    my $dat_event_time = $llena->fecha();
    

    my $dat_severity = 2;
    my $dat_specific_problem = 0;
    my $dat_probable_cause = 0;
    my $dat_event_type = 10;
    my $dat_additional_text = "Indicates that M3UA SCTP Server IP Address 1 hostname is not resolvable. Cause - The SG is unable to resolve the hostname. Possible Actions - If the DSC has been set up to use a DNS server,  ensure the DNS server is reachable and confirm that the hostname has been configured. If the hostname is intended to resolve locally, ensure the proper hostname entry  has been added using IP Networking > Hostname Resolution. Freq - This trap occurs when the configured hostname becomes unresolvable.\nTrapName = ptM3UASCTPServerM3UASCTPServerUnresolvedHost1,\n";
    
    my $dat_notification_id = 2139;
    my $dat_correlated_notification_id = "";

    my $hostname = HostRegex($config{"HOST"}, $agent_address);
    my $dat_managed_object = get_managed_object($hostname, $agent_address, $entrada -> {"1.3.6.1.6.3.18.1.3"});

    ################################################################################### 
    
    #---------- (INICIO) Personalizacion del trap 
    
    ###################################################################################
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerSlot = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.1"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1011"})) {
        $dat_additional_text .= "\nptTrapSequenceNumber = " . $entrada->{"1.3.6.1.4.1.1556.17.1011"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1026"})) {
        $dat_additional_text .= "\nptTrapItemOID = " . $entrada->{"1.3.6.1.4.1.1556.17.1026"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1017"})) {
        $dat_additional_text .= "\nptTrapProbableCause = " . $entrada->{"1.3.6.1.4.1.1556.17.1017"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1015"})) {
        $dat_additional_text .= "\nptTrapSeverity = " . $entrada->{"1.3.6.1.4.1.1556.17.1015"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1013"})) {
        $dat_additional_text .= "\nptTrapType = " . $entrada->{"1.3.6.1.4.1.1556.17.1013"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerPort = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.4"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress1 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.2"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1016"})) {
        $dat_additional_text .= "\nptTrapClearType = " . $entrada->{"1.3.6.1.4.1.1556.17.1016"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.1012"})) {
        $dat_additional_text .= "\nptTrapDateAndTime = " . $entrada->{"1.3.6.1.4.1.1556.17.1012"} . ",\n";
    }
    if (ifexists($entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"})) {
        $dat_additional_text .= "\nptSGM3UASCTPServerIPAddress2 = " . $entrada->{"1.3.6.1.4.1.1556.17.15.175.183.184.1.1.3"} . ",\n";
    }
    ################################################################################### 
    
    #---------- (TERMINO) Personalizacion del trap 
    
    ###################################################################################
    ################################################################################### 
    
    #----------  Llenado de campos de la alarma
    ###################################################################################

    $llena->llenaMO("MO:" . $dat_managed_object) if (ifexists($dat_managed_object));
    $llena->llenaPC("PC:" . $dat_probable_cause) if (ifexists($dat_probable_cause));
    $llena->llenaSP("SP:" . $dat_specific_problem) if (ifexists($dat_specific_problem));
    $llena->llenaPS("PS:" . $dat_severity) if (ifexists($dat_severity));
    $llena->llenaNI("NID:" . $dat_notification_id) if (ifexists($dat_notification_id));
    $llena->llenaAT("AddTxt:" . $dat_additional_text) if (ifexists($dat_additional_text));
    $llena->EventTime("ETime:" . $dat_event_time) if (ifexists($dat_event_time));
    $llena->EventType("EType:" . $dat_event_type) if (ifexists($dat_event_type));

    $alarm_txt = ${ $llena->{mensaje_x733} };
    $llena->vacia_mensaje_x733();
    $alarm_txt = "###START###" . $alarm_txt . "###END###";

    return $alarm_txt;
}

1;
